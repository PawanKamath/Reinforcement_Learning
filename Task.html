<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html><head></head><body>















    






    
    
    
    


<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h1>COMP47590 Advanced Machine Learning<a rel="noopener" class="anchor-link" href="#COMP47590-Advanced-Machine-Learning">&#182;</a></h1>
</div>
</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h2>Assignment 2: Going the Distance<a rel="noopener" class="anchor-link" href="#Assignment-2:-Going-the-Distance">&#182;</a></h2><p>Uses the PPO actor-critic method to train a neural network to control a simple robot in the RacingCar environment from OpenAI gym (<a rel="noopener" href="https://gym.openai.com/envs/RacingCar-v0/">https://gym.openai.com/envs/RacingCar-v0/</a>).</p>

</div>
</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p><img src="racing_car.gif" alt="Racing"/></p>
<p>There are five discrete <strong>actions</strong> in this environment:</p>
<ul>
<li>left (0)</li>
<li>right (1)</li>
<li>brake (2)</li>
<li>accelerate (3)</li>
<li>none (4)</li>
</ul>
<p><strong>Reward</strong> of -0.1 is awarded every frame and +1000/N for every track tile visited, where N is the total number of tiles in track. For example, if you have finished in 732 frames, your reward is 1000 - 0.1*732 = 926.8 points.</p>
<p>And the <strong>state</strong> is represented using a single image frame (96 * 96).</p>

</div>
</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h3>Initialisation<a rel="noopener" class="anchor-link" href="#Initialisation">&#182;</a></h3>
</div>
</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p>If using Google colab you need to install packages - comment out lines below.</p>

</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[1]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="o">!</span>apt install swig cmake ffmpeg
<span class="o">!</span>apt-get install -y xvfb x11-utils
<span class="o">!</span>pip install stable-baselines3<span class="o">[</span>extra<span class="o">]</span> pyglet box2d box2d-kengz
<span class="o">!</span>pip install pyvirtualdisplay PyOpenGL PyOpenGL-accelerate
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>Reading package lists... Done
Building dependency tree       
Reading state information... Done
swig is already the newest version (3.0.12-1).
cmake is already the newest version (3.10.2-1ubuntu2.18.04.2).
ffmpeg is already the newest version (7:3.4.8-0ubuntu0.2).
0 upgraded, 0 newly installed, 0 to remove and 40 not upgraded.
Reading package lists... Done
Building dependency tree       
Reading state information... Done
x11-utils is already the newest version (7.7+3build1).
xvfb is already the newest version (2:1.19.6-1ubuntu4.10).
0 upgraded, 0 newly installed, 0 to remove and 40 not upgraded.
Requirement already satisfied: stable-baselines3[extra] in /usr/local/lib/python3.7/dist-packages (1.5.0)
Requirement already satisfied: pyglet in /usr/local/lib/python3.7/dist-packages (1.5.0)
Requirement already satisfied: box2d in /usr/local/lib/python3.7/dist-packages (2.3.10)
Requirement already satisfied: box2d-kengz in /usr/local/lib/python3.7/dist-packages (2.3.3)
Requirement already satisfied: future in /usr/local/lib/python3.7/dist-packages (from pyglet) (0.16.0)
Requirement already satisfied: gym==0.21 in /usr/local/lib/python3.7/dist-packages (from stable-baselines3[extra]) (0.21.0)
Requirement already satisfied: pandas in /usr/local/lib/python3.7/dist-packages (from stable-baselines3[extra]) (1.3.5)
Requirement already satisfied: cloudpickle in /usr/local/lib/python3.7/dist-packages (from stable-baselines3[extra]) (1.3.0)
Requirement already satisfied: numpy in /usr/local/lib/python3.7/dist-packages (from stable-baselines3[extra]) (1.21.6)
Requirement already satisfied: torch&gt;=1.8.1 in /usr/local/lib/python3.7/dist-packages (from stable-baselines3[extra]) (1.11.0+cu113)
Requirement already satisfied: matplotlib in /usr/local/lib/python3.7/dist-packages (from stable-baselines3[extra]) (3.2.2)
Requirement already satisfied: psutil in /usr/local/lib/python3.7/dist-packages (from stable-baselines3[extra]) (5.4.8)
Requirement already satisfied: opencv-python in /usr/local/lib/python3.7/dist-packages (from stable-baselines3[extra]) (4.1.2.30)
Requirement already satisfied: pillow in /usr/local/lib/python3.7/dist-packages (from stable-baselines3[extra]) (7.1.2)
Requirement already satisfied: tensorboard&gt;=2.2.0 in /usr/local/lib/python3.7/dist-packages (from stable-baselines3[extra]) (2.8.0)
Requirement already satisfied: ale-py~=0.7.4 in /usr/local/lib/python3.7/dist-packages (from stable-baselines3[extra]) (0.7.5)
Requirement already satisfied: autorom[accept-rom-license]~=0.4.2 in /usr/local/lib/python3.7/dist-packages (from stable-baselines3[extra]) (0.4.2)
Requirement already satisfied: importlib-metadata&gt;=4.8.1 in /usr/local/lib/python3.7/dist-packages (from gym==0.21-&gt;stable-baselines3[extra]) (4.11.3)
Requirement already satisfied: importlib-resources in /usr/local/lib/python3.7/dist-packages (from ale-py~=0.7.4-&gt;stable-baselines3[extra]) (5.7.1)
Requirement already satisfied: requests in /usr/local/lib/python3.7/dist-packages (from autorom[accept-rom-license]~=0.4.2-&gt;stable-baselines3[extra]) (2.23.0)
Requirement already satisfied: tqdm in /usr/local/lib/python3.7/dist-packages (from autorom[accept-rom-license]~=0.4.2-&gt;stable-baselines3[extra]) (4.64.0)
Requirement already satisfied: click in /usr/local/lib/python3.7/dist-packages (from autorom[accept-rom-license]~=0.4.2-&gt;stable-baselines3[extra]) (7.1.2)
Requirement already satisfied: AutoROM.accept-rom-license in /usr/local/lib/python3.7/dist-packages (from autorom[accept-rom-license]~=0.4.2-&gt;stable-baselines3[extra]) (0.4.2)
Requirement already satisfied: typing-extensions&gt;=3.6.4 in /usr/local/lib/python3.7/dist-packages (from importlib-metadata&gt;=4.8.1-&gt;gym==0.21-&gt;stable-baselines3[extra]) (4.2.0)
Requirement already satisfied: zipp&gt;=0.5 in /usr/local/lib/python3.7/dist-packages (from importlib-metadata&gt;=4.8.1-&gt;gym==0.21-&gt;stable-baselines3[extra]) (3.8.0)
Requirement already satisfied: werkzeug&gt;=0.11.15 in /usr/local/lib/python3.7/dist-packages (from tensorboard&gt;=2.2.0-&gt;stable-baselines3[extra]) (1.0.1)
Requirement already satisfied: google-auth-oauthlib&lt;0.5,&gt;=0.4.1 in /usr/local/lib/python3.7/dist-packages (from tensorboard&gt;=2.2.0-&gt;stable-baselines3[extra]) (0.4.6)
Requirement already satisfied: tensorboard-data-server&lt;0.7.0,&gt;=0.6.0 in /usr/local/lib/python3.7/dist-packages (from tensorboard&gt;=2.2.0-&gt;stable-baselines3[extra]) (0.6.1)
Requirement already satisfied: google-auth&lt;3,&gt;=1.6.3 in /usr/local/lib/python3.7/dist-packages (from tensorboard&gt;=2.2.0-&gt;stable-baselines3[extra]) (1.35.0)
Requirement already satisfied: absl-py&gt;=0.4 in /usr/local/lib/python3.7/dist-packages (from tensorboard&gt;=2.2.0-&gt;stable-baselines3[extra]) (1.0.0)
Requirement already satisfied: wheel&gt;=0.26 in /usr/local/lib/python3.7/dist-packages (from tensorboard&gt;=2.2.0-&gt;stable-baselines3[extra]) (0.37.1)
Requirement already satisfied: protobuf&gt;=3.6.0 in /usr/local/lib/python3.7/dist-packages (from tensorboard&gt;=2.2.0-&gt;stable-baselines3[extra]) (3.17.3)
Requirement already satisfied: grpcio&gt;=1.24.3 in /usr/local/lib/python3.7/dist-packages (from tensorboard&gt;=2.2.0-&gt;stable-baselines3[extra]) (1.44.0)
Requirement already satisfied: markdown&gt;=2.6.8 in /usr/local/lib/python3.7/dist-packages (from tensorboard&gt;=2.2.0-&gt;stable-baselines3[extra]) (3.3.6)
Requirement already satisfied: setuptools&gt;=41.0.0 in /usr/local/lib/python3.7/dist-packages (from tensorboard&gt;=2.2.0-&gt;stable-baselines3[extra]) (57.4.0)
Requirement already satisfied: tensorboard-plugin-wit&gt;=1.6.0 in /usr/local/lib/python3.7/dist-packages (from tensorboard&gt;=2.2.0-&gt;stable-baselines3[extra]) (1.8.1)
Requirement already satisfied: six in /usr/local/lib/python3.7/dist-packages (from absl-py&gt;=0.4-&gt;tensorboard&gt;=2.2.0-&gt;stable-baselines3[extra]) (1.15.0)
Requirement already satisfied: rsa&lt;5,&gt;=3.1.4 in /usr/local/lib/python3.7/dist-packages (from google-auth&lt;3,&gt;=1.6.3-&gt;tensorboard&gt;=2.2.0-&gt;stable-baselines3[extra]) (4.8)
Requirement already satisfied: cachetools&lt;5.0,&gt;=2.0.0 in /usr/local/lib/python3.7/dist-packages (from google-auth&lt;3,&gt;=1.6.3-&gt;tensorboard&gt;=2.2.0-&gt;stable-baselines3[extra]) (4.2.4)
Requirement already satisfied: pyasn1-modules&gt;=0.2.1 in /usr/local/lib/python3.7/dist-packages (from google-auth&lt;3,&gt;=1.6.3-&gt;tensorboard&gt;=2.2.0-&gt;stable-baselines3[extra]) (0.2.8)
Requirement already satisfied: requests-oauthlib&gt;=0.7.0 in /usr/local/lib/python3.7/dist-packages (from google-auth-oauthlib&lt;0.5,&gt;=0.4.1-&gt;tensorboard&gt;=2.2.0-&gt;stable-baselines3[extra]) (1.3.1)
Requirement already satisfied: pyasn1&lt;0.5.0,&gt;=0.4.6 in /usr/local/lib/python3.7/dist-packages (from pyasn1-modules&gt;=0.2.1-&gt;google-auth&lt;3,&gt;=1.6.3-&gt;tensorboard&gt;=2.2.0-&gt;stable-baselines3[extra]) (0.4.8)
Requirement already satisfied: idna&lt;3,&gt;=2.5 in /usr/local/lib/python3.7/dist-packages (from requests-&gt;autorom[accept-rom-license]~=0.4.2-&gt;stable-baselines3[extra]) (2.10)
Requirement already satisfied: chardet&lt;4,&gt;=3.0.2 in /usr/local/lib/python3.7/dist-packages (from requests-&gt;autorom[accept-rom-license]~=0.4.2-&gt;stable-baselines3[extra]) (3.0.4)
Requirement already satisfied: urllib3!=1.25.0,!=1.25.1,&lt;1.26,&gt;=1.21.1 in /usr/local/lib/python3.7/dist-packages (from requests-&gt;autorom[accept-rom-license]~=0.4.2-&gt;stable-baselines3[extra]) (1.24.3)
Requirement already satisfied: certifi&gt;=2017.4.17 in /usr/local/lib/python3.7/dist-packages (from requests-&gt;autorom[accept-rom-license]~=0.4.2-&gt;stable-baselines3[extra]) (2021.10.8)
Requirement already satisfied: oauthlib&gt;=3.0.0 in /usr/local/lib/python3.7/dist-packages (from requests-oauthlib&gt;=0.7.0-&gt;google-auth-oauthlib&lt;0.5,&gt;=0.4.1-&gt;tensorboard&gt;=2.2.0-&gt;stable-baselines3[extra]) (3.2.0)
Requirement already satisfied: cycler&gt;=0.10 in /usr/local/lib/python3.7/dist-packages (from matplotlib-&gt;stable-baselines3[extra]) (0.11.0)
Requirement already satisfied: pyparsing!=2.0.4,!=2.1.2,!=2.1.6,&gt;=2.0.1 in /usr/local/lib/python3.7/dist-packages (from matplotlib-&gt;stable-baselines3[extra]) (3.0.8)
Requirement already satisfied: kiwisolver&gt;=1.0.1 in /usr/local/lib/python3.7/dist-packages (from matplotlib-&gt;stable-baselines3[extra]) (1.4.2)
Requirement already satisfied: python-dateutil&gt;=2.1 in /usr/local/lib/python3.7/dist-packages (from matplotlib-&gt;stable-baselines3[extra]) (2.8.2)
Requirement already satisfied: pytz&gt;=2017.3 in /usr/local/lib/python3.7/dist-packages (from pandas-&gt;stable-baselines3[extra]) (2022.1)
Requirement already satisfied: pyvirtualdisplay in /usr/local/lib/python3.7/dist-packages (3.0)
Requirement already satisfied: PyOpenGL in /usr/local/lib/python3.7/dist-packages (3.1.6)
Requirement already satisfied: PyOpenGL-accelerate in /usr/local/lib/python3.7/dist-packages (3.1.5)
</pre>
</div>
</div>

</div>

</div>

</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p>For Google colab comment out this cell to make a virtual rendering canvas so render calls work (we still won&#39;t see display!)</p>

</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[2]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">pyvirtualdisplay</span>
<span class="c1">#</span>
<span class="n">_display</span> <span class="o">=</span> <span class="n">pyvirtualdisplay</span><span class="o">.</span><span class="n">Display</span><span class="p">(</span><span class="n">visible</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>  <span class="c1"># use False with Xvfb</span>
                                    <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">1400</span><span class="p">,</span> <span class="mi">900</span><span class="p">))</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">_display</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p>Import required packages.</p>

</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[3]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">torch</span> 
<span class="kn">import</span> <span class="nn">gym</span>
<span class="kn">import</span> <span class="nn">stable_baselines3</span> <span class="k">as</span> <span class="nn">sb3</span>
<span class="kn">import</span> <span class="nn">imageio</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">base64</span>
<span class="kn">import</span> <span class="nn">IPython</span>
<span class="kn">import</span> <span class="nn">PIL.Image</span>
<span class="kn">import</span> <span class="nn">pyvirtualdisplay</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">gym</span>
<span class="kn">from</span> <span class="nn">stable_baselines3</span> <span class="kn">import</span> <span class="n">PPO</span> <span class="p">,</span><span class="n">A2C</span>
<span class="kn">from</span> <span class="nn">stable_baselines3.common.vec_env</span> <span class="kn">import</span> <span class="n">DummyVecEnv</span> <span class="c1"># Vectorise the environment</span>
<span class="kn">from</span> <span class="nn">stable_baselines3.common.evaluation</span> <span class="kn">import</span> <span class="n">evaluate_policy</span> <span class="c1"># gives average reward and SD of that</span>
<span class="kn">from</span> <span class="nn">stable_baselines3.common.vec_env</span> <span class="kn">import</span> <span class="n">VecFrameStack</span>

<span class="c1"># Video stuff </span>
<span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
<span class="kn">from</span> <span class="nn">IPython</span> <span class="kn">import</span> <span class="n">display</span> <span class="k">as</span> <span class="n">ipythondisplay</span>
<span class="kn">from</span> <span class="nn">stable_baselines3.common.vec_env</span> <span class="kn">import</span> <span class="n">VecVideoRecorder</span><span class="p">,</span> <span class="n">SubprocVecEnv</span><span class="p">,</span> <span class="n">DummyVecEnv</span>

<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span> <span class="c1"># For data frames and data frame manipulation</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;display.max_rows&#39;</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;display.max_columns&#39;</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;display.width&#39;</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span> <span class="c1"># For general  numeric operations</span>

<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="o">%</span><span class="k">matplotlib</span> inline 
</pre></div>

     </div>
</div>
</div>
</div>

</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h3>Create and Explore the Environment<a rel="noopener" class="anchor-link" href="#Create-and-Explore-the-Environment">&#182;</a></h3>
</div>
</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p>Create the <strong>CarRacing-v0</strong> environment. Add wrappers to resize the images and convert to greyscale.</p>

</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[4]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">env</span> <span class="o">=</span> <span class="n">gym</span><span class="o">.</span><span class="n">make</span><span class="p">(</span><span class="s1">&#39;CarRacing-v0&#39;</span><span class="p">)</span>
<span class="n">env</span> <span class="o">=</span> <span class="n">gym</span><span class="o">.</span><span class="n">wrappers</span><span class="o">.</span><span class="n">resize_observation</span><span class="o">.</span><span class="n">ResizeObservation</span><span class="p">(</span><span class="n">env</span><span class="p">,</span> <span class="mi">64</span><span class="p">)</span>
<span class="n">env</span> <span class="o">=</span> <span class="n">gym</span><span class="o">.</span><span class="n">wrappers</span><span class="o">.</span><span class="n">gray_scale_observation</span><span class="o">.</span><span class="n">GrayScaleObservation</span><span class="p">(</span><span class="n">env</span><span class="p">,</span> <span class="n">keep_dim</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p>Explore the environment - view the action space and observation space.</p>

</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[5]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">env</span><span class="o">.</span><span class="n">action_space</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[5]:</div>




<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult">
<pre>Box([-1.  0.  0.], [1. 1. 1.], (3,), float32)</pre>
</div>

</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[6]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">env</span><span class="o">.</span><span class="n">observation_space</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[6]:</div>




<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult">
<pre>Box([[[0]
  [0]
  [0]
  ...
  [0]
  [0]
  [0]]

 [[0]
  [0]
  [0]
  ...
  [0]
  [0]
  [0]]

 [[0]
  [0]
  [0]
  ...
  [0]
  [0]
  [0]]

 ...

 [[0]
  [0]
  [0]
  ...
  [0]
  [0]
  [0]]

 [[0]
  [0]
  [0]
  ...
  [0]
  [0]
  [0]]

 [[0]
  [0]
  [0]
  ...
  [0]
  [0]
  [0]]], [[[255]
  [255]
  [255]
  ...
  [255]
  [255]
  [255]]

 [[255]
  [255]
  [255]
  ...
  [255]
  [255]
  [255]]

 [[255]
  [255]
  [255]
  ...
  [255]
  [255]
  [255]]

 ...

 [[255]
  [255]
  [255]
  ...
  [255]
  [255]
  [255]]

 [[255]
  [255]
  [255]
  ...
  [255]
  [255]
  [255]]

 [[255]
  [255]
  [255]
  ...
  [255]
  [255]
  [255]]], (64, 64, 1), uint8)</pre>
</div>

</div>

</div>

</div>

</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p>Play an episode of the environment using random actions</p>

</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[7]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">episodes</span><span class="o">=</span><span class="mi">5</span>
<span class="k">for</span> <span class="n">episode</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">episodes</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">state</span><span class="o">=</span><span class="n">env</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span> <span class="c1"># observation for the environment , returns vector</span>
    <span class="n">done</span><span class="o">=</span><span class="kc">False</span>
    <span class="n">score</span><span class="o">=</span><span class="mi">0</span>
    
    <span class="k">while</span> <span class="ow">not</span> <span class="n">done</span><span class="p">:</span>
        <span class="c1">#screen = env.render(mode=&#39;rgb_array&#39;)</span>
        <span class="c1">#plt.imshow(screen)</span>
        <span class="c1">#ipythondisplay.clear_output(wait=True)</span>
        <span class="c1">#ipythondisplay.display(plt.gcf())</span>
        <span class="n">action</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">action_space</span><span class="o">.</span><span class="n">sample</span><span class="p">()</span> <span class="c1"># generates the random action </span>
        <span class="n">n_state</span><span class="p">,</span><span class="n">reward</span><span class="p">,</span><span class="n">done</span><span class="p">,</span><span class="n">info</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">action</span><span class="p">)</span> <span class="c1"># returns next set of observation, reward, wheteher or not episode is done</span>
        <span class="n">score</span><span class="o">+=</span><span class="n">reward</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Episode:</span><span class="si">{}</span><span class="s2">,Score:</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">episode</span><span class="p">,</span><span class="n">score</span><span class="p">))</span>
<span class="n">env</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>Track generation: 1137..1425 -&gt; 288-tiles track
Episode:0,Score:-30.313588850174582
Track generation: 1244..1559 -&gt; 315-tiles track
Episode:1,Score:-36.30573248407693
Track generation: 1143..1433 -&gt; 290-tiles track
Episode:2,Score:-30.795847750865516
Track generation: 1132..1419 -&gt; 287-tiles track
Episode:3,Score:-33.56643356643401
Track generation: 1181..1480 -&gt; 299-tiles track
Episode:4,Score:-32.88590604026898
Track generation: 963..1215 -&gt; 252-tiles track
Episode:5,Score:-20.31872509960172
</pre>
</div>
</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[8]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Display video recording of the rendered event</span>
<span class="k">def</span> <span class="nf">show_videos</span><span class="p">(</span><span class="n">video_path</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="s1">&#39;ppo-carracing&#39;</span><span class="p">):</span>
  <span class="n">html</span> <span class="o">=</span> <span class="p">[]</span>
  <span class="k">for</span> <span class="n">mp4</span> <span class="ow">in</span> <span class="n">Path</span><span class="p">(</span><span class="n">video_path</span><span class="p">)</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">*.mp4&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">prefix</span><span class="p">)):</span>
      <span class="n">video_b64</span> <span class="o">=</span> <span class="n">base64</span><span class="o">.</span><span class="n">b64encode</span><span class="p">(</span><span class="n">mp4</span><span class="o">.</span><span class="n">read_bytes</span><span class="p">())</span>
      <span class="n">html</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;&#39;&#39;&lt;video alt=&quot;</span><span class="si">{}</span><span class="s1">&quot; autoplay </span>
<span class="s1">                    loop controls style=&quot;height: 400px;&quot;&gt;</span>
<span class="s1">                    &lt;source src=&quot;data:video/mp4;base64,</span><span class="si">{}</span><span class="s1">&quot; type=&quot;video/mp4&quot; /&gt;</span>
<span class="s1">                &lt;/video&gt;&#39;&#39;&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">mp4</span><span class="p">,</span> <span class="n">video_b64</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;ascii&#39;</span><span class="p">)))</span>
  <span class="n">ipythondisplay</span><span class="o">.</span><span class="n">display</span><span class="p">(</span><span class="n">ipythondisplay</span><span class="o">.</span><span class="n">HTML</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="s2">&quot;&lt;br&gt;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">html</span><span class="p">)))</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h3>&#160;Single Image Agent<a rel="noopener" class="anchor-link" href="#&#160;Single-Image-Agent">&#182;</a></h3><p>Create an agent that controls the car using a single image frame as the state input. We recommend a PPO agent with the following hyper-parameters (although you can experiment):</p>
<ul>
<li>learning_rate = 3e-5</li>
<li>n_steps = 512</li>
<li>ent_coef = 0.001</li>
<li>batch_size = 128</li>
<li>gae_lambda =  0.9</li>
<li>n_epochs = 20</li>
<li>use_sde = True</li>
<li>sde_sample_freq = 4</li>
<li>clip_range = 0.4</li>
<li>policy_kwargs = {&#39;log_std_init&#39;: -2, &#39;ortho_init&#39;:False},</li>
</ul>
<p>We also recommend enabling <strong>tensorboard</strong> monitoring of the training process.</p>

</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[9]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">env_name</span><span class="o">=</span><span class="s1">&#39;CarRacing-v0&#39;</span>
<span class="n">env</span><span class="o">=</span><span class="n">gym</span><span class="o">.</span><span class="n">make</span><span class="p">(</span><span class="n">env_name</span><span class="p">)</span>

<span class="n">env</span> <span class="o">=</span> <span class="n">DummyVecEnv</span><span class="p">([</span><span class="k">lambda</span><span class="p">:</span><span class="n">env</span><span class="p">])</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[10]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">log_path</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;RL_Training&#39;</span><span class="p">,</span><span class="s1">&#39;Logs&#39;</span><span class="p">)</span>
<span class="n">model</span><span class="o">=</span><span class="n">PPO</span><span class="p">(</span><span class="s1">&#39;CnnPolicy&#39;</span><span class="p">,</span><span class="n">env</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">tensorboard_log</span><span class="o">=</span><span class="n">log_path</span><span class="p">,</span> <span class="n">learning_rate</span><span class="o">=</span><span class="mf">3e-5</span><span class="p">,</span><span class="n">n_steps</span> <span class="o">=</span> <span class="mi">512</span><span class="p">,</span><span class="n">ent_coef</span> <span class="o">=</span> <span class="mf">0.001</span><span class="p">,</span>
            <span class="n">batch_size</span> <span class="o">=</span> <span class="mi">128</span><span class="p">,</span><span class="n">gae_lambda</span> <span class="o">=</span> <span class="mf">0.9</span><span class="p">,</span><span class="n">n_epochs</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span><span class="n">use_sde</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span><span class="n">sde_sample_freq</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span><span class="n">clip_range</span> <span class="o">=</span> <span class="mf">0.4</span><span class="p">,</span><span class="n">policy_kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;log_std_init&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;ortho_init&#39;</span><span class="p">:</span><span class="kc">False</span><span class="p">})</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>Using cpu device
Wrapping the env in a VecTransposeImage.
</pre>
</div>
</div>

</div>

</div>

</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p>Examine the actor and critic network architectures.</p>

</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[11]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">policy</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>ActorCriticCnnPolicy(
  (features_extractor): NatureCNN(
    (cnn): Sequential(
      (0): Conv2d(3, 32, kernel_size=(8, 8), stride=(4, 4))
      (1): ReLU()
      (2): Conv2d(32, 64, kernel_size=(4, 4), stride=(2, 2))
      (3): ReLU()
      (4): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1))
      (5): ReLU()
      (6): Flatten(start_dim=1, end_dim=-1)
    )
    (linear): Sequential(
      (0): Linear(in_features=4096, out_features=512, bias=True)
      (1): ReLU()
    )
  )
  (mlp_extractor): MlpExtractor(
    (shared_net): Sequential()
    (policy_net): Sequential()
    (value_net): Sequential()
  )
  (action_net): Linear(in_features=512, out_features=3, bias=True)
  (value_net): Linear(in_features=512, out_features=1, bias=True)
)
</pre>
</div>
</div>

</div>

</div>

</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p>Create an evaluation callback that is called every at regular intervals and renders the episode.</p>

</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[12]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">eval_env</span> <span class="o">=</span> <span class="n">gym</span><span class="o">.</span><span class="n">make</span><span class="p">(</span><span class="s1">&#39;CarRacing-v0&#39;</span><span class="p">)</span>
<span class="n">eval_callback</span> <span class="o">=</span> <span class="n">sb3</span><span class="o">.</span><span class="n">common</span><span class="o">.</span><span class="n">callbacks</span><span class="o">.</span><span class="n">EvalCallback</span><span class="p">(</span><span class="n">eval_env</span><span class="p">,</span> 
                                                  <span class="n">best_model_save_path</span><span class="o">=</span><span class="s1">&#39;./log_tb_carracing_PPO/&#39;</span><span class="p">,</span>
                                                  <span class="n">log_path</span><span class="o">=</span><span class="s1">&#39;./log_tb_carracing_PPO/&#39;</span><span class="p">,</span> 
                                                  <span class="n">eval_freq</span><span class="o">=</span><span class="mi">5000</span><span class="p">,</span>
                                                  <span class="n">render</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p>Train the model for a large number of timesteps (500,000 timesteps will probably work well).</p>

</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[13]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">learn</span><span class="p">(</span><span class="n">total_timesteps</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span>
           <span class="n">callback</span><span class="o">=</span><span class="n">eval_callback</span><span class="p">,</span>
            <span class="n">tb_log_name</span><span class="o">=</span><span class="s2">&quot;Basic PPO Network - single Agent&quot;</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>Track generation: 1030..1292 -&gt; 262-tiles track
Logging to RL_Training/Logs/Basic PPO Network - single Agent_4
</pre>
</div>
</div>

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>/usr/local/lib/python3.7/dist-packages/stable_baselines3/common/callbacks.py:345: UserWarning: Training and eval env are not of the same type&lt;stable_baselines3.common.vec_env.vec_transpose.VecTransposeImage object at 0x7f1897751650&gt; != &lt;stable_baselines3.common.vec_env.dummy_vec_env.DummyVecEnv object at 0x7f17cbf43810&gt;
  warnings.warn(&quot;Training and eval env are not of the same type&quot; f&quot;{self.training_env} != {self.eval_env}&quot;)
</pre>
</div>
</div>

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>----------------------------
| time/              |     |
|    fps             | 70  |
|    iterations      | 1   |
|    time_elapsed    | 7   |
|    total_timesteps | 512 |
----------------------------
Track generation: 1051..1328 -&gt; 277-tiles track
----------------------------------------
| time/                   |            |
|    fps                  | 47         |
|    iterations           | 2          |
|    time_elapsed         | 21         |
|    total_timesteps      | 1024       |
| train/                  |            |
|    approx_kl            | 0.22158775 |
|    clip_fraction        | 0.423      |
|    clip_range           | 0.4        |
|    entropy_loss         | 4.82       |
|    explained_variance   | -7.05e-05  |
|    learning_rate        | 3e-05      |
|    loss                 | 0.7        |
|    n_updates            | 20         |
|    policy_gradient_loss | 0.00199    |
|    std                  | 0.135      |
|    value_loss           | 1.13       |
----------------------------------------
---------------------------------------
| time/                   |           |
|    fps                  | 42        |
|    iterations           | 3         |
|    time_elapsed         | 36        |
|    total_timesteps      | 1536      |
| train/                  |           |
|    approx_kl            | 3.6350236 |
|    clip_fraction        | 0.764     |
|    clip_range           | 0.4       |
|    entropy_loss         | 1.57      |
|    explained_variance   | 0.00284   |
|    learning_rate        | 3e-05     |
|    loss                 | 0.467     |
|    n_updates            | 40        |
|    policy_gradient_loss | 0.142     |
|    std                  | 0.135     |
|    value_loss           | 0.984     |
---------------------------------------
Track generation: 943..1187 -&gt; 244-tiles track
---------------------------------------
| time/                   |           |
|    fps                  | 40        |
|    iterations           | 4         |
|    time_elapsed         | 50        |
|    total_timesteps      | 2048      |
| train/                  |           |
|    approx_kl            | 1.2704415 |
|    clip_fraction        | 0.755     |
|    clip_range           | 0.4       |
|    entropy_loss         | -2.64     |
|    explained_variance   | 0.128     |
|    learning_rate        | 3e-05     |
|    loss                 | 0.153     |
|    n_updates            | 60        |
|    policy_gradient_loss | 0.03      |
|    std                  | 0.135     |
|    value_loss           | 0.522     |
---------------------------------------
----------------------------------------
| time/                   |            |
|    fps                  | 39         |
|    iterations           | 5          |
|    time_elapsed         | 64         |
|    total_timesteps      | 2560       |
| train/                  |            |
|    approx_kl            | 0.11950648 |
|    clip_fraction        | 0.337      |
|    clip_range           | 0.4        |
|    entropy_loss         | -4.43      |
|    explained_variance   | 0.394      |
|    learning_rate        | 3e-05      |
|    loss                 | 0.185      |
|    n_updates            | 80         |
|    policy_gradient_loss | 0.00498    |
|    std                  | 0.135      |
|    value_loss           | 0.394      |
----------------------------------------
Track generation: 1283..1608 -&gt; 325-tiles track
----------------------------------------
| time/                   |            |
|    fps                  | 38         |
|    iterations           | 6          |
|    time_elapsed         | 79         |
|    total_timesteps      | 3072       |
| train/                  |            |
|    approx_kl            | 0.15481797 |
|    clip_fraction        | 0.326      |
|    clip_range           | 0.4        |
|    entropy_loss         | -5.26      |
|    explained_variance   | 0.483      |
|    learning_rate        | 3e-05      |
|    loss                 | 0.0621     |
|    n_updates            | 100        |
|    policy_gradient_loss | 0.0345     |
|    std                  | 0.135      |
|    value_loss           | 0.085      |
----------------------------------------
-----------------------------------------
| time/                   |             |
|    fps                  | 37          |
|    iterations           | 7           |
|    time_elapsed         | 94          |
|    total_timesteps      | 3584        |
| train/                  |             |
|    approx_kl            | 0.109803155 |
|    clip_fraction        | 0.247       |
|    clip_range           | 0.4         |
|    entropy_loss         | -3.8        |
|    explained_variance   | 0.648       |
|    learning_rate        | 3e-05       |
|    loss                 | 0.324       |
|    n_updates            | 120         |
|    policy_gradient_loss | -0.0447     |
|    std                  | 0.135       |
|    value_loss           | 0.662       |
-----------------------------------------
Track generation: 1212..1519 -&gt; 307-tiles track
-----------------------------------------
| time/                   |             |
|    fps                  | 37          |
|    iterations           | 8           |
|    time_elapsed         | 109         |
|    total_timesteps      | 4096        |
| train/                  |             |
|    approx_kl            | 0.046540305 |
|    clip_fraction        | 0.211       |
|    clip_range           | 0.4         |
|    entropy_loss         | -4.62       |
|    explained_variance   | 0.899       |
|    learning_rate        | 3e-05       |
|    loss                 | 0.0299      |
|    n_updates            | 140         |
|    policy_gradient_loss | -0.0205     |
|    std                  | 0.135       |
|    value_loss           | 0.263       |
-----------------------------------------
----------------------------------------
| time/                   |            |
|    fps                  | 36         |
|    iterations           | 9          |
|    time_elapsed         | 124        |
|    total_timesteps      | 4608       |
| train/                  |            |
|    approx_kl            | 0.19571374 |
|    clip_fraction        | 0.358      |
|    clip_range           | 0.4        |
|    entropy_loss         | -6.2       |
|    explained_variance   | 0.897      |
|    learning_rate        | 3e-05      |
|    loss                 | 0.153      |
|    n_updates            | 160        |
|    policy_gradient_loss | 0.00144    |
|    std                  | 0.135      |
|    value_loss           | 0.213      |
----------------------------------------
Track generation: 1267..1588 -&gt; 321-tiles track
Track generation: 1115..1403 -&gt; 288-tiles track
</pre>
</div>
</div>

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>/usr/local/lib/python3.7/dist-packages/stable_baselines3/common/evaluation.py:69: UserWarning: Evaluation environment is not wrapped with a ``Monitor`` wrapper. This may result in reporting modified episode lengths and rewards, if other wrappers happen to modify these. Consider wrapping environment first with ``Monitor`` wrapper.
  UserWarning,
</pre>
</div>
</div>

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>Track generation: 1155..1448 -&gt; 293-tiles track
Track generation: 1139..1428 -&gt; 289-tiles track
Track generation: 1192..1494 -&gt; 302-tiles track
Track generation: 1148..1446 -&gt; 298-tiles track
Track generation: 1068..1342 -&gt; 274-tiles track
retry to generate track (normal if there are not manyinstances of this message)
Track generation: 1227..1538 -&gt; 311-tiles track
Eval num_timesteps=5000, episode_reward=-45.99 +/- 7.27
Episode length: 1000.00 +/- 0.00
----------------------------------------
| eval/                   |            |
|    mean_ep_length       | 1e+03      |
|    mean_reward          | -46        |
| time/                   |            |
|    total_timesteps      | 5000       |
| train/                  |            |
|    approx_kl            | 0.06531533 |
|    clip_fraction        | 0.163      |
|    clip_range           | 0.4        |
|    entropy_loss         | -6.19      |
|    explained_variance   | 0.944      |
|    learning_rate        | 3e-05      |
|    loss                 | -0.0632    |
|    n_updates            | 180        |
|    policy_gradient_loss | -0.0319    |
|    std                  | 0.135      |
|    value_loss           | 0.115      |
----------------------------------------
New best mean reward!
-----------------------------
| time/              |      |
|    fps             | 21   |
|    iterations      | 10   |
|    time_elapsed    | 235  |
|    total_timesteps | 5120 |
-----------------------------
-----------------------------------------
| time/                   |             |
|    fps                  | 22          |
|    iterations           | 11          |
|    time_elapsed         | 250         |
|    total_timesteps      | 5632        |
| train/                  |             |
|    approx_kl            | 0.118615024 |
|    clip_fraction        | 0.227       |
|    clip_range           | 0.4         |
|    entropy_loss         | -6.02       |
|    explained_variance   | 0.832       |
|    learning_rate        | 3e-05       |
|    loss                 | -0.00459    |
|    n_updates            | 200         |
|    policy_gradient_loss | -0.0247     |
|    std                  | 0.135       |
|    value_loss           | 0.4         |
-----------------------------------------
Track generation: 1103..1383 -&gt; 280-tiles track
-----------------------------------------
| time/                   |             |
|    fps                  | 23          |
|    iterations           | 12          |
|    time_elapsed         | 265         |
|    total_timesteps      | 6144        |
| train/                  |             |
|    approx_kl            | 0.022502154 |
|    clip_fraction        | 0.0633      |
|    clip_range           | 0.4         |
|    entropy_loss         | -5.96       |
|    explained_variance   | 0.816       |
|    learning_rate        | 3e-05       |
|    loss                 | 0.0745      |
|    n_updates            | 220         |
|    policy_gradient_loss | -0.0119     |
|    std                  | 0.135       |
|    value_loss           | 0.241       |
-----------------------------------------
----------------------------------------
| time/                   |            |
|    fps                  | 23         |
|    iterations           | 13         |
|    time_elapsed         | 280        |
|    total_timesteps      | 6656       |
| train/                  |            |
|    approx_kl            | 0.11457746 |
|    clip_fraction        | 0.243      |
|    clip_range           | 0.4        |
|    entropy_loss         | -6.87      |
|    explained_variance   | 0.875      |
|    learning_rate        | 3e-05      |
|    loss                 | 0.00981    |
|    n_updates            | 240        |
|    policy_gradient_loss | -0.0247    |
|    std                  | 0.135      |
|    value_loss           | 0.263      |
----------------------------------------
Track generation: 1131..1418 -&gt; 287-tiles track
-----------------------------------------
| time/                   |             |
|    fps                  | 24          |
|    iterations           | 14          |
|    time_elapsed         | 296         |
|    total_timesteps      | 7168        |
| train/                  |             |
|    approx_kl            | 0.056186125 |
|    clip_fraction        | 0.0745      |
|    clip_range           | 0.4         |
|    entropy_loss         | -6.75       |
|    explained_variance   | 0.911       |
|    learning_rate        | 3e-05       |
|    loss                 | 0.0243      |
|    n_updates            | 260         |
|    policy_gradient_loss | -0.0414     |
|    std                  | 0.135       |
|    value_loss           | 0.263       |
-----------------------------------------
-----------------------------------------
| time/                   |             |
|    fps                  | 24          |
|    iterations           | 15          |
|    time_elapsed         | 311         |
|    total_timesteps      | 7680        |
| train/                  |             |
|    approx_kl            | 0.014225592 |
|    clip_fraction        | 0.0456      |
|    clip_range           | 0.4         |
|    entropy_loss         | -7.23       |
|    explained_variance   | 0.815       |
|    learning_rate        | 3e-05       |
|    loss                 | 0.385       |
|    n_updates            | 280         |
|    policy_gradient_loss | -0.0208     |
|    std                  | 0.135       |
|    value_loss           | 0.569       |
-----------------------------------------
Track generation: 1118..1407 -&gt; 289-tiles track
----------------------------------------
| time/                   |            |
|    fps                  | 25         |
|    iterations           | 16         |
|    time_elapsed         | 327        |
|    total_timesteps      | 8192       |
| train/                  |            |
|    approx_kl            | 0.33714512 |
|    clip_fraction        | 0.391      |
|    clip_range           | 0.4        |
|    entropy_loss         | -7.14      |
|    explained_variance   | 0.902      |
|    learning_rate        | 3e-05      |
|    loss                 | 0.343      |
|    n_updates            | 300        |
|    policy_gradient_loss | 0.00723    |
|    std                  | 0.135      |
|    value_loss           | 0.641      |
----------------------------------------
----------------------------------------
| time/                   |            |
|    fps                  | 25         |
|    iterations           | 17         |
|    time_elapsed         | 342        |
|    total_timesteps      | 8704       |
| train/                  |            |
|    approx_kl            | 0.07901476 |
|    clip_fraction        | 0.219      |
|    clip_range           | 0.4        |
|    entropy_loss         | -6.43      |
|    explained_variance   | 0.849      |
|    learning_rate        | 3e-05      |
|    loss                 | 0.205      |
|    n_updates            | 320        |
|    policy_gradient_loss | -0.0541    |
|    std                  | 0.135      |
|    value_loss           | 0.636      |
----------------------------------------
Track generation: 1160..1454 -&gt; 294-tiles track
-----------------------------------------
| time/                   |             |
|    fps                  | 25          |
|    iterations           | 18          |
|    time_elapsed         | 357         |
|    total_timesteps      | 9216        |
| train/                  |             |
|    approx_kl            | 0.058032468 |
|    clip_fraction        | 0.244       |
|    clip_range           | 0.4         |
|    entropy_loss         | -7.02       |
|    explained_variance   | 0.851       |
|    learning_rate        | 3e-05       |
|    loss                 | 0.419       |
|    n_updates            | 340         |
|    policy_gradient_loss | -0.0275     |
|    std                  | 0.135       |
|    value_loss           | 1.15        |
-----------------------------------------
----------------------------------------
| time/                   |            |
|    fps                  | 26         |
|    iterations           | 19         |
|    time_elapsed         | 372        |
|    total_timesteps      | 9728       |
| train/                  |            |
|    approx_kl            | 0.26351467 |
|    clip_fraction        | 0.216      |
|    clip_range           | 0.4        |
|    entropy_loss         | -7.07      |
|    explained_variance   | 0.877      |
|    learning_rate        | 3e-05      |
|    loss                 | 0.472      |
|    n_updates            | 360        |
|    policy_gradient_loss | 0.0331     |
|    std                  | 0.135      |
|    value_loss           | 1.27       |
----------------------------------------
Track generation: 1030..1302 -&gt; 272-tiles track
Track generation: 1100..1379 -&gt; 279-tiles track
Track generation: 1236..1549 -&gt; 313-tiles track
Track generation: 1227..1538 -&gt; 311-tiles track
Track generation: 959..1206 -&gt; 247-tiles track
Track generation: 1287..1613 -&gt; 326-tiles track
Track generation: 1019..1278 -&gt; 259-tiles track
Eval num_timesteps=10000, episode_reward=-83.64 +/- 0.87
Episode length: 1000.00 +/- 0.00
----------------------------------------
| eval/                   |            |
|    mean_ep_length       | 1e+03      |
|    mean_reward          | -83.6      |
| time/                   |            |
|    total_timesteps      | 10000      |
| train/                  |            |
|    approx_kl            | 0.20133226 |
|    clip_fraction        | 0.297      |
|    clip_range           | 0.4        |
|    entropy_loss         | -8.32      |
|    explained_variance   | 0.821      |
|    learning_rate        | 3e-05      |
|    loss                 | 0.114      |
|    n_updates            | 380        |
|    policy_gradient_loss | -0.0341    |
|    std                  | 0.135      |
|    value_loss           | 0.377      |
----------------------------------------
------------------------------
| time/              |       |
|    fps             | 20    |
|    iterations      | 20    |
|    time_elapsed    | 487   |
|    total_timesteps | 10240 |
------------------------------
</pre>
</div>
</div>

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[13]:</div>




<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult">
<pre>&lt;stable_baselines3.ppo.ppo.PPO at 0x7f17cbfca150&gt;</pre>
</div>

</div>

</div>

</div>

</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p>Connect to the tensorboard log using <strong>TensorBoard</strong> from the command line to view training progress:</p>
<p><code>tensorboard --logdir ./logs_carracing_PPO/</code></p>
<p>Then open TensorBoard in a browser, typically located at:</p>
<p><code>http://localhost:6006/</code></p>

</div>
</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p>Save the trained agent.</p>

</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">save_path_single_agent</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;RL_Training&#39;</span><span class="p">,</span><span class="s1">&#39;Saved Models&#39;</span><span class="p">,</span><span class="s1">&#39;PPO_self_driving-singleAgent&#39;</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">save_path_single_agent</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p>For memory management delete old agent and environment (assumes variable names - change if required).</p>

</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[15]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="k">del</span> <span class="n">model</span>
<span class="k">del</span> <span class="n">env</span>
<span class="k">del</span> <span class="n">eval_env</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h3>&#160;Create Image Stack Agent<a rel="noopener" class="anchor-link" href="#&#160;Create-Image-Stack-Agent">&#182;</a></h3>
</div>
</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p>Create the CarRacing-v0 environment using wrappers to resize the images to 64 x 64 and change to greyscale. Also add a wrapper to create a stack of 4 frames.</p>

</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[16]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">env_name</span><span class="o">=</span><span class="s1">&#39;CarRacing-v0&#39;</span>
<span class="n">env</span><span class="o">=</span><span class="n">gym</span><span class="o">.</span><span class="n">make</span><span class="p">(</span><span class="n">env_name</span><span class="p">)</span>
<span class="n">env</span> <span class="o">=</span>  <span class="n">sb3</span><span class="o">.</span><span class="n">common</span><span class="o">.</span><span class="n">env_util</span><span class="o">.</span><span class="n">make_vec_env</span><span class="p">(</span><span class="s1">&#39;CarRacing-v0&#39;</span><span class="p">,</span><span class="n">n_envs</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">seed</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">env</span> <span class="o">=</span> <span class="n">VecFrameStack</span><span class="p">(</span><span class="n">env</span><span class="p">,</span> <span class="n">n_stack</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p>Create an agent that controls the car using a stack of input image frames as the state input. We recommend a PPO agent with the following hyper-parameters (although you can experiment):</p>
<ul>
<li>learning_rate = 3e-5</li>
<li>n_steps = 512</li>
<li>ent_coef = 0.001</li>
<li>batch_size = 128</li>
<li>gae_lambda =  0.9</li>
<li>n_epochs = 20</li>
<li>use_sde = True</li>
<li>sde_sample_freq = 4</li>
<li>clip_range = 0.4</li>
<li>policy_kwargs = {&#39;log_std_init&#39;: -2, &#39;ortho_init&#39;:False},</li>
</ul>
<p>We also recommend enabling <strong>tensorboard</strong> monitoring of the training process.</p>

</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[17]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">log_path</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;RL_Training&#39;</span><span class="p">,</span><span class="s1">&#39;Logs&#39;</span><span class="p">)</span>

<span class="n">model</span><span class="o">=</span><span class="n">PPO</span><span class="p">(</span><span class="s1">&#39;CnnPolicy&#39;</span><span class="p">,</span><span class="n">env</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">tensorboard_log</span><span class="o">=</span><span class="n">log_path</span><span class="p">,</span><span class="n">learning_rate</span><span class="o">=</span><span class="mf">3e-5</span><span class="p">,</span><span class="n">n_steps</span><span class="o">=</span><span class="mi">512</span><span class="p">,</span><span class="n">ent_coef</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span><span class="n">batch_size</span><span class="o">=</span><span class="mi">128</span><span class="p">,</span>
             <span class="n">gae_lambda</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span><span class="n">n_epochs</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="n">use_sde</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">sde_sample_freq</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="n">clip_range</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span><span class="n">policy_kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;log_std_init&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;ortho_init&#39;</span><span class="p">:</span><span class="kc">False</span><span class="p">})</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>Using cpu device
Wrapping the env in a VecTransposeImage.
</pre>
</div>
</div>

</div>

</div>

</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p>Examine the actor and critic network architectures.</p>

</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[18]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">policy</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>ActorCriticCnnPolicy(
  (features_extractor): NatureCNN(
    (cnn): Sequential(
      (0): Conv2d(12, 32, kernel_size=(8, 8), stride=(4, 4))
      (1): ReLU()
      (2): Conv2d(32, 64, kernel_size=(4, 4), stride=(2, 2))
      (3): ReLU()
      (4): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1))
      (5): ReLU()
      (6): Flatten(start_dim=1, end_dim=-1)
    )
    (linear): Sequential(
      (0): Linear(in_features=4096, out_features=512, bias=True)
      (1): ReLU()
    )
  )
  (mlp_extractor): MlpExtractor(
    (shared_net): Sequential()
    (policy_net): Sequential()
    (value_net): Sequential()
  )
  (action_net): Linear(in_features=512, out_features=3, bias=True)
  (value_net): Linear(in_features=512, out_features=1, bias=True)
)
</pre>
</div>
</div>

</div>

</div>

</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p>Create an evaluation callback that is called every at regular intervals and renders the episode.</p>

</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[19]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">stable_baselines3.common.callbacks</span> <span class="kn">import</span> <span class="n">StopTrainingOnRewardThreshold</span>
<span class="n">eval_env</span><span class="o">=</span><span class="n">gym</span><span class="o">.</span><span class="n">make</span><span class="p">(</span><span class="s1">&#39;CarRacing-v0&#39;</span><span class="p">)</span>
<span class="n">eval_env</span> <span class="o">=</span>  <span class="n">sb3</span><span class="o">.</span><span class="n">common</span><span class="o">.</span><span class="n">env_util</span><span class="o">.</span><span class="n">make_vec_env</span><span class="p">(</span><span class="s1">&#39;CarRacing-v0&#39;</span><span class="p">,</span><span class="n">n_envs</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">seed</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">stop_call</span> <span class="o">=</span> <span class="n">StopTrainingOnRewardThreshold</span><span class="p">(</span><span class="n">reward_threshold</span><span class="o">=</span><span class="mi">190</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">eval_env</span> <span class="o">=</span> <span class="n">sb3</span><span class="o">.</span><span class="n">common</span><span class="o">.</span><span class="n">vec_env</span><span class="o">.</span><span class="n">VecFrameStack</span><span class="p">(</span><span class="n">eval_env</span><span class="p">,</span> <span class="n">n_stack</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">eval_callback</span> <span class="o">=</span> <span class="n">sb3</span><span class="o">.</span><span class="n">common</span><span class="o">.</span><span class="n">callbacks</span><span class="o">.</span><span class="n">EvalCallback</span><span class="p">(</span><span class="n">eval_env</span><span class="p">,</span> 
                                                  <span class="n">callback_on_new_best</span> <span class="o">=</span> <span class="n">stop_call</span><span class="p">,</span>
                                                  <span class="n">best_model_save_path</span><span class="o">=</span><span class="s1">&#39;./log_tb_carracing_PPO/&#39;</span><span class="p">,</span>
                                                  <span class="n">log_path</span><span class="o">=</span><span class="s1">&#39;./log_tb_carracing_PPO/&#39;</span><span class="p">,</span> 
                                                  <span class="n">eval_freq</span><span class="o">=</span><span class="mi">50000</span><span class="p">,</span>
                                                  <span class="n">render</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[20]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">eval_env</span><span class="o">.</span><span class="n">observation_space</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[20]:</div>




<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult">
<pre>(96, 96, 12)</pre>
</div>

</div>

</div>

</div>

</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p>Train the model for a large number of timesteps (500,000 timesteps will probably work well).</p>

</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[21]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">learn</span><span class="p">(</span><span class="n">total_timesteps</span><span class="o">=</span><span class="mi">100000</span><span class="p">,</span> 
            <span class="n">callback</span><span class="o">=</span><span class="n">eval_callback</span><span class="p">,</span>
            <span class="n">tb_log_name</span><span class="o">=</span><span class="s2">&quot;Basic PPO Network&quot;</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>Track generation: 1143..1442 -&gt; 299-tiles track
Logging to RL_Training/Logs/Basic PPO Network_14
</pre>
</div>
</div>

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>/usr/local/lib/python3.7/dist-packages/stable_baselines3/common/callbacks.py:345: UserWarning: Training and eval env are not of the same type&lt;stable_baselines3.common.vec_env.vec_transpose.VecTransposeImage object at 0x7f173e213b90&gt; != &lt;stable_baselines3.common.vec_env.vec_frame_stack.VecFrameStack object at 0x7f17cbf43190&gt;
  warnings.warn(&quot;Training and eval env are not of the same type&quot; f&quot;{self.training_env} != {self.eval_env}&quot;)
</pre>
</div>
</div>

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>----------------------------
| time/              |     |
|    fps             | 94  |
|    iterations      | 1   |
|    time_elapsed    | 5   |
|    total_timesteps | 512 |
----------------------------
Track generation: 1087..1369 -&gt; 282-tiles track
---------------------------------------
| rollout/                |           |
|    ep_len_mean          | 1e+03     |
|    ep_rew_mean          | -43       |
| time/                   |           |
|    fps                  | 33        |
|    iterations           | 2         |
|    time_elapsed         | 30        |
|    total_timesteps      | 1024      |
| train/                  |           |
|    approx_kl            | 2.5118575 |
|    clip_fraction        | 0.55      |
|    clip_range           | 0.4       |
|    entropy_loss         | 3.52      |
|    explained_variance   | 0.000121  |
|    learning_rate        | 3e-05     |
|    loss                 | 0.505     |
|    n_updates            | 20        |
|    policy_gradient_loss | 0.0551    |
|    std                  | 0.135     |
|    value_loss           | 0.811     |
---------------------------------------
---------------------------------------
| rollout/                |           |
|    ep_len_mean          | 1e+03     |
|    ep_rew_mean          | -43       |
| time/                   |           |
|    fps                  | 27        |
|    iterations           | 3         |
|    time_elapsed         | 55        |
|    total_timesteps      | 1536      |
| train/                  |           |
|    approx_kl            | 2.0092897 |
|    clip_fraction        | 0.866     |
|    clip_range           | 0.4       |
|    entropy_loss         | -1.75     |
|    explained_variance   | 0.0105    |
|    learning_rate        | 3e-05     |
|    loss                 | 0.412     |
|    n_updates            | 40        |
|    policy_gradient_loss | 0.114     |
|    std                  | 0.135     |
|    value_loss           | 0.812     |
---------------------------------------
Track generation: 964..1212 -&gt; 248-tiles track
retry to generate track (normal if there are not manyinstances of this message)
Track generation: 1176..1474 -&gt; 298-tiles track
--------------------------------------
| rollout/                |          |
|    ep_len_mean          | 824      |
|    ep_rew_mean          | -80.6    |
| time/                   |          |
|    fps                  | 25       |
|    iterations           | 4        |
|    time_elapsed         | 81       |
|    total_timesteps      | 2048     |
| train/                  |          |
|    approx_kl            | 1.200291 |
|    clip_fraction        | 0.544    |
|    clip_range           | 0.4      |
|    entropy_loss         | -3.61    |
|    explained_variance   | 0.0971   |
|    learning_rate        | 3e-05    |
|    loss                 | 0.48     |
|    n_updates            | 60       |
|    policy_gradient_loss | -0.0272  |
|    std                  | 0.135    |
|    value_loss           | 1.31     |
--------------------------------------
---------------------------------------
| rollout/                |           |
|    ep_len_mean          | 824       |
|    ep_rew_mean          | -80.6     |
| time/                   |           |
|    fps                  | 24        |
|    iterations           | 5         |
|    time_elapsed         | 106       |
|    total_timesteps      | 2560      |
| train/                  |           |
|    approx_kl            | 5.0841465 |
|    clip_fraction        | 0.745     |
|    clip_range           | 0.4       |
|    entropy_loss         | -7.91     |
|    explained_variance   | 0.0377    |
|    learning_rate        | 3e-05     |
|    loss                 | 13.2      |
|    n_updates            | 80        |
|    policy_gradient_loss | 0.0566    |
|    std                  | 0.135     |
|    value_loss           | 76.6      |
---------------------------------------
Track generation: 1283..1608 -&gt; 325-tiles track
----------------------------------------
| rollout/                |            |
|    ep_len_mean          | 882        |
|    ep_rew_mean          | -55.7      |
| time/                   |            |
|    fps                  | 23         |
|    iterations           | 6          |
|    time_elapsed         | 130        |
|    total_timesteps      | 3072       |
| train/                  |            |
|    approx_kl            | 0.04404892 |
|    clip_fraction        | 0.106      |
|    clip_range           | 0.4        |
|    entropy_loss         | -12.4      |
|    explained_variance   | 0.816      |
|    learning_rate        | 3e-05      |
|    loss                 | 0.532      |
|    n_updates            | 100        |
|    policy_gradient_loss | -0.00603   |
|    std                  | 0.135      |
|    value_loss           | 1.05       |
----------------------------------------
---------------------------------------
| rollout/                |           |
|    ep_len_mean          | 882       |
|    ep_rew_mean          | -55.7     |
| time/                   |           |
|    fps                  | 23        |
|    iterations           | 7         |
|    time_elapsed         | 155       |
|    total_timesteps      | 3584      |
| train/                  |           |
|    approx_kl            | 0.8889822 |
|    clip_fraction        | 0.426     |
|    clip_range           | 0.4       |
|    entropy_loss         | -11.6     |
|    explained_variance   | 0.296     |
|    learning_rate        | 3e-05     |
|    loss                 | 0.623     |
|    n_updates            | 120       |
|    policy_gradient_loss | 0.00656   |
|    std                  | 0.135     |
|    value_loss           | 2.11      |
---------------------------------------
Track generation: 1217..1526 -&gt; 309-tiles track
----------------------------------------
| rollout/                |            |
|    ep_len_mean          | 912        |
|    ep_rew_mean          | -57.5      |
| time/                   |            |
|    fps                  | 22         |
|    iterations           | 8          |
|    time_elapsed         | 179        |
|    total_timesteps      | 4096       |
| train/                  |            |
|    approx_kl            | 0.09085075 |
|    clip_fraction        | 0.175      |
|    clip_range           | 0.4        |
|    entropy_loss         | -11.2      |
|    explained_variance   | 0.863      |
|    learning_rate        | 3e-05      |
|    loss                 | 0.0763     |
|    n_updates            | 140        |
|    policy_gradient_loss | -0.0314    |
|    std                  | 0.135      |
|    value_loss           | 0.317      |
----------------------------------------
----------------------------------------
| rollout/                |            |
|    ep_len_mean          | 912        |
|    ep_rew_mean          | -57.5      |
| time/                   |            |
|    fps                  | 22         |
|    iterations           | 9          |
|    time_elapsed         | 203        |
|    total_timesteps      | 4608       |
| train/                  |            |
|    approx_kl            | 0.27865124 |
|    clip_fraction        | 0.28       |
|    clip_range           | 0.4        |
|    entropy_loss         | -10.5      |
|    explained_variance   | 0.631      |
|    learning_rate        | 3e-05      |
|    loss                 | 0.212      |
|    n_updates            | 160        |
|    policy_gradient_loss | 0.0378     |
|    std                  | 0.135      |
|    value_loss           | 0.878      |
----------------------------------------
Track generation: 1096..1374 -&gt; 278-tiles track
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 929         |
|    ep_rew_mean          | -62.1       |
| time/                   |             |
|    fps                  | 22          |
|    iterations           | 10          |
|    time_elapsed         | 227         |
|    total_timesteps      | 5120        |
| train/                  |             |
|    approx_kl            | 0.020982897 |
|    clip_fraction        | 0.0439      |
|    clip_range           | 0.4         |
|    entropy_loss         | -10.5       |
|    explained_variance   | 0.522       |
|    learning_rate        | 3e-05       |
|    loss                 | 0.00937     |
|    n_updates            | 180         |
|    policy_gradient_loss | -0.0154     |
|    std                  | 0.135       |
|    value_loss           | 0.0675      |
-----------------------------------------
----------------------------------------
| rollout/                |            |
|    ep_len_mean          | 929        |
|    ep_rew_mean          | -62.1      |
| time/                   |            |
|    fps                  | 22         |
|    iterations           | 11         |
|    time_elapsed         | 252        |
|    total_timesteps      | 5632       |
| train/                  |            |
|    approx_kl            | 0.03704424 |
|    clip_fraction        | 0.173      |
|    clip_range           | 0.4        |
|    entropy_loss         | -9.78      |
|    explained_variance   | 0.738      |
|    learning_rate        | 3e-05      |
|    loss                 | 0.756      |
|    n_updates            | 200        |
|    policy_gradient_loss | -0.00896   |
|    std                  | 0.135      |
|    value_loss           | 1.38       |
----------------------------------------
Track generation: 1198..1501 -&gt; 303-tiles track
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 941         |
|    ep_rew_mean          | -61.2       |
| time/                   |             |
|    fps                  | 22          |
|    iterations           | 12          |
|    time_elapsed         | 276         |
|    total_timesteps      | 6144        |
| train/                  |             |
|    approx_kl            | 0.097705185 |
|    clip_fraction        | 0.256       |
|    clip_range           | 0.4         |
|    entropy_loss         | -10.3       |
|    explained_variance   | 0.867       |
|    learning_rate        | 3e-05       |
|    loss                 | 0.0383      |
|    n_updates            | 220         |
|    policy_gradient_loss | -0.00624    |
|    std                  | 0.135       |
|    value_loss           | 0.418       |
-----------------------------------------
Track generation: 1159..1453 -&gt; 294-tiles track
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 950         |
|    ep_rew_mean          | -60.6       |
| time/                   |             |
|    fps                  | 22          |
|    iterations           | 13          |
|    time_elapsed         | 301         |
|    total_timesteps      | 6656        |
| train/                  |             |
|    approx_kl            | 0.037860397 |
|    clip_fraction        | 0.144       |
|    clip_range           | 0.4         |
|    entropy_loss         | -9.84       |
|    explained_variance   | 0.658       |
|    learning_rate        | 3e-05       |
|    loss                 | 0.615       |
|    n_updates            | 240         |
|    policy_gradient_loss | -0.0549     |
|    std                  | 0.135       |
|    value_loss           | 1.84        |
-----------------------------------------
----------------------------------------
| rollout/                |            |
|    ep_len_mean          | 950        |
|    ep_rew_mean          | -60.6      |
| time/                   |            |
|    fps                  | 21         |
|    iterations           | 14         |
|    time_elapsed         | 326        |
|    total_timesteps      | 7168       |
| train/                  |            |
|    approx_kl            | 0.10441269 |
|    clip_fraction        | 0.274      |
|    clip_range           | 0.4        |
|    entropy_loss         | -9.8       |
|    explained_variance   | 0.64       |
|    learning_rate        | 3e-05      |
|    loss                 | 0.211      |
|    n_updates            | 260        |
|    policy_gradient_loss | -0.059     |
|    std                  | 0.135      |
|    value_loss           | 0.874      |
----------------------------------------
Track generation: 957..1205 -&gt; 248-tiles track
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 956         |
|    ep_rew_mean          | -59.1       |
| time/                   |             |
|    fps                  | 21          |
|    iterations           | 15          |
|    time_elapsed         | 351         |
|    total_timesteps      | 7680        |
| train/                  |             |
|    approx_kl            | 0.058707025 |
|    clip_fraction        | 0.111       |
|    clip_range           | 0.4         |
|    entropy_loss         | -9.72       |
|    explained_variance   | 0.437       |
|    learning_rate        | 3e-05       |
|    loss                 | 1.04        |
|    n_updates            | 280         |
|    policy_gradient_loss | -0.0224     |
|    std                  | 0.135       |
|    value_loss           | 2.25        |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 956         |
|    ep_rew_mean          | -59.1       |
| time/                   |             |
|    fps                  | 21          |
|    iterations           | 16          |
|    time_elapsed         | 376         |
|    total_timesteps      | 8192        |
| train/                  |             |
|    approx_kl            | 0.040174115 |
|    clip_fraction        | 0.0357      |
|    clip_range           | 0.4         |
|    entropy_loss         | -10.2       |
|    explained_variance   | 0.712       |
|    learning_rate        | 3e-05       |
|    loss                 | 0.0411      |
|    n_updates            | 300         |
|    policy_gradient_loss | -0.0124     |
|    std                  | 0.135       |
|    value_loss           | 0.291       |
-----------------------------------------
Track generation: 1181..1480 -&gt; 299-tiles track
----------------------------------------
| rollout/                |            |
|    ep_len_mean          | 961        |
|    ep_rew_mean          | -56.5      |
| time/                   |            |
|    fps                  | 21         |
|    iterations           | 17         |
|    time_elapsed         | 403        |
|    total_timesteps      | 8704       |
| train/                  |            |
|    approx_kl            | 0.08851342 |
|    clip_fraction        | 0.227      |
|    clip_range           | 0.4        |
|    entropy_loss         | -10.1      |
|    explained_variance   | 0.704      |
|    learning_rate        | 3e-05      |
|    loss                 | 1.12       |
|    n_updates            | 320        |
|    policy_gradient_loss | -0.0332    |
|    std                  | 0.135      |
|    value_loss           | 3          |
----------------------------------------
----------------------------------------
| rollout/                |            |
|    ep_len_mean          | 961        |
|    ep_rew_mean          | -56.5      |
| time/                   |            |
|    fps                  | 21         |
|    iterations           | 18         |
|    time_elapsed         | 432        |
|    total_timesteps      | 9216       |
| train/                  |            |
|    approx_kl            | 0.02444375 |
|    clip_fraction        | 0.03       |
|    clip_range           | 0.4        |
|    entropy_loss         | -10.5      |
|    explained_variance   | 0.852      |
|    learning_rate        | 3e-05      |
|    loss                 | 0.119      |
|    n_updates            | 340        |
|    policy_gradient_loss | -0.0159    |
|    std                  | 0.135      |
|    value_loss           | 0.393      |
----------------------------------------
Track generation: 979..1234 -&gt; 255-tiles track
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 965         |
|    ep_rew_mean          | -56.1       |
| time/                   |             |
|    fps                  | 21          |
|    iterations           | 19          |
|    time_elapsed         | 462         |
|    total_timesteps      | 9728        |
| train/                  |             |
|    approx_kl            | 0.051936105 |
|    clip_fraction        | 0.175       |
|    clip_range           | 0.4         |
|    entropy_loss         | -10.2       |
|    explained_variance   | 0.283       |
|    learning_rate        | 3e-05       |
|    loss                 | 0.502       |
|    n_updates            | 360         |
|    policy_gradient_loss | -0.0391     |
|    std                  | 0.135       |
|    value_loss           | 1.31        |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 965         |
|    ep_rew_mean          | -56.1       |
| time/                   |             |
|    fps                  | 20          |
|    iterations           | 20          |
|    time_elapsed         | 490         |
|    total_timesteps      | 10240       |
| train/                  |             |
|    approx_kl            | 0.041499622 |
|    clip_fraction        | 0.0814      |
|    clip_range           | 0.4         |
|    entropy_loss         | -10.3       |
|    explained_variance   | 0.764       |
|    learning_rate        | 3e-05       |
|    loss                 | 0.183       |
|    n_updates            | 380         |
|    policy_gradient_loss | -0.0289     |
|    std                  | 0.135       |
|    value_loss           | 0.788       |
-----------------------------------------
Track generation: 1320..1654 -&gt; 334-tiles track
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 968         |
|    ep_rew_mean          | -52.9       |
| time/                   |             |
|    fps                  | 20          |
|    iterations           | 21          |
|    time_elapsed         | 515         |
|    total_timesteps      | 10752       |
| train/                  |             |
|    approx_kl            | 0.047315955 |
|    clip_fraction        | 0.0308      |
|    clip_range           | 0.4         |
|    entropy_loss         | -10.5       |
|    explained_variance   | 0.677       |
|    learning_rate        | 3e-05       |
|    loss                 | 0.597       |
|    n_updates            | 400         |
|    policy_gradient_loss | -0.0321     |
|    std                  | 0.135       |
|    value_loss           | 1.79        |
-----------------------------------------
--------------------------------------
| rollout/                |          |
|    ep_len_mean          | 968      |
|    ep_rew_mean          | -52.9    |
| time/                   |          |
|    fps                  | 20       |
|    iterations           | 22       |
|    time_elapsed         | 540      |
|    total_timesteps      | 11264    |
| train/                  |          |
|    approx_kl            | 0.066702 |
|    clip_fraction        | 0.242    |
|    clip_range           | 0.4      |
|    entropy_loss         | -10.3    |
|    explained_variance   | 0.853    |
|    learning_rate        | 3e-05    |
|    loss                 | 0.218    |
|    n_updates            | 420      |
|    policy_gradient_loss | -0.0466  |
|    std                  | 0.135    |
|    value_loss           | 0.947    |
--------------------------------------
Track generation: 1067..1338 -&gt; 271-tiles track
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 971         |
|    ep_rew_mean          | -51.9       |
| time/                   |             |
|    fps                  | 20          |
|    iterations           | 23          |
|    time_elapsed         | 566         |
|    total_timesteps      | 11776       |
| train/                  |             |
|    approx_kl            | 0.053936265 |
|    clip_fraction        | 0.135       |
|    clip_range           | 0.4         |
|    entropy_loss         | -10.2       |
|    explained_variance   | 0.468       |
|    learning_rate        | 3e-05       |
|    loss                 | 1.21        |
|    n_updates            | 440         |
|    policy_gradient_loss | -0.0273     |
|    std                  | 0.135       |
|    value_loss           | 2.83        |
-----------------------------------------
Track generation: 1067..1338 -&gt; 271-tiles track
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 939         |
|    ep_rew_mean          | -56.4       |
| time/                   |             |
|    fps                  | 20          |
|    iterations           | 24          |
|    time_elapsed         | 590         |
|    total_timesteps      | 12288       |
| train/                  |             |
|    approx_kl            | 0.038094915 |
|    clip_fraction        | 0.0987      |
|    clip_range           | 0.4         |
|    entropy_loss         | -10.7       |
|    explained_variance   | 0.815       |
|    learning_rate        | 3e-05       |
|    loss                 | 0.215       |
|    n_updates            | 460         |
|    policy_gradient_loss | -0.0254     |
|    std                  | 0.135       |
|    value_loss           | 0.671       |
-----------------------------------------
---------------------------------------
| rollout/                |           |
|    ep_len_mean          | 939       |
|    ep_rew_mean          | -56.4     |
| time/                   |           |
|    fps                  | 20        |
|    iterations           | 25        |
|    time_elapsed         | 615       |
|    total_timesteps      | 12800     |
| train/                  |           |
|    approx_kl            | 2.3204362 |
|    clip_fraction        | 0.656     |
|    clip_range           | 0.4       |
|    entropy_loss         | -12.3     |
|    explained_variance   | -0.0647   |
|    learning_rate        | 3e-05     |
|    loss                 | 13.3      |
|    n_updates            | 480       |
|    policy_gradient_loss | 0.0411    |
|    std                  | 0.135     |
|    value_loss           | 60.6      |
---------------------------------------
Track generation: 1207..1513 -&gt; 306-tiles track
----------------------------------------
| rollout/                |            |
|    ep_len_mean          | 943        |
|    ep_rew_mean          | -54        |
| time/                   |            |
|    fps                  | 20         |
|    iterations           | 26         |
|    time_elapsed         | 640        |
|    total_timesteps      | 13312      |
| train/                  |            |
|    approx_kl            | 0.05655171 |
|    clip_fraction        | 0.0947     |
|    clip_range           | 0.4        |
|    entropy_loss         | -14.2      |
|    explained_variance   | 0.732      |
|    learning_rate        | 3e-05      |
|    loss                 | 1.65       |
|    n_updates            | 500        |
|    policy_gradient_loss | -0.0316    |
|    std                  | 0.135      |
|    value_loss           | 2.77       |
----------------------------------------
----------------------------------------
| rollout/                |            |
|    ep_len_mean          | 943        |
|    ep_rew_mean          | -54        |
| time/                   |            |
|    fps                  | 20         |
|    iterations           | 27         |
|    time_elapsed         | 665        |
|    total_timesteps      | 13824      |
| train/                  |            |
|    approx_kl            | 0.02538926 |
|    clip_fraction        | 0.07       |
|    clip_range           | 0.4        |
|    entropy_loss         | -14.3      |
|    explained_variance   | 0.931      |
|    learning_rate        | 3e-05      |
|    loss                 | 0.254      |
|    n_updates            | 520        |
|    policy_gradient_loss | -0.0114    |
|    std                  | 0.135      |
|    value_loss           | 0.627      |
----------------------------------------
Track generation: 1106..1396 -&gt; 290-tiles track
----------------------------------------
| rollout/                |            |
|    ep_len_mean          | 947        |
|    ep_rew_mean          | -51.4      |
| time/                   |            |
|    fps                  | 20         |
|    iterations           | 28         |
|    time_elapsed         | 690        |
|    total_timesteps      | 14336      |
| train/                  |            |
|    approx_kl            | 0.07026696 |
|    clip_fraction        | 0.0532     |
|    clip_range           | 0.4        |
|    entropy_loss         | -14.3      |
|    explained_variance   | 0.902      |
|    learning_rate        | 3e-05      |
|    loss                 | 0.854      |
|    n_updates            | 540        |
|    policy_gradient_loss | -0.00384   |
|    std                  | 0.135      |
|    value_loss           | 2.09       |
----------------------------------------
----------------------------------------
| rollout/                |            |
|    ep_len_mean          | 947        |
|    ep_rew_mean          | -51.4      |
| time/                   |            |
|    fps                  | 20         |
|    iterations           | 29         |
|    time_elapsed         | 715        |
|    total_timesteps      | 14848      |
| train/                  |            |
|    approx_kl            | 0.05772079 |
|    clip_fraction        | 0.07       |
|    clip_range           | 0.4        |
|    entropy_loss         | -14.2      |
|    explained_variance   | 0.795      |
|    learning_rate        | 3e-05      |
|    loss                 | 0.446      |
|    n_updates            | 560        |
|    policy_gradient_loss | -0.0179    |
|    std                  | 0.135      |
|    value_loss           | 1.95       |
----------------------------------------
Track generation: 1296..1628 -&gt; 332-tiles track
retry to generate track (normal if there are not manyinstances of this message)
Track generation: 1047..1319 -&gt; 272-tiles track
----------------------------------------
| rollout/                |            |
|    ep_len_mean          | 950        |
|    ep_rew_mean          | -52        |
| time/                   |            |
|    fps                  | 20         |
|    iterations           | 30         |
|    time_elapsed         | 740        |
|    total_timesteps      | 15360      |
| train/                  |            |
|    approx_kl            | 0.04257883 |
|    clip_fraction        | 0.0436     |
|    clip_range           | 0.4        |
|    entropy_loss         | -14.4      |
|    explained_variance   | 0.558      |
|    learning_rate        | 3e-05      |
|    loss                 | 0.872      |
|    n_updates            | 580        |
|    policy_gradient_loss | -0.0162    |
|    std                  | 0.135      |
|    value_loss           | 2.69       |
----------------------------------------
----------------------------------------
| rollout/                |            |
|    ep_len_mean          | 950        |
|    ep_rew_mean          | -52        |
| time/                   |            |
|    fps                  | 20         |
|    iterations           | 31         |
|    time_elapsed         | 765        |
|    total_timesteps      | 15872      |
| train/                  |            |
|    approx_kl            | 0.08533536 |
|    clip_fraction        | 0.185      |
|    clip_range           | 0.4        |
|    entropy_loss         | -14.2      |
|    explained_variance   | 0.793      |
|    learning_rate        | 3e-05      |
|    loss                 | 0.289      |
|    n_updates            | 600        |
|    policy_gradient_loss | -0.0104    |
|    std                  | 0.135      |
|    value_loss           | 1.01       |
----------------------------------------
Track generation: 1245..1560 -&gt; 315-tiles track
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 953         |
|    ep_rew_mean          | -52.5       |
| time/                   |             |
|    fps                  | 20          |
|    iterations           | 32          |
|    time_elapsed         | 790         |
|    total_timesteps      | 16384       |
| train/                  |             |
|    approx_kl            | 0.063721284 |
|    clip_fraction        | 0.064       |
|    clip_range           | 0.4         |
|    entropy_loss         | -14.1       |
|    explained_variance   | 0.55        |
|    learning_rate        | 3e-05       |
|    loss                 | 0.755       |
|    n_updates            | 620         |
|    policy_gradient_loss | -0.0289     |
|    std                  | 0.135       |
|    value_loss           | 1.88        |
-----------------------------------------
----------------------------------------
| rollout/                |            |
|    ep_len_mean          | 953        |
|    ep_rew_mean          | -52.5      |
| time/                   |            |
|    fps                  | 20         |
|    iterations           | 33         |
|    time_elapsed         | 815        |
|    total_timesteps      | 16896      |
| train/                  |            |
|    approx_kl            | 0.06901169 |
|    clip_fraction        | 0.0891     |
|    clip_range           | 0.4        |
|    entropy_loss         | -14        |
|    explained_variance   | 0.502      |
|    learning_rate        | 3e-05      |
|    loss                 | 0.364      |
|    n_updates            | 640        |
|    policy_gradient_loss | -0.0092    |
|    std                  | 0.135      |
|    value_loss           | 0.604      |
----------------------------------------
Track generation: 1232..1544 -&gt; 312-tiles track
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 956         |
|    ep_rew_mean          | -53         |
| time/                   |             |
|    fps                  | 20          |
|    iterations           | 34          |
|    time_elapsed         | 840         |
|    total_timesteps      | 17408       |
| train/                  |             |
|    approx_kl            | 0.046034496 |
|    clip_fraction        | 0.122       |
|    clip_range           | 0.4         |
|    entropy_loss         | -13.9       |
|    explained_variance   | 0.404       |
|    learning_rate        | 3e-05       |
|    loss                 | 0.147       |
|    n_updates            | 660         |
|    policy_gradient_loss | -0.0249     |
|    std                  | 0.135       |
|    value_loss           | 0.466       |
-----------------------------------------
----------------------------------------
| rollout/                |            |
|    ep_len_mean          | 956        |
|    ep_rew_mean          | -53        |
| time/                   |            |
|    fps                  | 20         |
|    iterations           | 35         |
|    time_elapsed         | 864        |
|    total_timesteps      | 17920      |
| train/                  |            |
|    approx_kl            | 0.01429884 |
|    clip_fraction        | 0.00635    |
|    clip_range           | 0.4        |
|    entropy_loss         | -13.8      |
|    explained_variance   | 0.603      |
|    learning_rate        | 3e-05      |
|    loss                 | 0.368      |
|    n_updates            | 680        |
|    policy_gradient_loss | -0.00455   |
|    std                  | 0.135      |
|    value_loss           | 1.11       |
----------------------------------------
Track generation: 1120..1408 -&gt; 288-tiles track
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 958         |
|    ep_rew_mean          | -53.4       |
| time/                   |             |
|    fps                  | 20          |
|    iterations           | 36          |
|    time_elapsed         | 889         |
|    total_timesteps      | 18432       |
| train/                  |             |
|    approx_kl            | 0.023805892 |
|    clip_fraction        | 0.114       |
|    clip_range           | 0.4         |
|    entropy_loss         | -14         |
|    explained_variance   | 0.52        |
|    learning_rate        | 3e-05       |
|    loss                 | 0.283       |
|    n_updates            | 700         |
|    policy_gradient_loss | -0.0099     |
|    std                  | 0.135       |
|    value_loss           | 0.767       |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 958         |
|    ep_rew_mean          | -53.4       |
| time/                   |             |
|    fps                  | 20          |
|    iterations           | 37          |
|    time_elapsed         | 913         |
|    total_timesteps      | 18944       |
| train/                  |             |
|    approx_kl            | 0.039946392 |
|    clip_fraction        | 0.0479      |
|    clip_range           | 0.4         |
|    entropy_loss         | -14         |
|    explained_variance   | 0.885       |
|    learning_rate        | 3e-05       |
|    loss                 | 0.0627      |
|    n_updates            | 720         |
|    policy_gradient_loss | -0.0186     |
|    std                  | 0.135       |
|    value_loss           | 0.497       |
-----------------------------------------
Track generation: 1225..1536 -&gt; 311-tiles track
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 960         |
|    ep_rew_mean          | -54.5       |
| time/                   |             |
|    fps                  | 20          |
|    iterations           | 38          |
|    time_elapsed         | 938         |
|    total_timesteps      | 19456       |
| train/                  |             |
|    approx_kl            | 0.034411184 |
|    clip_fraction        | 0.0214      |
|    clip_range           | 0.4         |
|    entropy_loss         | -14.2       |
|    explained_variance   | 0.912       |
|    learning_rate        | 3e-05       |
|    loss                 | 0.1         |
|    n_updates            | 740         |
|    policy_gradient_loss | -0.00621    |
|    std                  | 0.135       |
|    value_loss           | 0.257       |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 960         |
|    ep_rew_mean          | -54.5       |
| time/                   |             |
|    fps                  | 20          |
|    iterations           | 39          |
|    time_elapsed         | 962         |
|    total_timesteps      | 19968       |
| train/                  |             |
|    approx_kl            | 0.085018665 |
|    clip_fraction        | 0.156       |
|    clip_range           | 0.4         |
|    entropy_loss         | -14.2       |
|    explained_variance   | 0.828       |
|    learning_rate        | 3e-05       |
|    loss                 | 0.184       |
|    n_updates            | 760         |
|    policy_gradient_loss | -0.0513     |
|    std                  | 0.135       |
|    value_loss           | 0.701       |
-----------------------------------------
Track generation: 1077..1357 -&gt; 280-tiles track
----------------------------------------
| rollout/                |            |
|    ep_len_mean          | 962        |
|    ep_rew_mean          | -51.2      |
| time/                   |            |
|    fps                  | 20         |
|    iterations           | 40         |
|    time_elapsed         | 987        |
|    total_timesteps      | 20480      |
| train/                  |            |
|    approx_kl            | 0.04333676 |
|    clip_fraction        | 0.0615     |
|    clip_range           | 0.4        |
|    entropy_loss         | -14.1      |
|    explained_variance   | 0.743      |
|    learning_rate        | 3e-05      |
|    loss                 | 0.745      |
|    n_updates            | 780        |
|    policy_gradient_loss | -0.0278    |
|    std                  | 0.135      |
|    value_loss           | 1.64       |
----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 962         |
|    ep_rew_mean          | -51.2       |
| time/                   |             |
|    fps                  | 20          |
|    iterations           | 41          |
|    time_elapsed         | 1011        |
|    total_timesteps      | 20992       |
| train/                  |             |
|    approx_kl            | 0.007929383 |
|    clip_fraction        | 0.00801     |
|    clip_range           | 0.4         |
|    entropy_loss         | -13.9       |
|    explained_variance   | 0.756       |
|    learning_rate        | 3e-05       |
|    loss                 | 0.85        |
|    n_updates            | 800         |
|    policy_gradient_loss | 0.00157     |
|    std                  | 0.135       |
|    value_loss           | 1.74        |
-----------------------------------------
Track generation: 1322..1664 -&gt; 342-tiles track
----------------------------------------
| rollout/                |            |
|    ep_len_mean          | 964        |
|    ep_rew_mean          | -46.9      |
| time/                   |            |
|    fps                  | 20         |
|    iterations           | 42         |
|    time_elapsed         | 1036       |
|    total_timesteps      | 21504      |
| train/                  |            |
|    approx_kl            | 0.06739192 |
|    clip_fraction        | 0.052      |
|    clip_range           | 0.4        |
|    entropy_loss         | -13.8      |
|    explained_variance   | 0.769      |
|    learning_rate        | 3e-05      |
|    loss                 | 1.27       |
|    n_updates            | 820        |
|    policy_gradient_loss | -0.016     |
|    std                  | 0.135      |
|    value_loss           | 3.14       |
----------------------------------------
Track generation: 1035..1297 -&gt; 262-tiles track
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 956         |
|    ep_rew_mean          | -51         |
| time/                   |             |
|    fps                  | 20          |
|    iterations           | 43          |
|    time_elapsed         | 1060        |
|    total_timesteps      | 22016       |
| train/                  |             |
|    approx_kl            | 0.018731486 |
|    clip_fraction        | 0.0126      |
|    clip_range           | 0.4         |
|    entropy_loss         | -13.6       |
|    explained_variance   | 0.645       |
|    learning_rate        | 3e-05       |
|    loss                 | 1.77        |
|    n_updates            | 840         |
|    policy_gradient_loss | -0.014      |
|    std                  | 0.135       |
|    value_loss           | 4.25        |
-----------------------------------------
---------------------------------------
| rollout/                |           |
|    ep_len_mean          | 956       |
|    ep_rew_mean          | -51       |
| time/                   |           |
|    fps                  | 20        |
|    iterations           | 44        |
|    time_elapsed         | 1085      |
|    total_timesteps      | 22528     |
| train/                  |           |
|    approx_kl            | 1.1688795 |
|    clip_fraction        | 0.676     |
|    clip_range           | 0.4       |
|    entropy_loss         | -14.9     |
|    explained_variance   | 0.151     |
|    learning_rate        | 3e-05     |
|    loss                 | 8.96      |
|    n_updates            | 860       |
|    policy_gradient_loss | 0.0414    |
|    std                  | 0.135     |
|    value_loss           | 33.8      |
---------------------------------------
Track generation: 1297..1626 -&gt; 329-tiles track
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 958         |
|    ep_rew_mean          | -51.5       |
| time/                   |             |
|    fps                  | 20          |
|    iterations           | 45          |
|    time_elapsed         | 1110        |
|    total_timesteps      | 23040       |
| train/                  |             |
|    approx_kl            | 0.022745889 |
|    clip_fraction        | 0.00957     |
|    clip_range           | 0.4         |
|    entropy_loss         | -15.9       |
|    explained_variance   | 0.914       |
|    learning_rate        | 3e-05       |
|    loss                 | 0.647       |
|    n_updates            | 880         |
|    policy_gradient_loss | -0.0193     |
|    std                  | 0.135       |
|    value_loss           | 1.13        |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 958         |
|    ep_rew_mean          | -51.5       |
| time/                   |             |
|    fps                  | 20          |
|    iterations           | 46          |
|    time_elapsed         | 1135        |
|    total_timesteps      | 23552       |
| train/                  |             |
|    approx_kl            | 0.028504364 |
|    clip_fraction        | 0.0113      |
|    clip_range           | 0.4         |
|    entropy_loss         | -15.8       |
|    explained_variance   | 0.909       |
|    learning_rate        | 3e-05       |
|    loss                 | 0.629       |
|    n_updates            | 900         |
|    policy_gradient_loss | -0.0132     |
|    std                  | 0.135       |
|    value_loss           | 1           |
-----------------------------------------
Track generation: 1294..1621 -&gt; 327-tiles track
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 959         |
|    ep_rew_mean          | -51         |
| time/                   |             |
|    fps                  | 20          |
|    iterations           | 47          |
|    time_elapsed         | 1159        |
|    total_timesteps      | 24064       |
| train/                  |             |
|    approx_kl            | 0.090363756 |
|    clip_fraction        | 0.116       |
|    clip_range           | 0.4         |
|    entropy_loss         | -15.5       |
|    explained_variance   | 0.745       |
|    learning_rate        | 3e-05       |
|    loss                 | 1.51        |
|    n_updates            | 920         |
|    policy_gradient_loss | -0.0398     |
|    std                  | 0.135       |
|    value_loss           | 3.46        |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 959         |
|    ep_rew_mean          | -51         |
| time/                   |             |
|    fps                  | 20          |
|    iterations           | 48          |
|    time_elapsed         | 1184        |
|    total_timesteps      | 24576       |
| train/                  |             |
|    approx_kl            | 0.021829683 |
|    clip_fraction        | 0.00859     |
|    clip_range           | 0.4         |
|    entropy_loss         | -15.3       |
|    explained_variance   | 0.971       |
|    learning_rate        | 3e-05       |
|    loss                 | 0.0609      |
|    n_updates            | 940         |
|    policy_gradient_loss | -0.00618    |
|    std                  | 0.135       |
|    value_loss           | 0.437       |
-----------------------------------------
Track generation: 1055..1331 -&gt; 276-tiles track
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 961         |
|    ep_rew_mean          | -51.5       |
| time/                   |             |
|    fps                  | 20          |
|    iterations           | 49          |
|    time_elapsed         | 1210        |
|    total_timesteps      | 25088       |
| train/                  |             |
|    approx_kl            | 0.025407098 |
|    clip_fraction        | 0.0173      |
|    clip_range           | 0.4         |
|    entropy_loss         | -15.2       |
|    explained_variance   | 0.874       |
|    learning_rate        | 3e-05       |
|    loss                 | 0.349       |
|    n_updates            | 960         |
|    policy_gradient_loss | -0.0179     |
|    std                  | 0.135       |
|    value_loss           | 0.919       |
-----------------------------------------
----------------------------------------
| rollout/                |            |
|    ep_len_mean          | 961        |
|    ep_rew_mean          | -51.5      |
| time/                   |            |
|    fps                  | 20         |
|    iterations           | 50         |
|    time_elapsed         | 1235       |
|    total_timesteps      | 25600      |
| train/                  |            |
|    approx_kl            | 0.03209848 |
|    clip_fraction        | 0.0222     |
|    clip_range           | 0.4        |
|    entropy_loss         | -15        |
|    explained_variance   | 0.799      |
|    learning_rate        | 3e-05      |
|    loss                 | 1.71       |
|    n_updates            | 980        |
|    policy_gradient_loss | 0.0025     |
|    std                  | 0.135      |
|    value_loss           | 2.53       |
----------------------------------------
Track generation: 1202..1507 -&gt; 305-tiles track
----------------------------------------
| rollout/                |            |
|    ep_len_mean          | 962        |
|    ep_rew_mean          | -51.4      |
| time/                   |            |
|    fps                  | 20         |
|    iterations           | 51         |
|    time_elapsed         | 1259       |
|    total_timesteps      | 26112      |
| train/                  |            |
|    approx_kl            | 0.05562091 |
|    clip_fraction        | 0.0503     |
|    clip_range           | 0.4        |
|    entropy_loss         | -14.9      |
|    explained_variance   | 0.888      |
|    learning_rate        | 3e-05      |
|    loss                 | 0.223      |
|    n_updates            | 1000       |
|    policy_gradient_loss | -0.0211    |
|    std                  | 0.135      |
|    value_loss           | 0.55       |
----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 962         |
|    ep_rew_mean          | -51.4       |
| time/                   |             |
|    fps                  | 20          |
|    iterations           | 52          |
|    time_elapsed         | 1284        |
|    total_timesteps      | 26624       |
| train/                  |             |
|    approx_kl            | 0.035023876 |
|    clip_fraction        | 0.0157      |
|    clip_range           | 0.4         |
|    entropy_loss         | -14.7       |
|    explained_variance   | 0.633       |
|    learning_rate        | 3e-05       |
|    loss                 | 0.819       |
|    n_updates            | 1020        |
|    policy_gradient_loss | -0.0152     |
|    std                  | 0.135       |
|    value_loss           | 1.49        |
-----------------------------------------
Track generation: 863..1087 -&gt; 224-tiles track
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 964         |
|    ep_rew_mean          | -50.8       |
| time/                   |             |
|    fps                  | 20          |
|    iterations           | 53          |
|    time_elapsed         | 1309        |
|    total_timesteps      | 27136       |
| train/                  |             |
|    approx_kl            | 0.040470794 |
|    clip_fraction        | 0.0531      |
|    clip_range           | 0.4         |
|    entropy_loss         | -14.6       |
|    explained_variance   | 0.585       |
|    learning_rate        | 3e-05       |
|    loss                 | 0.819       |
|    n_updates            | 1040        |
|    policy_gradient_loss | 0.00249     |
|    std                  | 0.135       |
|    value_loss           | 1.54        |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 964         |
|    ep_rew_mean          | -50.8       |
| time/                   |             |
|    fps                  | 20          |
|    iterations           | 54          |
|    time_elapsed         | 1333        |
|    total_timesteps      | 27648       |
| train/                  |             |
|    approx_kl            | 0.035999395 |
|    clip_fraction        | 0.0297      |
|    clip_range           | 0.4         |
|    entropy_loss         | -14.5       |
|    explained_variance   | 0.749       |
|    learning_rate        | 3e-05       |
|    loss                 | 0.689       |
|    n_updates            | 1060        |
|    policy_gradient_loss | -0.0142     |
|    std                  | 0.135       |
|    value_loss           | 1.7         |
-----------------------------------------
Track generation: 1227..1538 -&gt; 311-tiles track
----------------------------------------
| rollout/                |            |
|    ep_len_mean          | 965        |
|    ep_rew_mean          | -46.7      |
| time/                   |            |
|    fps                  | 20         |
|    iterations           | 55         |
|    time_elapsed         | 1358       |
|    total_timesteps      | 28160      |
| train/                  |            |
|    approx_kl            | 0.04484225 |
|    clip_fraction        | 0.0286     |
|    clip_range           | 0.4        |
|    entropy_loss         | -14.3      |
|    explained_variance   | 0.6        |
|    learning_rate        | 3e-05      |
|    loss                 | 3.38       |
|    n_updates            | 1080       |
|    policy_gradient_loss | -0.0158    |
|    std                  | 0.135      |
|    value_loss           | 8.44       |
----------------------------------------
----------------------------------------
| rollout/                |            |
|    ep_len_mean          | 965        |
|    ep_rew_mean          | -46.7      |
| time/                   |            |
|    fps                  | 20         |
|    iterations           | 56         |
|    time_elapsed         | 1382       |
|    total_timesteps      | 28672      |
| train/                  |            |
|    approx_kl            | 0.32711703 |
|    clip_fraction        | 0.378      |
|    clip_range           | 0.4        |
|    entropy_loss         | -13.7      |
|    explained_variance   | 0.743      |
|    learning_rate        | 3e-05      |
|    loss                 | 0.784      |
|    n_updates            | 1100       |
|    policy_gradient_loss | 0.0465     |
|    std                  | 0.135      |
|    value_loss           | 2.13       |
----------------------------------------
Track generation: 1317..1652 -&gt; 335-tiles track
----------------------------------------
| rollout/                |            |
|    ep_len_mean          | 961        |
|    ep_rew_mean          | -50.1      |
| time/                   |            |
|    fps                  | 20         |
|    iterations           | 57         |
|    time_elapsed         | 1407       |
|    total_timesteps      | 29184      |
| train/                  |            |
|    approx_kl            | 0.14900674 |
|    clip_fraction        | 0.275      |
|    clip_range           | 0.4        |
|    entropy_loss         | -13.1      |
|    explained_variance   | 0.729      |
|    learning_rate        | 3e-05      |
|    loss                 | 0.322      |
|    n_updates            | 1120       |
|    policy_gradient_loss | 0.0318     |
|    std                  | 0.135      |
|    value_loss           | 1.05       |
----------------------------------------
---------------------------------------
| rollout/                |           |
|    ep_len_mean          | 961       |
|    ep_rew_mean          | -50.1     |
| time/                   |           |
|    fps                  | 20        |
|    iterations           | 58        |
|    time_elapsed         | 1432      |
|    total_timesteps      | 29696     |
| train/                  |           |
|    approx_kl            | 1.1665962 |
|    clip_fraction        | 0.765     |
|    clip_range           | 0.4       |
|    entropy_loss         | -14.6     |
|    explained_variance   | 0.583     |
|    learning_rate        | 3e-05     |
|    loss                 | 5.87      |
|    n_updates            | 1140      |
|    policy_gradient_loss | 0.0682    |
|    std                  | 0.135     |
|    value_loss           | 24.7      |
---------------------------------------
Track generation: 1115..1402 -&gt; 287-tiles track
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 962         |
|    ep_rew_mean          | -48.4       |
| time/                   |             |
|    fps                  | 20          |
|    iterations           | 59          |
|    time_elapsed         | 1457        |
|    total_timesteps      | 30208       |
| train/                  |             |
|    approx_kl            | 0.002344423 |
|    clip_fraction        | 0           |
|    clip_range           | 0.4         |
|    entropy_loss         | -15.4       |
|    explained_variance   | 0.645       |
|    learning_rate        | 3e-05       |
|    loss                 | 0.0576      |
|    n_updates            | 1160        |
|    policy_gradient_loss | -0.000804   |
|    std                  | 0.135       |
|    value_loss           | 0.62        |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 962         |
|    ep_rew_mean          | -48.4       |
| time/                   |             |
|    fps                  | 20          |
|    iterations           | 60          |
|    time_elapsed         | 1482        |
|    total_timesteps      | 30720       |
| train/                  |             |
|    approx_kl            | 0.022931438 |
|    clip_fraction        | 0.0169      |
|    clip_range           | 0.4         |
|    entropy_loss         | -15         |
|    explained_variance   | 0.827       |
|    learning_rate        | 3e-05       |
|    loss                 | 1.24        |
|    n_updates            | 1180        |
|    policy_gradient_loss | -0.0073     |
|    std                  | 0.135       |
|    value_loss           | 3.3         |
-----------------------------------------
Track generation: 1168..1464 -&gt; 296-tiles track
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 963         |
|    ep_rew_mean          | -48.6       |
| time/                   |             |
|    fps                  | 20          |
|    iterations           | 61          |
|    time_elapsed         | 1507        |
|    total_timesteps      | 31232       |
| train/                  |             |
|    approx_kl            | 0.057587504 |
|    clip_fraction        | 0.155       |
|    clip_range           | 0.4         |
|    entropy_loss         | -14.9       |
|    explained_variance   | -0.544      |
|    learning_rate        | 3e-05       |
|    loss                 | 0.0407      |
|    n_updates            | 1200        |
|    policy_gradient_loss | -0.0417     |
|    std                  | 0.135       |
|    value_loss           | 0.315       |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 963         |
|    ep_rew_mean          | -48.6       |
| time/                   |             |
|    fps                  | 20          |
|    iterations           | 62          |
|    time_elapsed         | 1532        |
|    total_timesteps      | 31744       |
| train/                  |             |
|    approx_kl            | 0.044703305 |
|    clip_fraction        | 0.0371      |
|    clip_range           | 0.4         |
|    entropy_loss         | -14.7       |
|    explained_variance   | 0.884       |
|    learning_rate        | 3e-05       |
|    loss                 | 1.24        |
|    n_updates            | 1220        |
|    policy_gradient_loss | 0.00214     |
|    std                  | 0.135       |
|    value_loss           | 2           |
-----------------------------------------
Track generation: 1056..1324 -&gt; 268-tiles track
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 965         |
|    ep_rew_mean          | -48.1       |
| time/                   |             |
|    fps                  | 20          |
|    iterations           | 63          |
|    time_elapsed         | 1556        |
|    total_timesteps      | 32256       |
| train/                  |             |
|    approx_kl            | 0.026113082 |
|    clip_fraction        | 0.0757      |
|    clip_range           | 0.4         |
|    entropy_loss         | -14.8       |
|    explained_variance   | 0.604       |
|    learning_rate        | 3e-05       |
|    loss                 | 1.17        |
|    n_updates            | 1240        |
|    policy_gradient_loss | -0.0299     |
|    std                  | 0.135       |
|    value_loss           | 2.22        |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 965         |
|    ep_rew_mean          | -48.1       |
| time/                   |             |
|    fps                  | 20          |
|    iterations           | 64          |
|    time_elapsed         | 1581        |
|    total_timesteps      | 32768       |
| train/                  |             |
|    approx_kl            | 0.012264116 |
|    clip_fraction        | 0           |
|    clip_range           | 0.4         |
|    entropy_loss         | -14.8       |
|    explained_variance   | 0.947       |
|    learning_rate        | 3e-05       |
|    loss                 | 0.337       |
|    n_updates            | 1260        |
|    policy_gradient_loss | -0.00995    |
|    std                  | 0.135       |
|    value_loss           | 0.712       |
-----------------------------------------
Track generation: 1204..1509 -&gt; 305-tiles track
----------------------------------------
| rollout/                |            |
|    ep_len_mean          | 966        |
|    ep_rew_mean          | -48.6      |
| time/                   |            |
|    fps                  | 20         |
|    iterations           | 65         |
|    time_elapsed         | 1605       |
|    total_timesteps      | 33280      |
| train/                  |            |
|    approx_kl            | 0.09288721 |
|    clip_fraction        | 0.14       |
|    clip_range           | 0.4        |
|    entropy_loss         | -14.6      |
|    explained_variance   | 0.835      |
|    learning_rate        | 3e-05      |
|    loss                 | 0.553      |
|    n_updates            | 1280       |
|    policy_gradient_loss | -0.0256    |
|    std                  | 0.135      |
|    value_loss           | 1.37       |
----------------------------------------
------------------------------------------
| rollout/                |              |
|    ep_len_mean          | 966          |
|    ep_rew_mean          | -48.6        |
| time/                   |              |
|    fps                  | 20           |
|    iterations           | 66           |
|    time_elapsed         | 1630         |
|    total_timesteps      | 33792        |
| train/                  |              |
|    approx_kl            | 0.0146868965 |
|    clip_fraction        | 0.00205      |
|    clip_range           | 0.4          |
|    entropy_loss         | -14.4        |
|    explained_variance   | 0.888        |
|    learning_rate        | 3e-05        |
|    loss                 | 0.814        |
|    n_updates            | 1300         |
|    policy_gradient_loss | -0.00739     |
|    std                  | 0.135        |
|    value_loss           | 1.88         |
------------------------------------------
Track generation: 1260..1579 -&gt; 319-tiles track
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 967         |
|    ep_rew_mean          | -48.1       |
| time/                   |             |
|    fps                  | 20          |
|    iterations           | 67          |
|    time_elapsed         | 1655        |
|    total_timesteps      | 34304       |
| train/                  |             |
|    approx_kl            | 0.036520313 |
|    clip_fraction        | 0.0247      |
|    clip_range           | 0.4         |
|    entropy_loss         | -14.3       |
|    explained_variance   | 0.787       |
|    learning_rate        | 3e-05       |
|    loss                 | 0.619       |
|    n_updates            | 1320        |
|    policy_gradient_loss | -0.0154     |
|    std                  | 0.135       |
|    value_loss           | 2.13        |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 967         |
|    ep_rew_mean          | -48.1       |
| time/                   |             |
|    fps                  | 20          |
|    iterations           | 68          |
|    time_elapsed         | 1679        |
|    total_timesteps      | 34816       |
| train/                  |             |
|    approx_kl            | 0.020040322 |
|    clip_fraction        | 0.00859     |
|    clip_range           | 0.4         |
|    entropy_loss         | -14.1       |
|    explained_variance   | 0.769       |
|    learning_rate        | 3e-05       |
|    loss                 | 1.42        |
|    n_updates            | 1340        |
|    policy_gradient_loss | -0.00553    |
|    std                  | 0.135       |
|    value_loss           | 3.33        |
-----------------------------------------
Track generation: 1100..1379 -&gt; 279-tiles track
Track generation: 1185..1485 -&gt; 300-tiles track
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 952         |
|    ep_rew_mean          | -47.2       |
| time/                   |             |
|    fps                  | 20          |
|    iterations           | 69          |
|    time_elapsed         | 1703        |
|    total_timesteps      | 35328       |
| train/                  |             |
|    approx_kl            | 0.040469736 |
|    clip_fraction        | 0.0378      |
|    clip_range           | 0.4         |
|    entropy_loss         | -14         |
|    explained_variance   | 0.576       |
|    learning_rate        | 3e-05       |
|    loss                 | 1.52        |
|    n_updates            | 1360        |
|    policy_gradient_loss | -0.0215     |
|    std                  | 0.135       |
|    value_loss           | 3.88        |
-----------------------------------------
----------------------------------------
| rollout/                |            |
|    ep_len_mean          | 952        |
|    ep_rew_mean          | -47.2      |
| time/                   |            |
|    fps                  | 20         |
|    iterations           | 70         |
|    time_elapsed         | 1728       |
|    total_timesteps      | 35840      |
| train/                  |            |
|    approx_kl            | 0.44215629 |
|    clip_fraction        | 0.512      |
|    clip_range           | 0.4        |
|    entropy_loss         | -14.7      |
|    explained_variance   | 0.491      |
|    learning_rate        | 3e-05      |
|    loss                 | 1.99       |
|    n_updates            | 1380       |
|    policy_gradient_loss | 0.13       |
|    std                  | 0.135      |
|    value_loss           | 27.5       |
----------------------------------------
Track generation: 1034..1296 -&gt; 262-tiles track
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 953         |
|    ep_rew_mean          | -46.7       |
| time/                   |             |
|    fps                  | 20          |
|    iterations           | 71          |
|    time_elapsed         | 1752        |
|    total_timesteps      | 36352       |
| train/                  |             |
|    approx_kl            | 0.030815069 |
|    clip_fraction        | 0.0165      |
|    clip_range           | 0.4         |
|    entropy_loss         | -15         |
|    explained_variance   | 0.862       |
|    learning_rate        | 3e-05       |
|    loss                 | 0.612       |
|    n_updates            | 1400        |
|    policy_gradient_loss | -0.0175     |
|    std                  | 0.135       |
|    value_loss           | 2           |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 953         |
|    ep_rew_mean          | -46.7       |
| time/                   |             |
|    fps                  | 20          |
|    iterations           | 72          |
|    time_elapsed         | 1777        |
|    total_timesteps      | 36864       |
| train/                  |             |
|    approx_kl            | 0.031602234 |
|    clip_fraction        | 0.0193      |
|    clip_range           | 0.4         |
|    entropy_loss         | -14.8       |
|    explained_variance   | 0.858       |
|    learning_rate        | 3e-05       |
|    loss                 | 1.21        |
|    n_updates            | 1420        |
|    policy_gradient_loss | -0.00948    |
|    std                  | 0.135       |
|    value_loss           | 1.94        |
-----------------------------------------
Track generation: 1076..1352 -&gt; 276-tiles track
retry to generate track (normal if there are not manyinstances of this message)
Track generation: 1132..1419 -&gt; 287-tiles track
------------------------------------------
| rollout/                |              |
|    ep_len_mean          | 954          |
|    ep_rew_mean          | -46.4        |
| time/                   |              |
|    fps                  | 20           |
|    iterations           | 73           |
|    time_elapsed         | 1801         |
|    total_timesteps      | 37376        |
| train/                  |              |
|    approx_kl            | 0.0025315862 |
|    clip_fraction        | 0.00381      |
|    clip_range           | 0.4          |
|    entropy_loss         | -14.9        |
|    explained_variance   | 0.9          |
|    learning_rate        | 3e-05        |
|    loss                 | 0.855        |
|    n_updates            | 1440         |
|    policy_gradient_loss | 0.00259      |
|    std                  | 0.135        |
|    value_loss           | 2.96         |
------------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 954         |
|    ep_rew_mean          | -46.4       |
| time/                   |             |
|    fps                  | 20          |
|    iterations           | 74          |
|    time_elapsed         | 1826        |
|    total_timesteps      | 37888       |
| train/                  |             |
|    approx_kl            | 0.031421263 |
|    clip_fraction        | 0.0293      |
|    clip_range           | 0.4         |
|    entropy_loss         | -14.6       |
|    explained_variance   | 0.807       |
|    learning_rate        | 3e-05       |
|    loss                 | 1.49        |
|    n_updates            | 1460        |
|    policy_gradient_loss | 0.00237     |
|    std                  | 0.135       |
|    value_loss           | 4.62        |
-----------------------------------------
Track generation: 1292..1619 -&gt; 327-tiles track
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 956         |
|    ep_rew_mean          | -46         |
| time/                   |             |
|    fps                  | 20          |
|    iterations           | 75          |
|    time_elapsed         | 1850        |
|    total_timesteps      | 38400       |
| train/                  |             |
|    approx_kl            | 0.031289548 |
|    clip_fraction        | 0.0177      |
|    clip_range           | 0.4         |
|    entropy_loss         | -14.5       |
|    explained_variance   | 0.799       |
|    learning_rate        | 3e-05       |
|    loss                 | 1.22        |
|    n_updates            | 1480        |
|    policy_gradient_loss | -0.0153     |
|    std                  | 0.135       |
|    value_loss           | 2.52        |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 956         |
|    ep_rew_mean          | -46         |
| time/                   |             |
|    fps                  | 20          |
|    iterations           | 76          |
|    time_elapsed         | 1875        |
|    total_timesteps      | 38912       |
| train/                  |             |
|    approx_kl            | 0.045685038 |
|    clip_fraction        | 0.0259      |
|    clip_range           | 0.4         |
|    entropy_loss         | -14.4       |
|    explained_variance   | 0.913       |
|    learning_rate        | 3e-05       |
|    loss                 | 0.16        |
|    n_updates            | 1500        |
|    policy_gradient_loss | -0.00714    |
|    std                  | 0.135       |
|    value_loss           | 0.761       |
-----------------------------------------
Track generation: 1275..1598 -&gt; 323-tiles track
---------------------------------------
| rollout/                |           |
|    ep_len_mean          | 957       |
|    ep_rew_mean          | -46       |
| time/                   |           |
|    fps                  | 20        |
|    iterations           | 77        |
|    time_elapsed         | 1899      |
|    total_timesteps      | 39424     |
| train/                  |           |
|    approx_kl            | 0.0369477 |
|    clip_fraction        | 0.042     |
|    clip_range           | 0.4       |
|    entropy_loss         | -14.3     |
|    explained_variance   | 0.786     |
|    learning_rate        | 3e-05     |
|    loss                 | 0.191     |
|    n_updates            | 1520      |
|    policy_gradient_loss | -0.0145   |
|    std                  | 0.135     |
|    value_loss           | 0.857     |
---------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 957         |
|    ep_rew_mean          | -46         |
| time/                   |             |
|    fps                  | 20          |
|    iterations           | 78          |
|    time_elapsed         | 1924        |
|    total_timesteps      | 39936       |
| train/                  |             |
|    approx_kl            | 0.054649863 |
|    clip_fraction        | 0.0493      |
|    clip_range           | 0.4         |
|    entropy_loss         | -14.1       |
|    explained_variance   | 0.762       |
|    learning_rate        | 3e-05       |
|    loss                 | 1.21        |
|    n_updates            | 1540        |
|    policy_gradient_loss | -0.0117     |
|    std                  | 0.135       |
|    value_loss           | 2.93        |
-----------------------------------------
Track generation: 1056..1324 -&gt; 268-tiles track
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 958         |
|    ep_rew_mean          | -45.6       |
| time/                   |             |
|    fps                  | 20          |
|    iterations           | 79          |
|    time_elapsed         | 1949        |
|    total_timesteps      | 40448       |
| train/                  |             |
|    approx_kl            | 0.020748341 |
|    clip_fraction        | 0.0132      |
|    clip_range           | 0.4         |
|    entropy_loss         | -14.1       |
|    explained_variance   | 0.827       |
|    learning_rate        | 3e-05       |
|    loss                 | 0.978       |
|    n_updates            | 1560        |
|    policy_gradient_loss | -0.0065     |
|    std                  | 0.135       |
|    value_loss           | 1.93        |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 958         |
|    ep_rew_mean          | -45.6       |
| time/                   |             |
|    fps                  | 20          |
|    iterations           | 80          |
|    time_elapsed         | 1973        |
|    total_timesteps      | 40960       |
| train/                  |             |
|    approx_kl            | 0.015106397 |
|    clip_fraction        | 0.00596     |
|    clip_range           | 0.4         |
|    entropy_loss         | -14.1       |
|    explained_variance   | 0.891       |
|    learning_rate        | 3e-05       |
|    loss                 | 0.802       |
|    n_updates            | 1580        |
|    policy_gradient_loss | -0.0082     |
|    std                  | 0.135       |
|    value_loss           | 2.13        |
-----------------------------------------
Track generation: 1092..1377 -&gt; 285-tiles track
----------------------------------------
| rollout/                |            |
|    ep_len_mean          | 959        |
|    ep_rew_mean          | -44.6      |
| time/                   |            |
|    fps                  | 20         |
|    iterations           | 81         |
|    time_elapsed         | 1997       |
|    total_timesteps      | 41472      |
| train/                  |            |
|    approx_kl            | 0.07681383 |
|    clip_fraction        | 0.0656     |
|    clip_range           | 0.4        |
|    entropy_loss         | -14.4      |
|    explained_variance   | 0.559      |
|    learning_rate        | 3e-05      |
|    loss                 | 1.54       |
|    n_updates            | 1600       |
|    policy_gradient_loss | -0.0111    |
|    std                  | 0.135      |
|    value_loss           | 4.52       |
----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 959         |
|    ep_rew_mean          | -44.6       |
| time/                   |             |
|    fps                  | 20          |
|    iterations           | 82          |
|    time_elapsed         | 2021        |
|    total_timesteps      | 41984       |
| train/                  |             |
|    approx_kl            | 0.038387384 |
|    clip_fraction        | 0.0688      |
|    clip_range           | 0.4         |
|    entropy_loss         | -14.5       |
|    explained_variance   | 0.715       |
|    learning_rate        | 3e-05       |
|    loss                 | 0.951       |
|    n_updates            | 1620        |
|    policy_gradient_loss | -0.0197     |
|    std                  | 0.135       |
|    value_loss           | 2.1         |
-----------------------------------------
Track generation: 1127..1413 -&gt; 286-tiles track
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 960         |
|    ep_rew_mean          | -44.2       |
| time/                   |             |
|    fps                  | 20          |
|    iterations           | 83          |
|    time_elapsed         | 2046        |
|    total_timesteps      | 42496       |
| train/                  |             |
|    approx_kl            | 0.011023871 |
|    clip_fraction        | 0.00156     |
|    clip_range           | 0.4         |
|    entropy_loss         | -14.4       |
|    explained_variance   | 0.677       |
|    learning_rate        | 3e-05       |
|    loss                 | 2.5         |
|    n_updates            | 1640        |
|    policy_gradient_loss | -0.00898    |
|    std                  | 0.135       |
|    value_loss           | 3.92        |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 960         |
|    ep_rew_mean          | -44.2       |
| time/                   |             |
|    fps                  | 20          |
|    iterations           | 84          |
|    time_elapsed         | 2070        |
|    total_timesteps      | 43008       |
| train/                  |             |
|    approx_kl            | 0.042506706 |
|    clip_fraction        | 0.0449      |
|    clip_range           | 0.4         |
|    entropy_loss         | -14.4       |
|    explained_variance   | 0.83        |
|    learning_rate        | 3e-05       |
|    loss                 | 1.37        |
|    n_updates            | 1660        |
|    policy_gradient_loss | -0.016      |
|    std                  | 0.135       |
|    value_loss           | 1.93        |
-----------------------------------------
Track generation: 1104..1384 -&gt; 280-tiles track
----------------------------------------
| rollout/                |            |
|    ep_len_mean          | 960        |
|    ep_rew_mean          | -43.8      |
| time/                   |            |
|    fps                  | 20         |
|    iterations           | 85         |
|    time_elapsed         | 2094       |
|    total_timesteps      | 43520      |
| train/                  |            |
|    approx_kl            | 0.05223446 |
|    clip_fraction        | 0.0543     |
|    clip_range           | 0.4        |
|    entropy_loss         | -14.6      |
|    explained_variance   | 0.695      |
|    learning_rate        | 3e-05      |
|    loss                 | 0.339      |
|    n_updates            | 1680       |
|    policy_gradient_loss | -0.0172    |
|    std                  | 0.135      |
|    value_loss           | 1.13       |
----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 960         |
|    ep_rew_mean          | -43.8       |
| time/                   |             |
|    fps                  | 20          |
|    iterations           | 86          |
|    time_elapsed         | 2119        |
|    total_timesteps      | 44032       |
| train/                  |             |
|    approx_kl            | 0.038274806 |
|    clip_fraction        | 0.036       |
|    clip_range           | 0.4         |
|    entropy_loss         | -14.7       |
|    explained_variance   | 0.886       |
|    learning_rate        | 3e-05       |
|    loss                 | 0.433       |
|    n_updates            | 1700        |
|    policy_gradient_loss | -0.0119     |
|    std                  | 0.135       |
|    value_loss           | 1.41        |
-----------------------------------------
Track generation: 1131..1430 -&gt; 299-tiles track
retry to generate track (normal if there are not manyinstances of this message)
Track generation: 1195..1498 -&gt; 303-tiles track
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 961         |
|    ep_rew_mean          | -43.7       |
| time/                   |             |
|    fps                  | 20          |
|    iterations           | 87          |
|    time_elapsed         | 2143        |
|    total_timesteps      | 44544       |
| train/                  |             |
|    approx_kl            | 0.014994748 |
|    clip_fraction        | 0.00635     |
|    clip_range           | 0.4         |
|    entropy_loss         | -14.8       |
|    explained_variance   | 0.857       |
|    learning_rate        | 3e-05       |
|    loss                 | 0.238       |
|    n_updates            | 1720        |
|    policy_gradient_loss | -0.00857    |
|    std                  | 0.135       |
|    value_loss           | 1.02        |
-----------------------------------------
Track generation: 1155..1448 -&gt; 293-tiles track
----------------------------------------
| rollout/                |            |
|    ep_len_mean          | 948        |
|    ep_rew_mean          | -45.3      |
| time/                   |            |
|    fps                  | 20         |
|    iterations           | 88         |
|    time_elapsed         | 2168       |
|    total_timesteps      | 45056      |
| train/                  |            |
|    approx_kl            | 0.05057558 |
|    clip_fraction        | 0.0987     |
|    clip_range           | 0.4        |
|    entropy_loss         | -14.7      |
|    explained_variance   | 0.891      |
|    learning_rate        | 3e-05      |
|    loss                 | 0.126      |
|    n_updates            | 1740       |
|    policy_gradient_loss | -0.00937   |
|    std                  | 0.135      |
|    value_loss           | 0.985      |
----------------------------------------
----------------------------------------
| rollout/                |            |
|    ep_len_mean          | 948        |
|    ep_rew_mean          | -45.3      |
| time/                   |            |
|    fps                  | 20         |
|    iterations           | 89         |
|    time_elapsed         | 2192       |
|    total_timesteps      | 45568      |
| train/                  |            |
|    approx_kl            | 0.29031533 |
|    clip_fraction        | 0.633      |
|    clip_range           | 0.4        |
|    entropy_loss         | -15.3      |
|    explained_variance   | 0.752      |
|    learning_rate        | 3e-05      |
|    loss                 | 2.87       |
|    n_updates            | 1760       |
|    policy_gradient_loss | 0.101      |
|    std                  | 0.135      |
|    value_loss           | 13.1       |
----------------------------------------
Track generation: 1317..1650 -&gt; 333-tiles track
---------------------------------------
| rollout/                |           |
|    ep_len_mean          | 949       |
|    ep_rew_mean          | -44.4     |
| time/                   |           |
|    fps                  | 20        |
|    iterations           | 90        |
|    time_elapsed         | 2216      |
|    total_timesteps      | 46080     |
| train/                  |           |
|    approx_kl            | 0.0204425 |
|    clip_fraction        | 0.0209    |
|    clip_range           | 0.4       |
|    entropy_loss         | -15.5     |
|    explained_variance   | 0.813     |
|    learning_rate        | 3e-05     |
|    loss                 | 2.08      |
|    n_updates            | 1780      |
|    policy_gradient_loss | -0.014    |
|    std                  | 0.135     |
|    value_loss           | 3.36      |
---------------------------------------
Track generation: 1180..1479 -&gt; 299-tiles track
-------------------------------------------
| rollout/                |               |
|    ep_len_mean          | 950           |
|    ep_rew_mean          | -43.4         |
| time/                   |               |
|    fps                  | 20            |
|    iterations           | 91            |
|    time_elapsed         | 2241          |
|    total_timesteps      | 46592         |
| train/                  |               |
|    approx_kl            | 0.00093930925 |
|    clip_fraction        | 0             |
|    clip_range           | 0.4           |
|    entropy_loss         | -15.5         |
|    explained_variance   | 0.816         |
|    learning_rate        | 3e-05         |
|    loss                 | 3.97          |
|    n_updates            | 1800          |
|    policy_gradient_loss | -0.00298      |
|    std                  | 0.135         |
|    value_loss           | 7.34          |
-------------------------------------------
------------------------------------------
| rollout/                |              |
|    ep_len_mean          | 950          |
|    ep_rew_mean          | -43.4        |
| time/                   |              |
|    fps                  | 20           |
|    iterations           | 92           |
|    time_elapsed         | 2266         |
|    total_timesteps      | 47104        |
| train/                  |              |
|    approx_kl            | 0.0035038656 |
|    clip_fraction        | 0            |
|    clip_range           | 0.4          |
|    entropy_loss         | -15.5        |
|    explained_variance   | 0.681        |
|    learning_rate        | 3e-05        |
|    loss                 | 2.02         |
|    n_updates            | 1820         |
|    policy_gradient_loss | -0.00354     |
|    std                  | 0.135        |
|    value_loss           | 4.12         |
------------------------------------------
Track generation: 1170..1467 -&gt; 297-tiles track
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 945         |
|    ep_rew_mean          | -44.1       |
| time/                   |             |
|    fps                  | 20          |
|    iterations           | 93          |
|    time_elapsed         | 2290        |
|    total_timesteps      | 47616       |
| train/                  |             |
|    approx_kl            | 0.010773279 |
|    clip_fraction        | 0           |
|    clip_range           | 0.4         |
|    entropy_loss         | -15.5       |
|    explained_variance   | 0.798       |
|    learning_rate        | 3e-05       |
|    loss                 | 2.76        |
|    n_updates            | 1840        |
|    policy_gradient_loss | -0.0119     |
|    std                  | 0.135       |
|    value_loss           | 7.37        |
-----------------------------------------
------------------------------------------
| rollout/                |              |
|    ep_len_mean          | 945          |
|    ep_rew_mean          | -44.1        |
| time/                   |              |
|    fps                  | 20           |
|    iterations           | 94           |
|    time_elapsed         | 2315         |
|    total_timesteps      | 48128        |
| train/                  |              |
|    approx_kl            | 0.0029487126 |
|    clip_fraction        | 0.0085       |
|    clip_range           | 0.4          |
|    entropy_loss         | -15.6        |
|    explained_variance   | 0.901        |
|    learning_rate        | 3e-05        |
|    loss                 | 5.41         |
|    n_updates            | 1860         |
|    policy_gradient_loss | 0.00307      |
|    std                  | 0.135        |
|    value_loss           | 18           |
------------------------------------------
Track generation: 1022..1282 -&gt; 260-tiles track
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 946         |
|    ep_rew_mean          | -43.9       |
| time/                   |             |
|    fps                  | 20          |
|    iterations           | 95          |
|    time_elapsed         | 2340        |
|    total_timesteps      | 48640       |
| train/                  |             |
|    approx_kl            | 0.048562054 |
|    clip_fraction        | 0.0877      |
|    clip_range           | 0.4         |
|    entropy_loss         | -15.4       |
|    explained_variance   | 0.726       |
|    learning_rate        | 3e-05       |
|    loss                 | 2.98        |
|    n_updates            | 1880        |
|    policy_gradient_loss | -0.0104     |
|    std                  | 0.135       |
|    value_loss           | 5.23        |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 946         |
|    ep_rew_mean          | -43.9       |
| time/                   |             |
|    fps                  | 20          |
|    iterations           | 96          |
|    time_elapsed         | 2364        |
|    total_timesteps      | 49152       |
| train/                  |             |
|    approx_kl            | 0.011871744 |
|    clip_fraction        | 0           |
|    clip_range           | 0.4         |
|    entropy_loss         | -15.2       |
|    explained_variance   | 0.838       |
|    learning_rate        | 3e-05       |
|    loss                 | 1.38        |
|    n_updates            | 1900        |
|    policy_gradient_loss | -0.0107     |
|    std                  | 0.135       |
|    value_loss           | 3.1         |
-----------------------------------------
Track generation: 1230..1542 -&gt; 312-tiles track
------------------------------------------
| rollout/                |              |
|    ep_len_mean          | 947          |
|    ep_rew_mean          | -43.7        |
| time/                   |              |
|    fps                  | 20           |
|    iterations           | 97           |
|    time_elapsed         | 2389         |
|    total_timesteps      | 49664        |
| train/                  |              |
|    approx_kl            | 0.0013888017 |
|    clip_fraction        | 0            |
|    clip_range           | 0.4          |
|    entropy_loss         | -15.2        |
|    explained_variance   | 0.835        |
|    learning_rate        | 3e-05        |
|    loss                 | 1.04         |
|    n_updates            | 1920         |
|    policy_gradient_loss | 0.000187     |
|    std                  | 0.135        |
|    value_loss           | 3.48         |
------------------------------------------
Track generation: 1143..1442 -&gt; 299-tiles track
Track generation: 1087..1369 -&gt; 282-tiles track
Track generation: 964..1212 -&gt; 248-tiles track
retry to generate track (normal if there are not manyinstances of this message)
Track generation: 1176..1474 -&gt; 298-tiles track
Track generation: 1283..1608 -&gt; 325-tiles track
Track generation: 1217..1526 -&gt; 309-tiles track
Track generation: 1096..1374 -&gt; 278-tiles track
Eval num_timesteps=50000, episode_reward=-93.35 +/- 0.31
Episode length: 1000.00 +/- 0.00
-----------------------------------------
| eval/                   |             |
|    mean_ep_length       | 1e+03       |
|    mean_reward          | -93.4       |
| time/                   |             |
|    total_timesteps      | 50000       |
| train/                  |             |
|    approx_kl            | 0.044531804 |
|    clip_fraction        | 0.0391      |
|    clip_range           | 0.4         |
|    entropy_loss         | -15         |
|    explained_variance   | 0.733       |
|    learning_rate        | 3e-05       |
|    loss                 | 1.07        |
|    n_updates            | 1940        |
|    policy_gradient_loss | -0.0101     |
|    std                  | 0.135       |
|    value_loss           | 3.13        |
-----------------------------------------
New best mean reward!
---------------------------------
| rollout/           |          |
|    ep_len_mean     | 947      |
|    ep_rew_mean     | -43.7    |
| time/              |          |
|    fps             | 19       |
|    iterations      | 98       |
|    time_elapsed    | 2513     |
|    total_timesteps | 50176    |
---------------------------------
Track generation: 1018..1278 -&gt; 260-tiles track
retry to generate track (normal if there are not manyinstances of this message)
Track generation: 1126..1412 -&gt; 286-tiles track
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 948         |
|    ep_rew_mean          | -44.3       |
| time/                   |             |
|    fps                  | 19          |
|    iterations           | 99          |
|    time_elapsed         | 2538        |
|    total_timesteps      | 50688       |
| train/                  |             |
|    approx_kl            | 0.010866655 |
|    clip_fraction        | 0           |
|    clip_range           | 0.4         |
|    entropy_loss         | -14.9       |
|    explained_variance   | 0.0283      |
|    learning_rate        | 3e-05       |
|    loss                 | 0.0494      |
|    n_updates            | 1960        |
|    policy_gradient_loss | -0.00282    |
|    std                  | 0.135       |
|    value_loss           | 0.816       |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 948         |
|    ep_rew_mean          | -44.3       |
| time/                   |             |
|    fps                  | 19          |
|    iterations           | 100         |
|    time_elapsed         | 2564        |
|    total_timesteps      | 51200       |
| train/                  |             |
|    approx_kl            | 0.011065373 |
|    clip_fraction        | 0.000586    |
|    clip_range           | 0.4         |
|    entropy_loss         | -14.9       |
|    explained_variance   | 0.842       |
|    learning_rate        | 3e-05       |
|    loss                 | 0.994       |
|    n_updates            | 1980        |
|    policy_gradient_loss | -0.0117     |
|    std                  | 0.135       |
|    value_loss           | 2.15        |
-----------------------------------------
Track generation: 1251..1568 -&gt; 317-tiles track
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 949         |
|    ep_rew_mean          | -44.2       |
| time/                   |             |
|    fps                  | 19          |
|    iterations           | 101         |
|    time_elapsed         | 2589        |
|    total_timesteps      | 51712       |
| train/                  |             |
|    approx_kl            | 0.016237192 |
|    clip_fraction        | 0.00703     |
|    clip_range           | 0.4         |
|    entropy_loss         | -14.9       |
|    explained_variance   | 0.777       |
|    learning_rate        | 3e-05       |
|    loss                 | 0.543       |
|    n_updates            | 2000        |
|    policy_gradient_loss | -0.0114     |
|    std                  | 0.135       |
|    value_loss           | 1.12        |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 949         |
|    ep_rew_mean          | -44.2       |
| time/                   |             |
|    fps                  | 19          |
|    iterations           | 102         |
|    time_elapsed         | 2614        |
|    total_timesteps      | 52224       |
| train/                  |             |
|    approx_kl            | 0.040681534 |
|    clip_fraction        | 0.0729      |
|    clip_range           | 0.4         |
|    entropy_loss         | -14.8       |
|    explained_variance   | 0.915       |
|    learning_rate        | 3e-05       |
|    loss                 | 0.466       |
|    n_updates            | 2020        |
|    policy_gradient_loss | -0.0198     |
|    std                  | 0.135       |
|    value_loss           | 1.81        |
-----------------------------------------
Track generation: 1202..1507 -&gt; 305-tiles track
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 950         |
|    ep_rew_mean          | -44.5       |
| time/                   |             |
|    fps                  | 19          |
|    iterations           | 103         |
|    time_elapsed         | 2640        |
|    total_timesteps      | 52736       |
| train/                  |             |
|    approx_kl            | 0.054784987 |
|    clip_fraction        | 0.12        |
|    clip_range           | 0.4         |
|    entropy_loss         | -14.6       |
|    explained_variance   | -0.2        |
|    learning_rate        | 3e-05       |
|    loss                 | 0.3         |
|    n_updates            | 2040        |
|    policy_gradient_loss | -0.0228     |
|    std                  | 0.135       |
|    value_loss           | 0.721       |
-----------------------------------------
Track generation: 1265..1592 -&gt; 327-tiles track
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 951         |
|    ep_rew_mean          | -44.7       |
| time/                   |             |
|    fps                  | 19          |
|    iterations           | 104         |
|    time_elapsed         | 2666        |
|    total_timesteps      | 53248       |
| train/                  |             |
|    approx_kl            | 0.026890337 |
|    clip_fraction        | 0.02        |
|    clip_range           | 0.4         |
|    entropy_loss         | -14.5       |
|    explained_variance   | 0.667       |
|    learning_rate        | 3e-05       |
|    loss                 | 0.83        |
|    n_updates            | 2060        |
|    policy_gradient_loss | -0.0155     |
|    std                  | 0.135       |
|    value_loss           | 2.14        |
-----------------------------------------
----------------------------------------
| rollout/                |            |
|    ep_len_mean          | 951        |
|    ep_rew_mean          | -44.7      |
| time/                   |            |
|    fps                  | 19         |
|    iterations           | 105        |
|    time_elapsed         | 2693       |
|    total_timesteps      | 53760      |
| train/                  |            |
|    approx_kl            | 0.04781215 |
|    clip_fraction        | 0.0626     |
|    clip_range           | 0.4        |
|    entropy_loss         | -14.4      |
|    explained_variance   | 0.801      |
|    learning_rate        | 3e-05      |
|    loss                 | 0.471      |
|    n_updates            | 2080       |
|    policy_gradient_loss | -0.0206    |
|    std                  | 0.135      |
|    value_loss           | 1.22       |
----------------------------------------
Track generation: 1049..1315 -&gt; 266-tiles track
----------------------------------------
| rollout/                |            |
|    ep_len_mean          | 952        |
|    ep_rew_mean          | -44.6      |
| time/                   |            |
|    fps                  | 19         |
|    iterations           | 106        |
|    time_elapsed         | 2725       |
|    total_timesteps      | 54272      |
| train/                  |            |
|    approx_kl            | 0.05690659 |
|    clip_fraction        | 0.07       |
|    clip_range           | 0.4        |
|    entropy_loss         | -14.3      |
|    explained_variance   | 0.627      |
|    learning_rate        | 3e-05      |
|    loss                 | 2.1        |
|    n_updates            | 2100       |
|    policy_gradient_loss | -0.00361   |
|    std                  | 0.135      |
|    value_loss           | 1.67       |
----------------------------------------
------------------------------------------
| rollout/                |              |
|    ep_len_mean          | 952          |
|    ep_rew_mean          | -44.6        |
| time/                   |              |
|    fps                  | 19           |
|    iterations           | 107          |
|    time_elapsed         | 2754         |
|    total_timesteps      | 54784        |
| train/                  |              |
|    approx_kl            | 0.0017276043 |
|    clip_fraction        | 0            |
|    clip_range           | 0.4          |
|    entropy_loss         | -14.3        |
|    explained_variance   | 0.71         |
|    learning_rate        | 3e-05        |
|    loss                 | 3.6          |
|    n_updates            | 2120         |
|    policy_gradient_loss | -0.0042      |
|    std                  | 0.135        |
|    value_loss           | 3.3          |
------------------------------------------
Track generation: 1345..1685 -&gt; 340-tiles track
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 953         |
|    ep_rew_mean          | -44.8       |
| time/                   |             |
|    fps                  | 19          |
|    iterations           | 108         |
|    time_elapsed         | 2783        |
|    total_timesteps      | 55296       |
| train/                  |             |
|    approx_kl            | 0.015197815 |
|    clip_fraction        | 0.000586    |
|    clip_range           | 0.4         |
|    entropy_loss         | -14.2       |
|    explained_variance   | 0.856       |
|    learning_rate        | 3e-05       |
|    loss                 | 1.08        |
|    n_updates            | 2140        |
|    policy_gradient_loss | -0.0058     |
|    std                  | 0.135       |
|    value_loss           | 1.08        |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 953         |
|    ep_rew_mean          | -44.8       |
| time/                   |             |
|    fps                  | 19          |
|    iterations           | 109         |
|    time_elapsed         | 2812        |
|    total_timesteps      | 55808       |
| train/                  |             |
|    approx_kl            | 0.018339094 |
|    clip_fraction        | 0.00186     |
|    clip_range           | 0.4         |
|    entropy_loss         | -14.1       |
|    explained_variance   | 0.961       |
|    learning_rate        | 3e-05       |
|    loss                 | 0.0953      |
|    n_updates            | 2160        |
|    policy_gradient_loss | -0.00694    |
|    std                  | 0.135       |
|    value_loss           | 0.958       |
-----------------------------------------
Track generation: 929..1167 -&gt; 238-tiles track
retry to generate track (normal if there are not manyinstances of this message)
Track generation: 1059..1328 -&gt; 269-tiles track
------------------------------------------
| rollout/                |              |
|    ep_len_mean          | 953          |
|    ep_rew_mean          | -44.4        |
| time/                   |              |
|    fps                  | 19           |
|    iterations           | 110          |
|    time_elapsed         | 2839         |
|    total_timesteps      | 56320        |
| train/                  |              |
|    approx_kl            | 0.0061628837 |
|    clip_fraction        | 0.00186      |
|    clip_range           | 0.4          |
|    entropy_loss         | -14          |
|    explained_variance   | 0.639        |
|    learning_rate        | 3e-05        |
|    loss                 | 3.28         |
|    n_updates            | 2180         |
|    policy_gradient_loss | -0.00283     |
|    std                  | 0.135        |
|    value_loss           | 7.01         |
------------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 953         |
|    ep_rew_mean          | -44.4       |
| time/                   |             |
|    fps                  | 19          |
|    iterations           | 111         |
|    time_elapsed         | 2864        |
|    total_timesteps      | 56832       |
| train/                  |             |
|    approx_kl            | 0.007891718 |
|    clip_fraction        | 0           |
|    clip_range           | 0.4         |
|    entropy_loss         | -14.1       |
|    explained_variance   | 0.608       |
|    learning_rate        | 3e-05       |
|    loss                 | 0.789       |
|    n_updates            | 2200        |
|    policy_gradient_loss | -0.0052     |
|    std                  | 0.135       |
|    value_loss           | 2.7         |
-----------------------------------------
Track generation: 981..1236 -&gt; 255-tiles track
----------------------------------------
| rollout/                |            |
|    ep_len_mean          | 954        |
|    ep_rew_mean          | -44.8      |
| time/                   |            |
|    fps                  | 19         |
|    iterations           | 112        |
|    time_elapsed         | 2890       |
|    total_timesteps      | 57344      |
| train/                  |            |
|    approx_kl            | 0.09024031 |
|    clip_fraction        | 0.175      |
|    clip_range           | 0.4        |
|    entropy_loss         | -14        |
|    explained_variance   | 0.274      |
|    learning_rate        | 3e-05      |
|    loss                 | 1.01       |
|    n_updates            | 2220       |
|    policy_gradient_loss | -0.0201    |
|    std                  | 0.135      |
|    value_loss           | 2.6        |
----------------------------------------
----------------------------------------
| rollout/                |            |
|    ep_len_mean          | 954        |
|    ep_rew_mean          | -44.8      |
| time/                   |            |
|    fps                  | 19         |
|    iterations           | 113        |
|    time_elapsed         | 2915       |
|    total_timesteps      | 57856      |
| train/                  |            |
|    approx_kl            | 0.10053999 |
|    clip_fraction        | 0.181      |
|    clip_range           | 0.4        |
|    entropy_loss         | -13.6      |
|    explained_variance   | 0.136      |
|    learning_rate        | 3e-05      |
|    loss                 | 0.334      |
|    n_updates            | 2240       |
|    policy_gradient_loss | -0.00518   |
|    std                  | 0.135      |
|    value_loss           | 1.33       |
----------------------------------------
Track generation: 1220..1529 -&gt; 309-tiles track
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 955         |
|    ep_rew_mean          | -44.4       |
| time/                   |             |
|    fps                  | 19          |
|    iterations           | 114         |
|    time_elapsed         | 2941        |
|    total_timesteps      | 58368       |
| train/                  |             |
|    approx_kl            | 0.072058104 |
|    clip_fraction        | 0.119       |
|    clip_range           | 0.4         |
|    entropy_loss         | -13.3       |
|    explained_variance   | 0.691       |
|    learning_rate        | 3e-05       |
|    loss                 | 0.426       |
|    n_updates            | 2260        |
|    policy_gradient_loss | 0.00789     |
|    std                  | 0.135       |
|    value_loss           | 0.913       |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 955         |
|    ep_rew_mean          | -44.4       |
| time/                   |             |
|    fps                  | 19          |
|    iterations           | 115         |
|    time_elapsed         | 2966        |
|    total_timesteps      | 58880       |
| train/                  |             |
|    approx_kl            | 0.039107528 |
|    clip_fraction        | 0.0323      |
|    clip_range           | 0.4         |
|    entropy_loss         | -13.2       |
|    explained_variance   | 0.694       |
|    learning_rate        | 3e-05       |
|    loss                 | 1.28        |
|    n_updates            | 2280        |
|    policy_gradient_loss | -0.0159     |
|    std                  | 0.135       |
|    value_loss           | 2.35        |
-----------------------------------------
Track generation: 1062..1332 -&gt; 270-tiles track
----------------------------------------
| rollout/                |            |
|    ep_len_mean          | 956        |
|    ep_rew_mean          | -44.4      |
| time/                   |            |
|    fps                  | 19         |
|    iterations           | 116        |
|    time_elapsed         | 2992       |
|    total_timesteps      | 59392      |
| train/                  |            |
|    approx_kl            | 0.06479995 |
|    clip_fraction        | 0.0646     |
|    clip_range           | 0.4        |
|    entropy_loss         | -13.3      |
|    explained_variance   | 0.375      |
|    learning_rate        | 3e-05      |
|    loss                 | 1.01       |
|    n_updates            | 2300       |
|    policy_gradient_loss | -0.0227    |
|    std                  | 0.135      |
|    value_loss           | 2.57       |
----------------------------------------
----------------------------------------
| rollout/                |            |
|    ep_len_mean          | 956        |
|    ep_rew_mean          | -44.4      |
| time/                   |            |
|    fps                  | 19         |
|    iterations           | 117        |
|    time_elapsed         | 3017       |
|    total_timesteps      | 59904      |
| train/                  |            |
|    approx_kl            | 0.04844359 |
|    clip_fraction        | 0.0721     |
|    clip_range           | 0.4        |
|    entropy_loss         | -13.4      |
|    explained_variance   | 0.786      |
|    learning_rate        | 3e-05      |
|    loss                 | 0.178      |
|    n_updates            | 2320       |
|    policy_gradient_loss | -0.0353    |
|    std                  | 0.135      |
|    value_loss           | 0.745      |
----------------------------------------
Track generation: 1148..1439 -&gt; 291-tiles track
----------------------------------------
| rollout/                |            |
|    ep_len_mean          | 956        |
|    ep_rew_mean          | -44.7      |
| time/                   |            |
|    fps                  | 19         |
|    iterations           | 118        |
|    time_elapsed         | 3043       |
|    total_timesteps      | 60416      |
| train/                  |            |
|    approx_kl            | 0.11929134 |
|    clip_fraction        | 0.151      |
|    clip_range           | 0.4        |
|    entropy_loss         | -13.3      |
|    explained_variance   | 0.792      |
|    learning_rate        | 3e-05      |
|    loss                 | 0.449      |
|    n_updates            | 2340       |
|    policy_gradient_loss | 0.0155     |
|    std                  | 0.135      |
|    value_loss           | 0.712      |
----------------------------------------
----------------------------------------
| rollout/                |            |
|    ep_len_mean          | 956        |
|    ep_rew_mean          | -44.7      |
| time/                   |            |
|    fps                  | 19         |
|    iterations           | 119        |
|    time_elapsed         | 3068       |
|    total_timesteps      | 60928      |
| train/                  |            |
|    approx_kl            | 0.02596452 |
|    clip_fraction        | 0.0298     |
|    clip_range           | 0.4        |
|    entropy_loss         | -13.3      |
|    explained_variance   | 0.796      |
|    learning_rate        | 3e-05      |
|    loss                 | 0.385      |
|    n_updates            | 2360       |
|    policy_gradient_loss | -0.0148    |
|    std                  | 0.135      |
|    value_loss           | 1.97       |
----------------------------------------
Track generation: 983..1235 -&gt; 252-tiles track
retry to generate track (normal if there are not manyinstances of this message)
Track generation: 1106..1387 -&gt; 281-tiles track
----------------------------------------
| rollout/                |            |
|    ep_len_mean          | 957        |
|    ep_rew_mean          | -44.6      |
| time/                   |            |
|    fps                  | 19         |
|    iterations           | 120        |
|    time_elapsed         | 3094       |
|    total_timesteps      | 61440      |
| train/                  |            |
|    approx_kl            | 0.02635652 |
|    clip_fraction        | 0.0347     |
|    clip_range           | 0.4        |
|    entropy_loss         | -13.4      |
|    explained_variance   | 0.38       |
|    learning_rate        | 3e-05      |
|    loss                 | 0.822      |
|    n_updates            | 2380       |
|    policy_gradient_loss | -0.0129    |
|    std                  | 0.135      |
|    value_loss           | 3.01       |
----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 957         |
|    ep_rew_mean          | -44.6       |
| time/                   |             |
|    fps                  | 19          |
|    iterations           | 121         |
|    time_elapsed         | 3119        |
|    total_timesteps      | 61952       |
| train/                  |             |
|    approx_kl            | 0.037543695 |
|    clip_fraction        | 0.0477      |
|    clip_range           | 0.4         |
|    entropy_loss         | -13.4       |
|    explained_variance   | 0.828       |
|    learning_rate        | 3e-05       |
|    loss                 | 0.788       |
|    n_updates            | 2400        |
|    policy_gradient_loss | -0.01       |
|    std                  | 0.135       |
|    value_loss           | 1.71        |
-----------------------------------------
Track generation: 1068..1339 -&gt; 271-tiles track
---------------------------------------
| rollout/                |           |
|    ep_len_mean          | 958       |
|    ep_rew_mean          | -44.1     |
| time/                   |           |
|    fps                  | 19        |
|    iterations           | 122       |
|    time_elapsed         | 3145      |
|    total_timesteps      | 62464     |
| train/                  |           |
|    approx_kl            | 0.0350944 |
|    clip_fraction        | 0.0185    |
|    clip_range           | 0.4       |
|    entropy_loss         | -13.4     |
|    explained_variance   | 0.357     |
|    learning_rate        | 3e-05     |
|    loss                 | 0.697     |
|    n_updates            | 2420      |
|    policy_gradient_loss | -0.013    |
|    std                  | 0.135     |
|    value_loss           | 2.03      |
---------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 958         |
|    ep_rew_mean          | -44.1       |
| time/                   |             |
|    fps                  | 19          |
|    iterations           | 123         |
|    time_elapsed         | 3170        |
|    total_timesteps      | 62976       |
| train/                  |             |
|    approx_kl            | 0.016181078 |
|    clip_fraction        | 0.0043      |
|    clip_range           | 0.4         |
|    entropy_loss         | -13.3       |
|    explained_variance   | 0.7         |
|    learning_rate        | 3e-05       |
|    loss                 | 0.238       |
|    n_updates            | 2440        |
|    policy_gradient_loss | -0.00046    |
|    std                  | 0.135       |
|    value_loss           | 1.68        |
-----------------------------------------
Track generation: 1285..1611 -&gt; 326-tiles track
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 958         |
|    ep_rew_mean          | -43.6       |
| time/                   |             |
|    fps                  | 19          |
|    iterations           | 124         |
|    time_elapsed         | 3195        |
|    total_timesteps      | 63488       |
| train/                  |             |
|    approx_kl            | 0.023074277 |
|    clip_fraction        | 0.0768      |
|    clip_range           | 0.4         |
|    entropy_loss         | -13.7       |
|    explained_variance   | 0.702       |
|    learning_rate        | 3e-05       |
|    loss                 | 1.62        |
|    n_updates            | 2460        |
|    policy_gradient_loss | 0.0148      |
|    std                  | 0.135       |
|    value_loss           | 2.77        |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 958         |
|    ep_rew_mean          | -43.6       |
| time/                   |             |
|    fps                  | 19          |
|    iterations           | 125         |
|    time_elapsed         | 3220        |
|    total_timesteps      | 64000       |
| train/                  |             |
|    approx_kl            | 0.012833657 |
|    clip_fraction        | 0.000195    |
|    clip_range           | 0.4         |
|    entropy_loss         | -13.6       |
|    explained_variance   | 0.871       |
|    learning_rate        | 3e-05       |
|    loss                 | 0.388       |
|    n_updates            | 2480        |
|    policy_gradient_loss | -0.00261    |
|    std                  | 0.135       |
|    value_loss           | 1.43        |
-----------------------------------------
Track generation: 1224..1534 -&gt; 310-tiles track
----------------------------------------
| rollout/                |            |
|    ep_len_mean          | 959        |
|    ep_rew_mean          | -43.4      |
| time/                   |            |
|    fps                  | 19         |
|    iterations           | 126        |
|    time_elapsed         | 3245       |
|    total_timesteps      | 64512      |
| train/                  |            |
|    approx_kl            | 0.01688924 |
|    clip_fraction        | 0.00244    |
|    clip_range           | 0.4        |
|    entropy_loss         | -13.5      |
|    explained_variance   | 0.863      |
|    learning_rate        | 3e-05      |
|    loss                 | 0.68       |
|    n_updates            | 2500       |
|    policy_gradient_loss | -0.00382   |
|    std                  | 0.135      |
|    value_loss           | 2.26       |
----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 959         |
|    ep_rew_mean          | -43.4       |
| time/                   |             |
|    fps                  | 19          |
|    iterations           | 127         |
|    time_elapsed         | 3270        |
|    total_timesteps      | 65024       |
| train/                  |             |
|    approx_kl            | 0.028630335 |
|    clip_fraction        | 0.0201      |
|    clip_range           | 0.4         |
|    entropy_loss         | -13.6       |
|    explained_variance   | 0.967       |
|    learning_rate        | 3e-05       |
|    loss                 | 0.192       |
|    n_updates            | 2520        |
|    policy_gradient_loss | -0.0109     |
|    std                  | 0.135       |
|    value_loss           | 0.685       |
-----------------------------------------
Track generation: 1095..1373 -&gt; 278-tiles track
retry to generate track (normal if there are not manyinstances of this message)
Track generation: 1209..1515 -&gt; 306-tiles track
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 960         |
|    ep_rew_mean          | -42.2       |
| time/                   |             |
|    fps                  | 19          |
|    iterations           | 128         |
|    time_elapsed         | 3296        |
|    total_timesteps      | 65536       |
| train/                  |             |
|    approx_kl            | 0.040481023 |
|    clip_fraction        | 0.0154      |
|    clip_range           | 0.4         |
|    entropy_loss         | -13.5       |
|    explained_variance   | 0.699       |
|    learning_rate        | 3e-05       |
|    loss                 | 0.895       |
|    n_updates            | 2540        |
|    policy_gradient_loss | -0.00649    |
|    std                  | 0.135       |
|    value_loss           | 3.45        |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 960         |
|    ep_rew_mean          | -42.2       |
| time/                   |             |
|    fps                  | 19          |
|    iterations           | 129         |
|    time_elapsed         | 3321        |
|    total_timesteps      | 66048       |
| train/                  |             |
|    approx_kl            | 0.045448117 |
|    clip_fraction        | 0.0671      |
|    clip_range           | 0.4         |
|    entropy_loss         | -13.6       |
|    explained_variance   | 0.774       |
|    learning_rate        | 3e-05       |
|    loss                 | 2.76        |
|    n_updates            | 2560        |
|    policy_gradient_loss | -0.0433     |
|    std                  | 0.135       |
|    value_loss           | 5.5         |
-----------------------------------------
Track generation: 1167..1463 -&gt; 296-tiles track
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 960         |
|    ep_rew_mean          | -42.7       |
| time/                   |             |
|    fps                  | 19          |
|    iterations           | 130         |
|    time_elapsed         | 3346        |
|    total_timesteps      | 66560       |
| train/                  |             |
|    approx_kl            | 0.066740915 |
|    clip_fraction        | 0.0477      |
|    clip_range           | 0.4         |
|    entropy_loss         | -13.7       |
|    explained_variance   | 0.34        |
|    learning_rate        | 3e-05       |
|    loss                 | 0.64        |
|    n_updates            | 2580        |
|    policy_gradient_loss | -0.0166     |
|    std                  | 0.135       |
|    value_loss           | 0.796       |
-----------------------------------------
------------------------------------------
| rollout/                |              |
|    ep_len_mean          | 960          |
|    ep_rew_mean          | -42.7        |
| time/                   |              |
|    fps                  | 19           |
|    iterations           | 131          |
|    time_elapsed         | 3371         |
|    total_timesteps      | 67072        |
| train/                  |              |
|    approx_kl            | 0.0031907046 |
|    clip_fraction        | 0.000488     |
|    clip_range           | 0.4          |
|    entropy_loss         | -13.7        |
|    explained_variance   | 0.895        |
|    learning_rate        | 3e-05        |
|    loss                 | 0.88         |
|    n_updates            | 2600         |
|    policy_gradient_loss | -0.00585     |
|    std                  | 0.135        |
|    value_loss           | 2.57         |
------------------------------------------
Track generation: 1215..1523 -&gt; 308-tiles track
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 961         |
|    ep_rew_mean          | -42.3       |
| time/                   |             |
|    fps                  | 19          |
|    iterations           | 132         |
|    time_elapsed         | 3397        |
|    total_timesteps      | 67584       |
| train/                  |             |
|    approx_kl            | 0.015517259 |
|    clip_fraction        | 0.00635     |
|    clip_range           | 0.4         |
|    entropy_loss         | -13.6       |
|    explained_variance   | 0.842       |
|    learning_rate        | 3e-05       |
|    loss                 | 1.12        |
|    n_updates            | 2620        |
|    policy_gradient_loss | -0.00634    |
|    std                  | 0.135       |
|    value_loss           | 2.66        |
-----------------------------------------
Track generation: 1292..1619 -&gt; 327-tiles track
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 955         |
|    ep_rew_mean          | -43.1       |
| time/                   |             |
|    fps                  | 19          |
|    iterations           | 133         |
|    time_elapsed         | 3422        |
|    total_timesteps      | 68096       |
| train/                  |             |
|    approx_kl            | 0.039583027 |
|    clip_fraction        | 0.039       |
|    clip_range           | 0.4         |
|    entropy_loss         | -13.6       |
|    explained_variance   | 0.936       |
|    learning_rate        | 3e-05       |
|    loss                 | 0.48        |
|    n_updates            | 2640        |
|    policy_gradient_loss | 0.00425     |
|    std                  | 0.135       |
|    value_loss           | 1.55        |
-----------------------------------------
---------------------------------------
| rollout/                |           |
|    ep_len_mean          | 955       |
|    ep_rew_mean          | -43.1     |
| time/                   |           |
|    fps                  | 19        |
|    iterations           | 134       |
|    time_elapsed         | 3447      |
|    total_timesteps      | 68608     |
| train/                  |           |
|    approx_kl            | 0.7024065 |
|    clip_fraction        | 0.676     |
|    clip_range           | 0.4       |
|    entropy_loss         | -14.6     |
|    explained_variance   | 0.729     |
|    learning_rate        | 3e-05     |
|    loss                 | 2.79      |
|    n_updates            | 2660      |
|    policy_gradient_loss | 0.176     |
|    std                  | 0.135     |
|    value_loss           | 13.4      |
---------------------------------------
Track generation: 1099..1378 -&gt; 279-tiles track
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 956         |
|    ep_rew_mean          | -42.8       |
| time/                   |             |
|    fps                  | 19          |
|    iterations           | 135         |
|    time_elapsed         | 3472        |
|    total_timesteps      | 69120       |
| train/                  |             |
|    approx_kl            | 0.023896258 |
|    clip_fraction        | 0.0198      |
|    clip_range           | 0.4         |
|    entropy_loss         | -14.9       |
|    explained_variance   | 0.872       |
|    learning_rate        | 3e-05       |
|    loss                 | 0.931       |
|    n_updates            | 2680        |
|    policy_gradient_loss | -0.0298     |
|    std                  | 0.135       |
|    value_loss           | 3.3         |
-----------------------------------------
------------------------------------------
| rollout/                |              |
|    ep_len_mean          | 956          |
|    ep_rew_mean          | -42.8        |
| time/                   |              |
|    fps                  | 19           |
|    iterations           | 136          |
|    time_elapsed         | 3497         |
|    total_timesteps      | 69632        |
| train/                  |              |
|    approx_kl            | 0.0046649473 |
|    clip_fraction        | 0            |
|    clip_range           | 0.4          |
|    entropy_loss         | -14.9        |
|    explained_variance   | 0.889        |
|    learning_rate        | 3e-05        |
|    loss                 | 0.945        |
|    n_updates            | 2700         |
|    policy_gradient_loss | -0.000288    |
|    std                  | 0.135        |
|    value_loss           | 2.45         |
------------------------------------------
Track generation: 1179..1478 -&gt; 299-tiles track
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 956         |
|    ep_rew_mean          | -42.9       |
| time/                   |             |
|    fps                  | 19          |
|    iterations           | 137         |
|    time_elapsed         | 3522        |
|    total_timesteps      | 70144       |
| train/                  |             |
|    approx_kl            | 0.003953414 |
|    clip_fraction        | 0.00635     |
|    clip_range           | 0.4         |
|    entropy_loss         | -14.9       |
|    explained_variance   | 0.799       |
|    learning_rate        | 3e-05       |
|    loss                 | 0.389       |
|    n_updates            | 2720        |
|    policy_gradient_loss | 0.00207     |
|    std                  | 0.135       |
|    value_loss           | 1.13        |
-----------------------------------------
----------------------------------------
| rollout/                |            |
|    ep_len_mean          | 956        |
|    ep_rew_mean          | -42.9      |
| time/                   |            |
|    fps                  | 19         |
|    iterations           | 138        |
|    time_elapsed         | 3547       |
|    total_timesteps      | 70656      |
| train/                  |            |
|    approx_kl            | 0.07147819 |
|    clip_fraction        | 0.0798     |
|    clip_range           | 0.4        |
|    entropy_loss         | -14.8      |
|    explained_variance   | 0.77       |
|    learning_rate        | 3e-05      |
|    loss                 | 2.11       |
|    n_updates            | 2740       |
|    policy_gradient_loss | -0.00296   |
|    std                  | 0.135      |
|    value_loss           | 4.15       |
----------------------------------------
Track generation: 1107..1388 -&gt; 281-tiles track
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 957         |
|    ep_rew_mean          | -42.9       |
| time/                   |             |
|    fps                  | 19          |
|    iterations           | 139         |
|    time_elapsed         | 3572        |
|    total_timesteps      | 71168       |
| train/                  |             |
|    approx_kl            | 0.014048942 |
|    clip_fraction        | 0.00107     |
|    clip_range           | 0.4         |
|    entropy_loss         | -14.6       |
|    explained_variance   | 0.636       |
|    learning_rate        | 3e-05       |
|    loss                 | 0.506       |
|    n_updates            | 2760        |
|    policy_gradient_loss | -0.0119     |
|    std                  | 0.135       |
|    value_loss           | 2.42        |
-----------------------------------------
Track generation: 1209..1519 -&gt; 310-tiles track
retry to generate track (normal if there are not manyinstances of this message)
Track generation: 1233..1544 -&gt; 311-tiles track
retry to generate track (normal if there are not manyinstances of this message)
Track generation: 1234..1555 -&gt; 321-tiles track
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 952         |
|    ep_rew_mean          | -44.1       |
| time/                   |             |
|    fps                  | 19          |
|    iterations           | 140         |
|    time_elapsed         | 3597        |
|    total_timesteps      | 71680       |
| train/                  |             |
|    approx_kl            | 0.009390207 |
|    clip_fraction        | 0.000586    |
|    clip_range           | 0.4         |
|    entropy_loss         | -14.6       |
|    explained_variance   | 0.924       |
|    learning_rate        | 3e-05       |
|    loss                 | 0.12        |
|    n_updates            | 2780        |
|    policy_gradient_loss | -0.0105     |
|    std                  | 0.135       |
|    value_loss           | 1.06        |
-----------------------------------------
---------------------------------------
| rollout/                |           |
|    ep_len_mean          | 952       |
|    ep_rew_mean          | -44.1     |
| time/                   |           |
|    fps                  | 19        |
|    iterations           | 141       |
|    time_elapsed         | 3622      |
|    total_timesteps      | 72192     |
| train/                  |           |
|    approx_kl            | 0.3277676 |
|    clip_fraction        | 0.53      |
|    clip_range           | 0.4       |
|    entropy_loss         | -15.2     |
|    explained_variance   | 0.853     |
|    learning_rate        | 3e-05     |
|    loss                 | 2.5       |
|    n_updates            | 2800      |
|    policy_gradient_loss | -0.0156   |
|    std                  | 0.135     |
|    value_loss           | 10.7      |
---------------------------------------
Track generation: 1232..1553 -&gt; 321-tiles track
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 952         |
|    ep_rew_mean          | -44.6       |
| time/                   |             |
|    fps                  | 19          |
|    iterations           | 142         |
|    time_elapsed         | 3647        |
|    total_timesteps      | 72704       |
| train/                  |             |
|    approx_kl            | 0.022476463 |
|    clip_fraction        | 0.004       |
|    clip_range           | 0.4         |
|    entropy_loss         | -15.3       |
|    explained_variance   | -0.253      |
|    learning_rate        | 3e-05       |
|    loss                 | 2.24        |
|    n_updates            | 2820        |
|    policy_gradient_loss | -0.0185     |
|    std                  | 0.135       |
|    value_loss           | 1.13        |
-----------------------------------------
------------------------------------------
| rollout/                |              |
|    ep_len_mean          | 952          |
|    ep_rew_mean          | -44.6        |
| time/                   |              |
|    fps                  | 19           |
|    iterations           | 143          |
|    time_elapsed         | 3672         |
|    total_timesteps      | 73216        |
| train/                  |              |
|    approx_kl            | 0.0005632242 |
|    clip_fraction        | 0            |
|    clip_range           | 0.4          |
|    entropy_loss         | -15.2        |
|    explained_variance   | 0.921        |
|    learning_rate        | 3e-05        |
|    loss                 | 0.493        |
|    n_updates            | 2840         |
|    policy_gradient_loss | -0.00149     |
|    std                  | 0.135        |
|    value_loss           | 1.25         |
------------------------------------------
Track generation: 1214..1522 -&gt; 308-tiles track
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 953         |
|    ep_rew_mean          | -44.2       |
| time/                   |             |
|    fps                  | 19          |
|    iterations           | 144         |
|    time_elapsed         | 3698        |
|    total_timesteps      | 73728       |
| train/                  |             |
|    approx_kl            | 0.019523615 |
|    clip_fraction        | 0.0144      |
|    clip_range           | 0.4         |
|    entropy_loss         | -15.1       |
|    explained_variance   | 0.85        |
|    learning_rate        | 3e-05       |
|    loss                 | 1.58        |
|    n_updates            | 2860        |
|    policy_gradient_loss | -0.0101     |
|    std                  | 0.135       |
|    value_loss           | 4.03        |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 953         |
|    ep_rew_mean          | -44.2       |
| time/                   |             |
|    fps                  | 19          |
|    iterations           | 145         |
|    time_elapsed         | 3723        |
|    total_timesteps      | 74240       |
| train/                  |             |
|    approx_kl            | 0.005560814 |
|    clip_fraction        | 0           |
|    clip_range           | 0.4         |
|    entropy_loss         | -15         |
|    explained_variance   | 0.849       |
|    learning_rate        | 3e-05       |
|    loss                 | 0.762       |
|    n_updates            | 2880        |
|    policy_gradient_loss | -0.00251    |
|    std                  | 0.135       |
|    value_loss           | 2.9         |
-----------------------------------------
Track generation: 1151..1450 -&gt; 299-tiles track
------------------------------------------
| rollout/                |              |
|    ep_len_mean          | 953          |
|    ep_rew_mean          | -44.5        |
| time/                   |              |
|    fps                  | 19           |
|    iterations           | 146          |
|    time_elapsed         | 3749         |
|    total_timesteps      | 74752        |
| train/                  |              |
|    approx_kl            | 0.0058997874 |
|    clip_fraction        | 0.00635      |
|    clip_range           | 0.4          |
|    entropy_loss         | -15          |
|    explained_variance   | 0.29         |
|    learning_rate        | 3e-05        |
|    loss                 | 0.639        |
|    n_updates            | 2900         |
|    policy_gradient_loss | -0.00521     |
|    std                  | 0.135        |
|    value_loss           | 2.33         |
------------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 953         |
|    ep_rew_mean          | -44.5       |
| time/                   |             |
|    fps                  | 19          |
|    iterations           | 147         |
|    time_elapsed         | 3774        |
|    total_timesteps      | 75264       |
| train/                  |             |
|    approx_kl            | 0.016611345 |
|    clip_fraction        | 0.018       |
|    clip_range           | 0.4         |
|    entropy_loss         | -14.9       |
|    explained_variance   | 0.704       |
|    learning_rate        | 3e-05       |
|    loss                 | 0.918       |
|    n_updates            | 2920        |
|    policy_gradient_loss | -0.00613    |
|    std                  | 0.135       |
|    value_loss           | 3.46        |
-----------------------------------------
Track generation: 1213..1529 -&gt; 316-tiles track
----------------------------------------
| rollout/                |            |
|    ep_len_mean          | 954        |
|    ep_rew_mean          | -43.3      |
| time/                   |            |
|    fps                  | 19         |
|    iterations           | 148        |
|    time_elapsed         | 3801       |
|    total_timesteps      | 75776      |
| train/                  |            |
|    approx_kl            | 0.03168477 |
|    clip_fraction        | 0.0424     |
|    clip_range           | 0.4        |
|    entropy_loss         | -14.9      |
|    explained_variance   | 0.776      |
|    learning_rate        | 3e-05      |
|    loss                 | 0.764      |
|    n_updates            | 2940       |
|    policy_gradient_loss | -0.0227    |
|    std                  | 0.135      |
|    value_loss           | 2.53       |
----------------------------------------
------------------------------------------
| rollout/                |              |
|    ep_len_mean          | 954          |
|    ep_rew_mean          | -43.3        |
| time/                   |              |
|    fps                  | 19           |
|    iterations           | 149          |
|    time_elapsed         | 3825         |
|    total_timesteps      | 76288        |
| train/                  |              |
|    approx_kl            | 0.0016601707 |
|    clip_fraction        | 0            |
|    clip_range           | 0.4          |
|    entropy_loss         | -14.9        |
|    explained_variance   | 0.7          |
|    learning_rate        | 3e-05        |
|    loss                 | 1.97         |
|    n_updates            | 2960         |
|    policy_gradient_loss | -0.0028      |
|    std                  | 0.135        |
|    value_loss           | 6.05         |
------------------------------------------
Track generation: 1252..1569 -&gt; 317-tiles track
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 955         |
|    ep_rew_mean          | -42.7       |
| time/                   |             |
|    fps                  | 19          |
|    iterations           | 150         |
|    time_elapsed         | 3851        |
|    total_timesteps      | 76800       |
| train/                  |             |
|    approx_kl            | 0.014771901 |
|    clip_fraction        | 0.00244     |
|    clip_range           | 0.4         |
|    entropy_loss         | -14.9       |
|    explained_variance   | 0.665       |
|    learning_rate        | 3e-05       |
|    loss                 | 1.78        |
|    n_updates            | 2980        |
|    policy_gradient_loss | -0.00718    |
|    std                  | 0.135       |
|    value_loss           | 4.23        |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 955         |
|    ep_rew_mean          | -42.7       |
| time/                   |             |
|    fps                  | 19          |
|    iterations           | 151         |
|    time_elapsed         | 3875        |
|    total_timesteps      | 77312       |
| train/                  |             |
|    approx_kl            | 0.019806303 |
|    clip_fraction        | 0.0306      |
|    clip_range           | 0.4         |
|    entropy_loss         | -14.7       |
|    explained_variance   | 0.651       |
|    learning_rate        | 3e-05       |
|    loss                 | 1.32        |
|    n_updates            | 3000        |
|    policy_gradient_loss | 0.00975     |
|    std                  | 0.135       |
|    value_loss           | 3.52        |
-----------------------------------------
Track generation: 1040..1304 -&gt; 264-tiles track
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 955         |
|    ep_rew_mean          | -42.4       |
| time/                   |             |
|    fps                  | 19          |
|    iterations           | 152         |
|    time_elapsed         | 3900        |
|    total_timesteps      | 77824       |
| train/                  |             |
|    approx_kl            | 0.005285417 |
|    clip_fraction        | 0           |
|    clip_range           | 0.4         |
|    entropy_loss         | -14.7       |
|    explained_variance   | 0.709       |
|    learning_rate        | 3e-05       |
|    loss                 | 0.986       |
|    n_updates            | 3020        |
|    policy_gradient_loss | -0.00296    |
|    std                  | 0.135       |
|    value_loss           | 2.73        |
-----------------------------------------
----------------------------------------
| rollout/                |            |
|    ep_len_mean          | 955        |
|    ep_rew_mean          | -42.4      |
| time/                   |            |
|    fps                  | 19         |
|    iterations           | 153        |
|    time_elapsed         | 3924       |
|    total_timesteps      | 78336      |
| train/                  |            |
|    approx_kl            | 0.06295839 |
|    clip_fraction        | 0.101      |
|    clip_range           | 0.4        |
|    entropy_loss         | -14.5      |
|    explained_variance   | 0.626      |
|    learning_rate        | 3e-05      |
|    loss                 | 0.322      |
|    n_updates            | 3040       |
|    policy_gradient_loss | -0.0285    |
|    std                  | 0.135      |
|    value_loss           | 1.21       |
----------------------------------------
Track generation: 1128..1414 -&gt; 286-tiles track
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 956         |
|    ep_rew_mean          | -42.8       |
| time/                   |             |
|    fps                  | 19          |
|    iterations           | 154         |
|    time_elapsed         | 3949        |
|    total_timesteps      | 78848       |
| train/                  |             |
|    approx_kl            | 0.012320796 |
|    clip_fraction        | 0.000879    |
|    clip_range           | 0.4         |
|    entropy_loss         | -14.5       |
|    explained_variance   | 0.101       |
|    learning_rate        | 3e-05       |
|    loss                 | -0.000889   |
|    n_updates            | 3060        |
|    policy_gradient_loss | -0.00363    |
|    std                  | 0.135       |
|    value_loss           | 0.809       |
-----------------------------------------
------------------------------------------
| rollout/                |              |
|    ep_len_mean          | 956          |
|    ep_rew_mean          | -42.8        |
| time/                   |              |
|    fps                  | 19           |
|    iterations           | 155          |
|    time_elapsed         | 3973         |
|    total_timesteps      | 79360        |
| train/                  |              |
|    approx_kl            | 0.0065420438 |
|    clip_fraction        | 0            |
|    clip_range           | 0.4          |
|    entropy_loss         | -14.4        |
|    explained_variance   | 0.842        |
|    learning_rate        | 3e-05        |
|    loss                 | 0.217        |
|    n_updates            | 3080         |
|    policy_gradient_loss | -0.011       |
|    std                  | 0.135        |
|    value_loss           | 1.6          |
------------------------------------------
Track generation: 1121..1408 -&gt; 287-tiles track
retry to generate track (normal if there are not manyinstances of this message)
Track generation: 1048..1319 -&gt; 271-tiles track
----------------------------------------
| rollout/                |            |
|    ep_len_mean          | 956        |
|    ep_rew_mean          | -43.2      |
| time/                   |            |
|    fps                  | 19         |
|    iterations           | 156        |
|    time_elapsed         | 3998       |
|    total_timesteps      | 79872      |
| train/                  |            |
|    approx_kl            | 0.02490234 |
|    clip_fraction        | 0.014      |
|    clip_range           | 0.4        |
|    entropy_loss         | -14.3      |
|    explained_variance   | 0.514      |
|    learning_rate        | 3e-05      |
|    loss                 | 0.548      |
|    n_updates            | 3100       |
|    policy_gradient_loss | -0.0128    |
|    std                  | 0.135      |
|    value_loss           | 2.01       |
----------------------------------------
Track generation: 1224..1534 -&gt; 310-tiles track
----------------------------------------
| rollout/                |            |
|    ep_len_mean          | 957        |
|    ep_rew_mean          | -43.1      |
| time/                   |            |
|    fps                  | 19         |
|    iterations           | 157        |
|    time_elapsed         | 4022       |
|    total_timesteps      | 80384      |
| train/                  |            |
|    approx_kl            | 0.02812032 |
|    clip_fraction        | 0.0108     |
|    clip_range           | 0.4        |
|    entropy_loss         | -14.1      |
|    explained_variance   | 0.438      |
|    learning_rate        | 3e-05      |
|    loss                 | 2.2        |
|    n_updates            | 3120       |
|    policy_gradient_loss | -0.0127    |
|    std                  | 0.135      |
|    value_loss           | 5.39       |
----------------------------------------
------------------------------------------
| rollout/                |              |
|    ep_len_mean          | 957          |
|    ep_rew_mean          | -43.1        |
| time/                   |              |
|    fps                  | 19           |
|    iterations           | 158          |
|    time_elapsed         | 4047         |
|    total_timesteps      | 80896        |
| train/                  |              |
|    approx_kl            | 0.0043753735 |
|    clip_fraction        | 0            |
|    clip_range           | 0.4          |
|    entropy_loss         | -14.1        |
|    explained_variance   | 0.699        |
|    learning_rate        | 3e-05        |
|    loss                 | 0.4          |
|    n_updates            | 3140         |
|    policy_gradient_loss | -0.00633     |
|    std                  | 0.135        |
|    value_loss           | 0.707        |
------------------------------------------
Track generation: 1140..1429 -&gt; 289-tiles track
----------------------------------------
| rollout/                |            |
|    ep_len_mean          | 957        |
|    ep_rew_mean          | -43        |
| time/                   |            |
|    fps                  | 19         |
|    iterations           | 159        |
|    time_elapsed         | 4072       |
|    total_timesteps      | 81408      |
| train/                  |            |
|    approx_kl            | 0.04373166 |
|    clip_fraction        | 0.0559     |
|    clip_range           | 0.4        |
|    entropy_loss         | -13.9      |
|    explained_variance   | 0.671      |
|    learning_rate        | 3e-05      |
|    loss                 | 0.757      |
|    n_updates            | 3160       |
|    policy_gradient_loss | -0.0181    |
|    std                  | 0.135      |
|    value_loss           | 2.42       |
----------------------------------------
Track generation: 1114..1400 -&gt; 286-tiles track
retry to generate track (normal if there are not manyinstances of this message)
Track generation: 1052..1319 -&gt; 267-tiles track
----------------------------------------
| rollout/                |            |
|    ep_len_mean          | 951        |
|    ep_rew_mean          | -43.6      |
| time/                   |            |
|    fps                  | 19         |
|    iterations           | 160        |
|    time_elapsed         | 4097       |
|    total_timesteps      | 81920      |
| train/                  |            |
|    approx_kl            | 0.01651144 |
|    clip_fraction        | 0.0251     |
|    clip_range           | 0.4        |
|    entropy_loss         | -13.9      |
|    explained_variance   | 0.835      |
|    learning_rate        | 3e-05      |
|    loss                 | 0.431      |
|    n_updates            | 3180       |
|    policy_gradient_loss | 0.00575    |
|    std                  | 0.135      |
|    value_loss           | 1.33       |
----------------------------------------
----------------------------------------
| rollout/                |            |
|    ep_len_mean          | 951        |
|    ep_rew_mean          | -43.6      |
| time/                   |            |
|    fps                  | 20         |
|    iterations           | 161        |
|    time_elapsed         | 4121       |
|    total_timesteps      | 82432      |
| train/                  |            |
|    approx_kl            | 0.25089228 |
|    clip_fraction        | 0.503      |
|    clip_range           | 0.4        |
|    entropy_loss         | -14.6      |
|    explained_variance   | 0.771      |
|    learning_rate        | 3e-05      |
|    loss                 | 6.68       |
|    n_updates            | 3200       |
|    policy_gradient_loss | 0.0244     |
|    std                  | 0.135      |
|    value_loss           | 19.8       |
----------------------------------------
Track generation: 1045..1313 -&gt; 268-tiles track
retry to generate track (normal if there are not manyinstances of this message)
Track generation: 1131..1418 -&gt; 287-tiles track
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 952         |
|    ep_rew_mean          | -43.6       |
| time/                   |             |
|    fps                  | 20          |
|    iterations           | 162         |
|    time_elapsed         | 4146        |
|    total_timesteps      | 82944       |
| train/                  |             |
|    approx_kl            | 0.019185081 |
|    clip_fraction        | 0.00254     |
|    clip_range           | 0.4         |
|    entropy_loss         | -14.7       |
|    explained_variance   | 0.757       |
|    learning_rate        | 3e-05       |
|    loss                 | 0.272       |
|    n_updates            | 3220        |
|    policy_gradient_loss | -0.0132     |
|    std                  | 0.135       |
|    value_loss           | 1.81        |
-----------------------------------------
----------------------------------------
| rollout/                |            |
|    ep_len_mean          | 952        |
|    ep_rew_mean          | -43.6      |
| time/                   |            |
|    fps                  | 20         |
|    iterations           | 163        |
|    time_elapsed         | 4170       |
|    total_timesteps      | 83456      |
| train/                  |            |
|    approx_kl            | 0.09484756 |
|    clip_fraction        | 0.148      |
|    clip_range           | 0.4        |
|    entropy_loss         | -14.5      |
|    explained_variance   | 0.885      |
|    learning_rate        | 3e-05      |
|    loss                 | 0.434      |
|    n_updates            | 3240       |
|    policy_gradient_loss | -0.0298    |
|    std                  | 0.135      |
|    value_loss           | 1.61       |
----------------------------------------
Track generation: 1122..1412 -&gt; 290-tiles track
------------------------------------------
| rollout/                |              |
|    ep_len_mean          | 953          |
|    ep_rew_mean          | -43.5        |
| time/                   |              |
|    fps                  | 20           |
|    iterations           | 164          |
|    time_elapsed         | 4195         |
|    total_timesteps      | 83968        |
| train/                  |              |
|    approx_kl            | 0.0141685195 |
|    clip_fraction        | 0.0184       |
|    clip_range           | 0.4          |
|    entropy_loss         | -14.4        |
|    explained_variance   | 0.576        |
|    learning_rate        | 3e-05        |
|    loss                 | 2.04         |
|    n_updates            | 3260         |
|    policy_gradient_loss | -0.0114      |
|    std                  | 0.135        |
|    value_loss           | 3.52         |
------------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 953         |
|    ep_rew_mean          | -43.5       |
| time/                   |             |
|    fps                  | 20          |
|    iterations           | 165         |
|    time_elapsed         | 4220        |
|    total_timesteps      | 84480       |
| train/                  |             |
|    approx_kl            | 0.039604917 |
|    clip_fraction        | 0.0586      |
|    clip_range           | 0.4         |
|    entropy_loss         | -14.3       |
|    explained_variance   | 0.681       |
|    learning_rate        | 3e-05       |
|    loss                 | 0.876       |
|    n_updates            | 3280        |
|    policy_gradient_loss | 0.00666     |
|    std                  | 0.135       |
|    value_loss           | 3.52        |
-----------------------------------------
Track generation: 1239..1553 -&gt; 314-tiles track
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 953         |
|    ep_rew_mean          | -43.2       |
| time/                   |             |
|    fps                  | 20          |
|    iterations           | 166         |
|    time_elapsed         | 4245        |
|    total_timesteps      | 84992       |
| train/                  |             |
|    approx_kl            | 0.017838817 |
|    clip_fraction        | 0.00322     |
|    clip_range           | 0.4         |
|    entropy_loss         | -14.2       |
|    explained_variance   | 0.827       |
|    learning_rate        | 3e-05       |
|    loss                 | 1.41        |
|    n_updates            | 3300        |
|    policy_gradient_loss | -0.0136     |
|    std                  | 0.135       |
|    value_loss           | 4.89        |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 953         |
|    ep_rew_mean          | -43.2       |
| time/                   |             |
|    fps                  | 20          |
|    iterations           | 167         |
|    time_elapsed         | 4269        |
|    total_timesteps      | 85504       |
| train/                  |             |
|    approx_kl            | 0.006315175 |
|    clip_fraction        | 0.000391    |
|    clip_range           | 0.4         |
|    entropy_loss         | -14.2       |
|    explained_variance   | 0.806       |
|    learning_rate        | 3e-05       |
|    loss                 | 0.885       |
|    n_updates            | 3320        |
|    policy_gradient_loss | -0.00806    |
|    std                  | 0.135       |
|    value_loss           | 2.81        |
-----------------------------------------
Track generation: 1022..1283 -&gt; 261-tiles track
retry to generate track (normal if there are not manyinstances of this message)
Track generation: 1123..1408 -&gt; 285-tiles track
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 954         |
|    ep_rew_mean          | -43.4       |
| time/                   |             |
|    fps                  | 20          |
|    iterations           | 168         |
|    time_elapsed         | 4294        |
|    total_timesteps      | 86016       |
| train/                  |             |
|    approx_kl            | 0.049577672 |
|    clip_fraction        | 0.0563      |
|    clip_range           | 0.4         |
|    entropy_loss         | -14.3       |
|    explained_variance   | 0.895       |
|    learning_rate        | 3e-05       |
|    loss                 | 0.757       |
|    n_updates            | 3340        |
|    policy_gradient_loss | -0.0383     |
|    std                  | 0.135       |
|    value_loss           | 1.15        |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 954         |
|    ep_rew_mean          | -43.4       |
| time/                   |             |
|    fps                  | 20          |
|    iterations           | 169         |
|    time_elapsed         | 4317        |
|    total_timesteps      | 86528       |
| train/                  |             |
|    approx_kl            | 0.012918612 |
|    clip_fraction        | 0.00117     |
|    clip_range           | 0.4         |
|    entropy_loss         | -14.3       |
|    explained_variance   | 0.857       |
|    learning_rate        | 3e-05       |
|    loss                 | 0.897       |
|    n_updates            | 3360        |
|    policy_gradient_loss | -0.0109     |
|    std                  | 0.135       |
|    value_loss           | 2.57        |
-----------------------------------------
Track generation: 1158..1462 -&gt; 304-tiles track
----------------------------------------
| rollout/                |            |
|    ep_len_mean          | 954        |
|    ep_rew_mean          | -43.5      |
| time/                   |            |
|    fps                  | 20         |
|    iterations           | 170        |
|    time_elapsed         | 4342       |
|    total_timesteps      | 87040      |
| train/                  |            |
|    approx_kl            | 0.02535508 |
|    clip_fraction        | 0.0423     |
|    clip_range           | 0.4        |
|    entropy_loss         | -14.4      |
|    explained_variance   | 0.657      |
|    learning_rate        | 3e-05      |
|    loss                 | 0.654      |
|    n_updates            | 3380       |
|    policy_gradient_loss | -0.0176    |
|    std                  | 0.135      |
|    value_loss           | 4.41       |
----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 954         |
|    ep_rew_mean          | -43.5       |
| time/                   |             |
|    fps                  | 20          |
|    iterations           | 171         |
|    time_elapsed         | 4366        |
|    total_timesteps      | 87552       |
| train/                  |             |
|    approx_kl            | 0.011895588 |
|    clip_fraction        | 0.0142      |
|    clip_range           | 0.4         |
|    entropy_loss         | -14.5       |
|    explained_variance   | 0.626       |
|    learning_rate        | 3e-05       |
|    loss                 | 0.586       |
|    n_updates            | 3400        |
|    policy_gradient_loss | -0.00338    |
|    std                  | 0.135       |
|    value_loss           | 1.48        |
-----------------------------------------
Track generation: 1313..1645 -&gt; 332-tiles track
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 955         |
|    ep_rew_mean          | -43.6       |
| time/                   |             |
|    fps                  | 20          |
|    iterations           | 172         |
|    time_elapsed         | 4391        |
|    total_timesteps      | 88064       |
| train/                  |             |
|    approx_kl            | 0.008688881 |
|    clip_fraction        | 0.0161      |
|    clip_range           | 0.4         |
|    entropy_loss         | -14.3       |
|    explained_variance   | 0.351       |
|    learning_rate        | 3e-05       |
|    loss                 | 1.3         |
|    n_updates            | 3420        |
|    policy_gradient_loss | -0.00353    |
|    std                  | 0.135       |
|    value_loss           | 2.91        |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 955         |
|    ep_rew_mean          | -43.6       |
| time/                   |             |
|    fps                  | 20          |
|    iterations           | 173         |
|    time_elapsed         | 4416        |
|    total_timesteps      | 88576       |
| train/                  |             |
|    approx_kl            | 0.059846487 |
|    clip_fraction        | 0.0616      |
|    clip_range           | 0.4         |
|    entropy_loss         | -14.2       |
|    explained_variance   | 0.685       |
|    learning_rate        | 3e-05       |
|    loss                 | 0.475       |
|    n_updates            | 3440        |
|    policy_gradient_loss | -0.00579    |
|    std                  | 0.135       |
|    value_loss           | 3.17        |
-----------------------------------------
Track generation: 1000..1254 -&gt; 254-tiles track
----------------------------------------
| rollout/                |            |
|    ep_len_mean          | 955        |
|    ep_rew_mean          | -43.5      |
| time/                   |            |
|    fps                  | 20         |
|    iterations           | 174        |
|    time_elapsed         | 4440       |
|    total_timesteps      | 89088      |
| train/                  |            |
|    approx_kl            | 0.05954627 |
|    clip_fraction        | 0.0592     |
|    clip_range           | 0.4        |
|    entropy_loss         | -14        |
|    explained_variance   | 0.293      |
|    learning_rate        | 3e-05      |
|    loss                 | 0.239      |
|    n_updates            | 3460       |
|    policy_gradient_loss | -0.00407   |
|    std                  | 0.135      |
|    value_loss           | 0.444      |
----------------------------------------
----------------------------------------
| rollout/                |            |
|    ep_len_mean          | 955        |
|    ep_rew_mean          | -43.5      |
| time/                   |            |
|    fps                  | 20         |
|    iterations           | 175        |
|    time_elapsed         | 4464       |
|    total_timesteps      | 89600      |
| train/                  |            |
|    approx_kl            | 0.07992813 |
|    clip_fraction        | 0.108      |
|    clip_range           | 0.4        |
|    entropy_loss         | -13.8      |
|    explained_variance   | 0.721      |
|    learning_rate        | 3e-05      |
|    loss                 | 0.57       |
|    n_updates            | 3480       |
|    policy_gradient_loss | -0.0374    |
|    std                  | 0.135      |
|    value_loss           | 2.8        |
----------------------------------------
Track generation: 1259..1578 -&gt; 319-tiles track
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 956         |
|    ep_rew_mean          | -43.8       |
| time/                   |             |
|    fps                  | 20          |
|    iterations           | 176         |
|    time_elapsed         | 4489        |
|    total_timesteps      | 90112       |
| train/                  |             |
|    approx_kl            | 0.047437537 |
|    clip_fraction        | 0.0626      |
|    clip_range           | 0.4         |
|    entropy_loss         | -13.9       |
|    explained_variance   | 0.346       |
|    learning_rate        | 3e-05       |
|    loss                 | 0.0688      |
|    n_updates            | 3500        |
|    policy_gradient_loss | -0.0108     |
|    std                  | 0.135       |
|    value_loss           | 0.19        |
-----------------------------------------
----------------------------------------
| rollout/                |            |
|    ep_len_mean          | 956        |
|    ep_rew_mean          | -43.8      |
| time/                   |            |
|    fps                  | 20         |
|    iterations           | 177        |
|    time_elapsed         | 4514       |
|    total_timesteps      | 90624      |
| train/                  |            |
|    approx_kl            | 0.10462939 |
|    clip_fraction        | 0.127      |
|    clip_range           | 0.4        |
|    entropy_loss         | -13.7      |
|    explained_variance   | 0.941      |
|    learning_rate        | 3e-05      |
|    loss                 | 0.739      |
|    n_updates            | 3520       |
|    policy_gradient_loss | -0.0144    |
|    std                  | 0.135      |
|    value_loss           | 0.378      |
----------------------------------------
Track generation: 1316..1655 -&gt; 339-tiles track
----------------------------------------
| rollout/                |            |
|    ep_len_mean          | 956        |
|    ep_rew_mean          | -44.2      |
| time/                   |            |
|    fps                  | 20         |
|    iterations           | 178        |
|    time_elapsed         | 4540       |
|    total_timesteps      | 91136      |
| train/                  |            |
|    approx_kl            | 0.02271733 |
|    clip_fraction        | 0.0402     |
|    clip_range           | 0.4        |
|    entropy_loss         | -13.5      |
|    explained_variance   | -0.192     |
|    learning_rate        | 3e-05      |
|    loss                 | 0.205      |
|    n_updates            | 3540       |
|    policy_gradient_loss | -0.00916   |
|    std                  | 0.135      |
|    value_loss           | 0.359      |
----------------------------------------
------------------------------------------
| rollout/                |              |
|    ep_len_mean          | 956          |
|    ep_rew_mean          | -44.2        |
| time/                   |              |
|    fps                  | 20           |
|    iterations           | 179          |
|    time_elapsed         | 4564         |
|    total_timesteps      | 91648        |
| train/                  |              |
|    approx_kl            | 0.0057170587 |
|    clip_fraction        | 0.00811      |
|    clip_range           | 0.4          |
|    entropy_loss         | -13.4        |
|    explained_variance   | 0.717        |
|    learning_rate        | 3e-05        |
|    loss                 | 1.4          |
|    n_updates            | 3560         |
|    policy_gradient_loss | -0.00721     |
|    std                  | 0.135        |
|    value_loss           | 1.11         |
------------------------------------------
Track generation: 1086..1367 -&gt; 281-tiles track
----------------------------------------
| rollout/                |            |
|    ep_len_mean          | 956        |
|    ep_rew_mean          | -44.6      |
| time/                   |            |
|    fps                  | 20         |
|    iterations           | 180        |
|    time_elapsed         | 4590       |
|    total_timesteps      | 92160      |
| train/                  |            |
|    approx_kl            | 0.08623465 |
|    clip_fraction        | 0.206      |
|    clip_range           | 0.4        |
|    entropy_loss         | -13.5      |
|    explained_variance   | -0.0636    |
|    learning_rate        | 3e-05      |
|    loss                 | 0.0233     |
|    n_updates            | 3580       |
|    policy_gradient_loss | -0.0491    |
|    std                  | 0.135      |
|    value_loss           | 0.576      |
----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 956         |
|    ep_rew_mean          | -44.6       |
| time/                   |             |
|    fps                  | 20          |
|    iterations           | 181         |
|    time_elapsed         | 4615        |
|    total_timesteps      | 92672       |
| train/                  |             |
|    approx_kl            | 0.050894216 |
|    clip_fraction        | 0.0461      |
|    clip_range           | 0.4         |
|    entropy_loss         | -13.5       |
|    explained_variance   | 0.66        |
|    learning_rate        | 3e-05       |
|    loss                 | 0.669       |
|    n_updates            | 3600        |
|    policy_gradient_loss | -0.0206     |
|    std                  | 0.135       |
|    value_loss           | 1.51        |
-----------------------------------------
Track generation: 988..1238 -&gt; 250-tiles track
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 957         |
|    ep_rew_mean          | -44.7       |
| time/                   |             |
|    fps                  | 20          |
|    iterations           | 182         |
|    time_elapsed         | 4640        |
|    total_timesteps      | 93184       |
| train/                  |             |
|    approx_kl            | 0.003883313 |
|    clip_fraction        | 0           |
|    clip_range           | 0.4         |
|    entropy_loss         | -13.7       |
|    explained_variance   | 0.605       |
|    learning_rate        | 3e-05       |
|    loss                 | 0.168       |
|    n_updates            | 3620        |
|    policy_gradient_loss | -0.00533    |
|    std                  | 0.135       |
|    value_loss           | 1.2         |
-----------------------------------------
----------------------------------------
| rollout/                |            |
|    ep_len_mean          | 957        |
|    ep_rew_mean          | -44.7      |
| time/                   |            |
|    fps                  | 20         |
|    iterations           | 183        |
|    time_elapsed         | 4665       |
|    total_timesteps      | 93696      |
| train/                  |            |
|    approx_kl            | 0.07486484 |
|    clip_fraction        | 0.124      |
|    clip_range           | 0.4        |
|    entropy_loss         | -13.5      |
|    explained_variance   | 0.833      |
|    learning_rate        | 3e-05      |
|    loss                 | 0.364      |
|    n_updates            | 3640       |
|    policy_gradient_loss | -0.0296    |
|    std                  | 0.135      |
|    value_loss           | 0.945      |
----------------------------------------
Track generation: 1072..1344 -&gt; 272-tiles track
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 957         |
|    ep_rew_mean          | -44.7       |
| time/                   |             |
|    fps                  | 20          |
|    iterations           | 184         |
|    time_elapsed         | 4691        |
|    total_timesteps      | 94208       |
| train/                  |             |
|    approx_kl            | 0.011600345 |
|    clip_fraction        | 0.00371     |
|    clip_range           | 0.4         |
|    entropy_loss         | -13.5       |
|    explained_variance   | 0.695       |
|    learning_rate        | 3e-05       |
|    loss                 | 0.216       |
|    n_updates            | 3660        |
|    policy_gradient_loss | -0.0115     |
|    std                  | 0.135       |
|    value_loss           | 2.21        |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 957         |
|    ep_rew_mean          | -44.7       |
| time/                   |             |
|    fps                  | 20          |
|    iterations           | 185         |
|    time_elapsed         | 4715        |
|    total_timesteps      | 94720       |
| train/                  |             |
|    approx_kl            | 0.054528523 |
|    clip_fraction        | 0.033       |
|    clip_range           | 0.4         |
|    entropy_loss         | -13.4       |
|    explained_variance   | 0.911       |
|    learning_rate        | 3e-05       |
|    loss                 | 0.309       |
|    n_updates            | 3680        |
|    policy_gradient_loss | -0.0175     |
|    std                  | 0.135       |
|    value_loss           | 1.64        |
-----------------------------------------
Track generation: 1152..1444 -&gt; 292-tiles track
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 958         |
|    ep_rew_mean          | -45.1       |
| time/                   |             |
|    fps                  | 20          |
|    iterations           | 186         |
|    time_elapsed         | 4741        |
|    total_timesteps      | 95232       |
| train/                  |             |
|    approx_kl            | 0.013861347 |
|    clip_fraction        | 0.0325      |
|    clip_range           | 0.4         |
|    entropy_loss         | -13.4       |
|    explained_variance   | 0.249       |
|    learning_rate        | 3e-05       |
|    loss                 | 0.3         |
|    n_updates            | 3700        |
|    policy_gradient_loss | -0.0142     |
|    std                  | 0.135       |
|    value_loss           | 0.75        |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 958         |
|    ep_rew_mean          | -45.1       |
| time/                   |             |
|    fps                  | 20          |
|    iterations           | 187         |
|    time_elapsed         | 4765        |
|    total_timesteps      | 95744       |
| train/                  |             |
|    approx_kl            | 0.044410076 |
|    clip_fraction        | 0.0445      |
|    clip_range           | 0.4         |
|    entropy_loss         | -13.3       |
|    explained_variance   | 0.783       |
|    learning_rate        | 3e-05       |
|    loss                 | 1.6         |
|    n_updates            | 3720        |
|    policy_gradient_loss | -0.0172     |
|    std                  | 0.135       |
|    value_loss           | 2.51        |
-----------------------------------------
Track generation: 1066..1341 -&gt; 275-tiles track
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 958         |
|    ep_rew_mean          | -45.2       |
| time/                   |             |
|    fps                  | 20          |
|    iterations           | 188         |
|    time_elapsed         | 4791        |
|    total_timesteps      | 96256       |
| train/                  |             |
|    approx_kl            | 0.052904963 |
|    clip_fraction        | 0.215       |
|    clip_range           | 0.4         |
|    entropy_loss         | -13.2       |
|    explained_variance   | -1.26       |
|    learning_rate        | 3e-05       |
|    loss                 | 0.852       |
|    n_updates            | 3740        |
|    policy_gradient_loss | -0.0432     |
|    std                  | 0.135       |
|    value_loss           | 0.859       |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 958         |
|    ep_rew_mean          | -45.2       |
| time/                   |             |
|    fps                  | 20          |
|    iterations           | 189         |
|    time_elapsed         | 4815        |
|    total_timesteps      | 96768       |
| train/                  |             |
|    approx_kl            | 0.041613795 |
|    clip_fraction        | 0.0329      |
|    clip_range           | 0.4         |
|    entropy_loss         | -13.1       |
|    explained_variance   | 0.457       |
|    learning_rate        | 3e-05       |
|    loss                 | 0.356       |
|    n_updates            | 3760        |
|    policy_gradient_loss | -0.0197     |
|    std                  | 0.135       |
|    value_loss           | 1.28        |
-----------------------------------------
Track generation: 1070..1341 -&gt; 271-tiles track
----------------------------------------
| rollout/                |            |
|    ep_len_mean          | 958        |
|    ep_rew_mean          | -45.5      |
| time/                   |            |
|    fps                  | 20         |
|    iterations           | 190        |
|    time_elapsed         | 4840       |
|    total_timesteps      | 97280      |
| train/                  |            |
|    approx_kl            | 0.04094982 |
|    clip_fraction        | 0.103      |
|    clip_range           | 0.4        |
|    entropy_loss         | -13.1      |
|    explained_variance   | -0.932     |
|    learning_rate        | 3e-05      |
|    loss                 | 0.135      |
|    n_updates            | 3780       |
|    policy_gradient_loss | -0.00755   |
|    std                  | 0.135      |
|    value_loss           | 0.424      |
----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 958         |
|    ep_rew_mean          | -45.5       |
| time/                   |             |
|    fps                  | 20          |
|    iterations           | 191         |
|    time_elapsed         | 4865        |
|    total_timesteps      | 97792       |
| train/                  |             |
|    approx_kl            | 0.047062885 |
|    clip_fraction        | 0.0678      |
|    clip_range           | 0.4         |
|    entropy_loss         | -13.1       |
|    explained_variance   | 0.842       |
|    learning_rate        | 3e-05       |
|    loss                 | 0.149       |
|    n_updates            | 3800        |
|    policy_gradient_loss | -0.0168     |
|    std                  | 0.135       |
|    value_loss           | 0.635       |
-----------------------------------------
Track generation: 1231..1543 -&gt; 312-tiles track
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 962         |
|    ep_rew_mean          | -45.1       |
| time/                   |             |
|    fps                  | 20          |
|    iterations           | 192         |
|    time_elapsed         | 4890        |
|    total_timesteps      | 98304       |
| train/                  |             |
|    approx_kl            | 0.028172683 |
|    clip_fraction        | 0.0614      |
|    clip_range           | 0.4         |
|    entropy_loss         | -13.2       |
|    explained_variance   | -0.122      |
|    learning_rate        | 3e-05       |
|    loss                 | 0.00861     |
|    n_updates            | 3820        |
|    policy_gradient_loss | -0.0115     |
|    std                  | 0.135       |
|    value_loss           | 0.0749      |
-----------------------------------------
----------------------------------------
| rollout/                |            |
|    ep_len_mean          | 962        |
|    ep_rew_mean          | -45.1      |
| time/                   |            |
|    fps                  | 20         |
|    iterations           | 193        |
|    time_elapsed         | 4915       |
|    total_timesteps      | 98816      |
| train/                  |            |
|    approx_kl            | 0.07328672 |
|    clip_fraction        | 0.113      |
|    clip_range           | 0.4        |
|    entropy_loss         | -13.2      |
|    explained_variance   | 0.412      |
|    learning_rate        | 3e-05      |
|    loss                 | 1.39       |
|    n_updates            | 3840       |
|    policy_gradient_loss | -0.0417    |
|    std                  | 0.135      |
|    value_loss           | 3.37       |
----------------------------------------
Track generation: 1168..1464 -&gt; 296-tiles track
----------------------------------------
| rollout/                |            |
|    ep_len_mean          | 962        |
|    ep_rew_mean          | -45.3      |
| time/                   |            |
|    fps                  | 20         |
|    iterations           | 194        |
|    time_elapsed         | 4941       |
|    total_timesteps      | 99328      |
| train/                  |            |
|    approx_kl            | 0.13793005 |
|    clip_fraction        | 0.273      |
|    clip_range           | 0.4        |
|    entropy_loss         | -12.9      |
|    explained_variance   | 0.385      |
|    learning_rate        | 3e-05      |
|    loss                 | 0.268      |
|    n_updates            | 3860       |
|    policy_gradient_loss | -0.0161    |
|    std                  | 0.135      |
|    value_loss           | 0.917      |
----------------------------------------
Track generation: 1020..1279 -&gt; 259-tiles track
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 962         |
|    ep_rew_mean          | -45.4       |
| time/                   |             |
|    fps                  | 20          |
|    iterations           | 195         |
|    time_elapsed         | 4966        |
|    total_timesteps      | 99840       |
| train/                  |             |
|    approx_kl            | 0.040001415 |
|    clip_fraction        | 0.0835      |
|    clip_range           | 0.4         |
|    entropy_loss         | -12.9       |
|    explained_variance   | 0.687       |
|    learning_rate        | 3e-05       |
|    loss                 | 0.143       |
|    n_updates            | 3880        |
|    policy_gradient_loss | -0.0244     |
|    std                  | 0.135       |
|    value_loss           | 1.03        |
-----------------------------------------
Track generation: 1198..1501 -&gt; 303-tiles track
Track generation: 1159..1453 -&gt; 294-tiles track
Track generation: 957..1205 -&gt; 248-tiles track
Track generation: 1181..1480 -&gt; 299-tiles track
Track generation: 979..1234 -&gt; 255-tiles track
Track generation: 1320..1654 -&gt; 334-tiles track
Eval num_timesteps=100000, episode_reward=-81.93 +/- 1.57
Episode length: 1000.00 +/- 0.00
-----------------------------------------
| eval/                   |             |
|    mean_ep_length       | 1e+03       |
|    mean_reward          | -81.9       |
| time/                   |             |
|    total_timesteps      | 100000      |
| train/                  |             |
|    approx_kl            | 0.056796093 |
|    clip_fraction        | 0.196       |
|    clip_range           | 0.4         |
|    entropy_loss         | -12.9       |
|    explained_variance   | 0.923       |
|    learning_rate        | 3e-05       |
|    loss                 | 0.0629      |
|    n_updates            | 3900        |
|    policy_gradient_loss | -0.0283     |
|    std                  | 0.135       |
|    value_loss           | 0.223       |
-----------------------------------------
New best mean reward!
---------------------------------
| rollout/           |          |
|    ep_len_mean     | 962      |
|    ep_rew_mean     | -45.4    |
| time/              |          |
|    fps             | 19       |
|    iterations      | 196      |
|    time_elapsed    | 5102     |
|    total_timesteps | 100352   |
---------------------------------
</pre>
</div>
</div>

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[21]:</div>




<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult">
<pre>&lt;stable_baselines3.ppo.ppo.PPO at 0x7f173e213990&gt;</pre>
</div>

</div>

</div>

</div>

</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p>Connect to the tensorboard log using <strong>TensorBoard</strong> from the command line to view training progress:</p>
<p><code>tensorboard --logdir ./log_tb_carracing_PPO/</code></p>
<p>Then open TensorBoard in a browser, typically located at:</p>
<p><code>http://localhost:6006/</code></p>

</div>
</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p>Save the trained agent.</p>

</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[22]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">save_path_img_stack</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;RL_Training&#39;</span><span class="p">,</span><span class="s1">&#39;Saved Models&#39;</span><span class="p">,</span><span class="s1">&#39;PPO_self_driving-Image stack&#39;</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">save_path_img_stack</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p>For memory management delete old agent and environment (assumes variable names - change if required).</p>

</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[23]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="k">del</span> <span class="n">model</span>
<span class="k">del</span> <span class="n">env</span>
<span class="k">del</span> <span class="n">eval_env</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h3>&#160;Evaluation<a rel="noopener" class="anchor-link" href="#&#160;Evaluation">&#182;</a></h3>
</div>
</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p>Load the single image saved agent</p>

</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[24]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">model</span> <span class="o">=</span><span class="n">PPO</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">save_path_single_agent</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p>Setup the single image environment for evaluation.</p>

</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[25]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">env_name</span><span class="o">=</span><span class="s1">&#39;CarRacing-v0&#39;</span>
<span class="n">env</span><span class="o">=</span><span class="n">gym</span><span class="o">.</span><span class="n">make</span><span class="p">(</span><span class="n">env_name</span><span class="p">)</span>

<span class="n">env</span> <span class="o">=</span> <span class="n">DummyVecEnv</span><span class="p">([</span><span class="k">lambda</span><span class="p">:</span><span class="n">env</span><span class="p">])</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p>Evaluate the agent in the environment for 30 episodes, rendering the process.</p>

</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[26]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">evaluate_policy</span><span class="p">(</span><span class="n">model</span><span class="p">,</span><span class="n">env</span><span class="p">,</span><span class="n">n_eval_episodes</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span><span class="n">render</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>/usr/local/lib/python3.7/dist-packages/stable_baselines3/common/evaluation.py:69: UserWarning: Evaluation environment is not wrapped with a ``Monitor`` wrapper. This may result in reporting modified episode lengths and rewards, if other wrappers happen to modify these. Consider wrapping environment first with ``Monitor`` wrapper.
  UserWarning,
</pre>
</div>
</div>

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>Track generation: 1172..1469 -&gt; 297-tiles track
Track generation: 1262..1590 -&gt; 328-tiles track
Track generation: 1134..1420 -&gt; 286-tiles track
Track generation: 984..1234 -&gt; 250-tiles track
Track generation: 1033..1297 -&gt; 264-tiles track
Track generation: 1148..1439 -&gt; 291-tiles track
Track generation: 1112..1394 -&gt; 282-tiles track
Track generation: 1133..1420 -&gt; 287-tiles track
Track generation: 1325..1660 -&gt; 335-tiles track
Track generation: 1047..1313 -&gt; 266-tiles track
Track generation: 1184..1484 -&gt; 300-tiles track
Track generation: 1011..1268 -&gt; 257-tiles track
Track generation: 1346..1689 -&gt; 343-tiles track
retry to generate track (normal if there are not manyinstances of this message)
Track generation: 1281..1605 -&gt; 324-tiles track
Track generation: 1036..1303 -&gt; 267-tiles track
retry to generate track (normal if there are not manyinstances of this message)
Track generation: 1220..1529 -&gt; 309-tiles track
Track generation: 1099..1385 -&gt; 286-tiles track
Track generation: 1069..1346 -&gt; 277-tiles track
Track generation: 1139..1428 -&gt; 289-tiles track
Track generation: 1071..1343 -&gt; 272-tiles track
Track generation: 1111..1393 -&gt; 282-tiles track
Track generation: 1267..1588 -&gt; 321-tiles track
Track generation: 1043..1306 -&gt; 263-tiles track
Track generation: 1297..1627 -&gt; 330-tiles track
retry to generate track (normal if there are not manyinstances of this message)
Track generation: 1130..1425 -&gt; 295-tiles track
Track generation: 1241..1555 -&gt; 314-tiles track
Track generation: 1061..1338 -&gt; 277-tiles track
Track generation: 1200..1511 -&gt; 311-tiles track
Track generation: 1054..1322 -&gt; 268-tiles track
Track generation: 1112..1394 -&gt; 282-tiles track
Track generation: 1218..1527 -&gt; 309-tiles track
Track generation: 1097..1375 -&gt; 278-tiles track
Track generation: 1152..1444 -&gt; 292-tiles track
Track generation: 1022..1281 -&gt; 259-tiles track
</pre>
</div>
</div>

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[26]:</div>




<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult">
<pre>(-86.07127403368553, 1.0186510382780782)</pre>
</div>

</div>

</div>

</div>

</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p>The below cell has a video recorder to record the rendered events.</p>

</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[27]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">eval_env</span> <span class="o">=</span> <span class="n">VecVideoRecorder</span><span class="p">(</span><span class="n">env</span><span class="p">,</span> <span class="n">video_folder</span><span class="o">=</span><span class="s1">&#39;videos/&#39;</span><span class="p">,</span>
                              <span class="n">record_video_trigger</span><span class="o">=</span><span class="k">lambda</span> <span class="n">step</span><span class="p">:</span> <span class="n">step</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="n">video_length</span><span class="o">=</span><span class="mi">5000</span><span class="p">,</span>
                              <span class="n">name_prefix</span><span class="o">=</span><span class="s1">&#39;ppo-carracing&#39;</span><span class="p">)</span>

<span class="n">obs</span> <span class="o">=</span> <span class="n">eval_env</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
<span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5000</span><span class="p">):</span>
   <span class="n">action</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">obs</span><span class="p">)</span>
   <span class="n">obs</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">eval_env</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">action</span><span class="p">)</span>


<span class="n">eval_env</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>Track generation: 1212..1519 -&gt; 307-tiles track
Track generation: 1167..1462 -&gt; 295-tiles track
Track generation: 1119..1403 -&gt; 284-tiles track
Track generation: 1101..1381 -&gt; 280-tiles track
Track generation: 1156..1448 -&gt; 292-tiles track
Track generation: 1122..1406 -&gt; 284-tiles track
Saving video to /content/videos/ppo-carracing-step-0-to-step-5000.mp4
</pre>
</div>
</div>

</div>

</div>

</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p>For memory management delete the single image agent (assumes variable names - change if required).</p>

</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[29]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="k">del</span> <span class="n">model</span>
<span class="k">del</span> <span class="n">eval_env</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p>Load the image stack agent</p>

</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[35]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Add code here </span>
<span class="n">model</span><span class="o">=</span><span class="n">PPO</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">save_path_img_stack</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p>Set up the image stack environment</p>

</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[36]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">env_name</span><span class="o">=</span><span class="s1">&#39;CarRacing-v0&#39;</span>
<span class="n">env</span><span class="o">=</span><span class="n">gym</span><span class="o">.</span><span class="n">make</span><span class="p">(</span><span class="n">env_name</span><span class="p">)</span>
<span class="n">env</span> <span class="o">=</span>  <span class="n">sb3</span><span class="o">.</span><span class="n">common</span><span class="o">.</span><span class="n">env_util</span><span class="o">.</span><span class="n">make_vec_env</span><span class="p">(</span><span class="s1">&#39;CarRacing-v0&#39;</span><span class="p">,</span><span class="n">n_envs</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">seed</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">env</span> <span class="o">=</span> <span class="n">VecFrameStack</span><span class="p">(</span><span class="n">env</span><span class="p">,</span> <span class="n">n_stack</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p>Evaluate the agent in the environment for 30 episodes, rendering the process.</p>

</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[37]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">evaluate_policy</span><span class="p">(</span><span class="n">model</span><span class="p">,</span><span class="n">env</span><span class="p">,</span><span class="n">n_eval_episodes</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span><span class="n">render</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>Track generation: 1143..1442 -&gt; 299-tiles track
Track generation: 1087..1369 -&gt; 282-tiles track
Track generation: 964..1212 -&gt; 248-tiles track
retry to generate track (normal if there are not manyinstances of this message)
Track generation: 1176..1474 -&gt; 298-tiles track
Track generation: 1283..1608 -&gt; 325-tiles track
Track generation: 1217..1526 -&gt; 309-tiles track
Track generation: 1096..1374 -&gt; 278-tiles track
Track generation: 1198..1501 -&gt; 303-tiles track
Track generation: 1159..1453 -&gt; 294-tiles track
Track generation: 957..1205 -&gt; 248-tiles track
Track generation: 1181..1480 -&gt; 299-tiles track
Track generation: 979..1234 -&gt; 255-tiles track
</pre>
</div>
</div>

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[37]:</div>




<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult">
<pre>(-82.8233884, 1.2373295978671313)</pre>
</div>

</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[38]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">eval_env</span> <span class="o">=</span> <span class="n">VecVideoRecorder</span><span class="p">(</span><span class="n">env</span><span class="p">,</span> <span class="n">video_folder</span><span class="o">=</span><span class="s1">&#39;videos/&#39;</span><span class="p">,</span>
                              <span class="n">record_video_trigger</span><span class="o">=</span><span class="k">lambda</span> <span class="n">step</span><span class="p">:</span> <span class="n">step</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="n">video_length</span><span class="o">=</span><span class="mi">5000</span><span class="p">,</span>
                              <span class="n">name_prefix</span><span class="o">=</span><span class="s1">&#39;ppo-carracing&#39;</span><span class="p">)</span>

<span class="n">obs</span> <span class="o">=</span> <span class="n">eval_env</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
<span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5000</span><span class="p">):</span>
   <span class="n">action</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">obs</span><span class="p">)</span>
   <span class="n">obs</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">eval_env</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">action</span><span class="p">)</span>


<span class="n">eval_env</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>Track generation: 1320..1654 -&gt; 334-tiles track
Track generation: 1067..1338 -&gt; 271-tiles track
Track generation: 1067..1338 -&gt; 271-tiles track
Track generation: 1207..1513 -&gt; 306-tiles track
Track generation: 1106..1396 -&gt; 290-tiles track
Track generation: 1296..1628 -&gt; 332-tiles track
retry to generate track (normal if there are not manyinstances of this message)
Track generation: 1047..1319 -&gt; 272-tiles track
Saving video to /content/videos/ppo-carracing-step-0-to-step-5000.mp4
</pre>
</div>
</div>

</div>

</div>

</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h3>Reflection<a rel="noopener" class="anchor-link" href="#Reflection">&#182;</a></h3>
</div>
</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p>Reflect on which  agent performs better at the task, and the training process involved (max 200 words).</p>

</div>
</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p>From the videos that are generated after training the models for 500000 timesteps, we can clearly conclude that image stack agent has better reinforcement than single agent. This is because, stack agent allows us to train the agent for <strong>n</strong> environments per step. This will make the actions that are passed to the environment as a n dimensional vector. This will reinforce the agent with better accuracy and speed. Where as the single agent will be trained on just one environment per step which is the reason for it&#39;s decreased accuracy than stack agent for a given total_timestep.</p>

</div>
</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p><strong>References</strong>:</p>
<p><a rel="noopener" href="https://github.com/hill-a/stable-baselines/issues/990">https://github.com/hill-a/stable-baselines/issues/990</a> for the video recording and demo
Brightspace materials for the detailed ideology</p>

</div>
</div>









<script type="module" src="https://s.brightspace.com/lib/bsi/20.22.9-241/unbundled/mathjax.js"></script><script type="text/javascript">document.addEventListener('DOMContentLoaded', function() {
					if (document.querySelector('math') || /\$\$|\\\(|\\\[|\\begin{|\\ref{|\\eqref{/.test(document.body.innerHTML)) {
						document.querySelectorAll('mspace[linebreak="newline"]').forEach(elm => {
							elm.setAttribute('style', 'display: block; height: 0.5rem;');
						});

						window.D2L.MathJax.loadMathJax({
							'outputScale': 1.3,
							'renderLatex': true
						});
					}
				});</script><script type="module" src="https://s.brightspace.com/lib/bsi/20.22.9-241/unbundled/prism.js"></script><script type="text/javascript">document.addEventListener('DOMContentLoaded', function() {
					document.querySelectorAll('.d2l-code').forEach(code => {
						window.D2L.Prism.formatCodeElement(code);
					});
				});</script></body></html>